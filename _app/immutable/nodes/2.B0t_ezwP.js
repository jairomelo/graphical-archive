import{b as cr}from"../chunks/C29rAjwk.js";import{f as ft,a as ct}from"../chunks/DUT-Z5jm.js";import{i as Lr}from"../chunks/DE4KX6PY.js";import{d as Bn,w as Le,o as Xr,a as Vi}from"../chunks/D-u7T03g.js";import{M as kn,h as Tt,aa as Oi,e as Pr,G as Yi,F as Bi,t as f,a0 as Gt,I as qi,J as Gi,K as fr,O as Nn,i as Se,ai as Wi,aF as Ui,f as Cn,s as Ki,aM as fn,aN as hn,c as me,aO as Vr,aD as Or,aP as ji,V as mt,ag as hr,ap as dr,r as Yr,p as Qi,aQ as An,q as Zi,d as Br,aR as Ji,aS as ta,az as ea,aT as na,aC as ra,aU as ia,_ as aa,aV as oa,aK as sa,l as P,Q as la,aW as ua,X as ca,R as fa,y as qr,W as pt,aX as te,v as rt,aY as Gr,B as Wr,A as wt,C as I,E as H,D as $,z as vr,aZ as Be}from"../chunks/CO906QuR.js";import{e as yt,s as ot}from"../chunks/BCkhsyGW.js";import{p as Xt,b as ye,i as St,s as ha,a as ie}from"../chunks/CBKAc462.js";import{s as ge,r as da}from"../chunks/BHUVujVI.js";function qe(t,e){return e}function va(t,e,n){for(var r=t.items,i=[],a=e.length,o=0;o<a;o++)na(e[o].e,i,!0);var l=a>0&&i.length===0&&n!==null;if(l){var c=n.parentNode;ra(c),c.append(n),r.clear(),Pt(t,e[0].prev,e[a-1].next)}ia(i,()=>{for(var s=0;s<a;s++){var u=e[s];l||(r.delete(u.k),Pt(t,u.prev,u.next)),Br(u.e,!l)}})}function Ge(t,e,n,r,i,a=null){var o=t,l={flags:e,items:new Map,first:null},c=(e&Vr)!==0;if(c){var s=t;o=Tt?kn(Oi(s)):s.appendChild(Pr())}Tt&&Yi();var u=null,p=!1,h=new Map,d=Gt(()=>{var v=n();return ji(v)?v:v==null?[]:Or(v)}),_,m;function y(){pa(m,_,l,h,o,i,e,r,n),a!==null&&(_.length===0?u?Yr(u):u=Cn(()=>a(o)):u!==null&&Qi(u,()=>{u=null}))}Bi(()=>{m??=aa,_=f(d);var v=_.length;if(p&&v===0)return;p=v===0;let k=!1;if(Tt){var S=qi(o)===Gi;S!==(v===0)&&(o=fr(),kn(o),Nn(!1),k=!0)}if(Tt){for(var g=null,A,N=0;N<v;N++){if(Se.nodeType===Wi&&Se.data===Ui){o=Se,k=!0,Nn(!1);break}var T=_[N],R=r(T,N);A=Rn(Se,l,g,null,T,R,N,i,e,n),l.items.set(R,A),g=A}v>0&&kn(fr())}if(Tt)v===0&&a&&(u=Cn(()=>a(o)));else if(Ki()){var W=new Set,B=me;for(N=0;N<v;N+=1){T=_[N],R=r(T,N);var U=l.items.get(R)??h.get(R);U?(e&(fn|hn))!==0&&Ur(U,T,N,e):(A=Rn(null,l,null,null,T,R,N,i,e,n,!0),h.set(R,A)),W.add(R)}for(const[Y,et]of l.items)W.has(Y)||B.skipped_effects.add(et.e);B.oncommit(y)}else y();k&&Nn(!0),f(d)}),Tt&&(o=Se)}function pa(t,e,n,r,i,a,o,l,c){var s=(o&ta)!==0,u=(o&(fn|hn))!==0,p=e.length,h=n.items,d=n.first,_=d,m,y=null,v,k=[],S=[],g,A,N,T;if(s)for(T=0;T<p;T+=1)g=e[T],A=l(g,T),N=h.get(A),N!==void 0&&(N.a?.measure(),(v??=new Set).add(N));for(T=0;T<p;T+=1){if(g=e[T],A=l(g,T),N=h.get(A),N===void 0){var R=r.get(A);if(R!==void 0){r.delete(A),h.set(A,R);var W=y?y.next:_;Pt(n,y,R),Pt(n,R,W),Mn(R,W,i),y=R}else{var B=_?_.e.nodes_start:i;y=Rn(B,n,y,y===null?n.first:y.next,g,A,T,a,o,c)}h.set(A,y),k=[],S=[],_=y.next;continue}if(u&&Ur(N,g,T,o),(N.e.f&An)!==0&&(Yr(N.e),s&&(N.a?.unfix(),(v??=new Set).delete(N))),N!==_){if(m!==void 0&&m.has(N)){if(k.length<S.length){var U=S[0],Y;y=U.prev;var et=k[0],x=k[k.length-1];for(Y=0;Y<k.length;Y+=1)Mn(k[Y],U,i);for(Y=0;Y<S.length;Y+=1)m.delete(S[Y]);Pt(n,et.prev,x.next),Pt(n,y,et),Pt(n,x,U),_=U,y=x,T-=1,k=[],S=[]}else m.delete(N),Mn(N,_,i),Pt(n,N.prev,N.next),Pt(n,N,y===null?n.first:y.next),Pt(n,y,N),y=N;continue}for(k=[],S=[];_!==null&&_.k!==A;)(_.e.f&An)===0&&(m??=new Set).add(_),S.push(_),_=_.next;if(_===null)continue;N=_}k.push(N),y=N,_=N.next}if(_!==null||m!==void 0){for(var E=m===void 0?[]:Or(m);_!==null;)(_.e.f&An)===0&&E.push(_),_=_.next;var b=E.length;if(b>0){var C=(o&Vr)!==0&&p===0?i:null;if(s){for(T=0;T<b;T+=1)E[T].a?.measure();for(T=0;T<b;T+=1)E[T].a?.fix()}va(n,E,C)}}s&&Zi(()=>{if(v!==void 0)for(N of v)N.a?.apply()}),t.first=n.first&&n.first.e,t.last=y&&y.e;for(var L of r.values())Br(L.e);r.clear()}function Ur(t,e,n,r){(r&fn)!==0&&dr(t.v,e),(r&hn)!==0?dr(t.i,n):t.i=n}function Rn(t,e,n,r,i,a,o,l,c,s,u){var p=(c&fn)!==0,h=(c&Ji)===0,d=p?h?mt(i,!1,!1):hr(i):i,_=(c&hn)===0?o:hr(o),m={i:_,v:d,k:a,a:null,e:null,prev:n,next:r};try{if(t===null){var y=document.createDocumentFragment();y.append(t=Pr())}return m.e=Cn(()=>l(t,d,_,s),Tt),m.e.prev=n&&n.e,m.e.next=r&&r.e,n===null?u||(e.first=m):(n.next=m,n.e.next=m.e),r!==null&&(r.prev=m,r.e.prev=m.e),m}finally{}}function Mn(t,e,n){for(var r=t.next?t.next.e.nodes_start:n,i=e?e.e.nodes_start:n,a=t.e.nodes_start;a!==null&&a!==r;){var o=ea(a);i.before(a),a=o}}function Pt(t,e,n){e===null?t.first=n:(e.next=n,e.e.next=n&&n.e),n!==null&&(n.prev=e,n.e.prev=e&&e.e)}function ga(t,e,n){var r=t==null?"":""+t;return r===""?null:r}function ma(t,e){return t==null?null:String(t)}function Te(t,e,n,r,i,a){var o=t.__className;if(Tt||o!==n||o===void 0){var l=ga(n);(!Tt||l!==t.getAttribute("class"))&&(l==null?t.removeAttribute("class"):t.className=l),t.__className=n}return a}function ya(t,e,n,r){var i=t.__style;if(Tt||i!==e){var a=ma(e);(!Tt||a!==t.getAttribute("style"))&&(a==null?t.removeAttribute("style"):t.style.cssText=a),t.__style=e}return r}function xa(t,e,n=e){var r=new WeakSet;oa(t,"input",async i=>{var a=i?t.defaultValue:t.value;if(a=Sn(t)?Tn(a):a,n(a),me!==null&&r.add(me),await sa(),a!==(a=e())){var o=t.selectionStart,l=t.selectionEnd,c=t.value.length;if(t.value=a??"",l!==null){var s=t.value.length;o===l&&l===c&&s>c?(t.selectionStart=s,t.selectionEnd=s):(t.selectionStart=o,t.selectionEnd=Math.min(l,s))}}}),(Tt&&t.defaultValue!==t.value||P(e)==null&&t.value)&&(n(Sn(t)?Tn(t.value):t.value),me!==null&&r.add(me)),la(()=>{var i=e();if(t===document.activeElement){var a=ua??me;if(r.has(a))return}Sn(t)&&i===Tn(t.value)||t.type==="date"&&!i&&!t.value||i!==t.value&&(t.value=i??"")})}function Sn(t){var e=t.type;return e==="number"||e==="range"}function Tn(t){return t===""?null:+t}function pr(t,e,n){var r=ca(t,e);r&&r.set&&(t[e]=n,fa(()=>{t[e]=null}))}const _a=!1,wa=!0;async function ba({fetch:t}){const[e,n]=await Promise.all([t(`${cr}/data/europeana_metadata.json`),t(`${cr}/data/europeana_neighbors.json`)]);return{metadata:await e.json(),neighbors:await n.json()}}const vc=Object.freeze(Object.defineProperty({__proto__:null,load:ba,prerender:wa,ssr:_a},Symbol.toStringTag,{value:"Module"})),Dn=Le([]),Kr=Bn(Dn,t=>{const e=new Map;for(const n of t)e.set(n.id,n);return e}),jr=Le([]),Zt=Le(null),We=Le({}),ka=Bn([Zt,jr,Kr],([t,e,n])=>t?e.filter(r=>r.source===t||r.target===t).map(r=>({id:r.source===t?r.target:r.source,score:r.score,item:n.get(r.source===t?r.target:r.source)})).filter(r=>r.item).sort((r,i)=>i.score-r.score):[]);function Na(){if(typeof window>"u")return{views:new Set,bookmarks:new Set,viewTimestamps:new Map,hoverTimestamps:new Map};try{const t=sessionStorage.getItem("europeana_user_interactions");if(!t)return{views:new Set,bookmarks:new Set,viewTimestamps:new Map,hoverTimestamps:new Map};const e=JSON.parse(t);return{views:new Set(e.views||[]),bookmarks:new Set(e.bookmarks||[]),viewTimestamps:new Map(e.viewTimestamps||[]),hoverTimestamps:new Map(e.hoverTimestamps||[])}}catch{return{views:new Set,bookmarks:new Set,viewTimestamps:new Map,hoverTimestamps:new Map}}}function Ue(t){if(!(typeof window>"u"))try{sessionStorage.setItem("europeana_user_interactions",JSON.stringify({views:Array.from(t.views),bookmarks:Array.from(t.bookmarks),viewTimestamps:Array.from(t.viewTimestamps.entries()),hoverTimestamps:Array.from((t.hoverTimestamps||new Map).entries())}))}catch(e){console.warn("Failed to save interactions:",e)}}function Aa(){const{subscribe:t,update:e}=Le(Na());return{subscribe:t,trackView:n=>e(r=>{r.views.add(n);const i=r.viewTimestamps.get(n)||[];return i.push(Date.now()),r.viewTimestamps.set(n,i),Ue(r),r}),trackHover:n=>e(r=>{r.hoverTimestamps=r.hoverTimestamps||new Map;const i=r.hoverTimestamps.get(n)||[];return i.push(Date.now()),r.hoverTimestamps.set(n,i),Ue(r),r}),toggleBookmark:n=>e(r=>(r.bookmarks.has(n)?r.bookmarks.delete(n):r.bookmarks.add(n),Ue(r),r)),reset:()=>e(()=>{const n={views:new Set,bookmarks:new Set,viewTimestamps:new Map,hoverTimestamps:new Map};return Ue(n),n})}}const xe=Aa(),Ma=Bn([xe],([t])=>{Array.from(t.views);const e=Array.from(t.bookmarks),n=new Map,r=new Map,i=Array.from(t.viewTimestamps.entries()).sort((s,u)=>{const p=s[1][s[1].length-1]||0,h=u[1][u[1].length-1]||0;return p-h}).map(s=>s[0]),a=5;for(let s=0;s<i.length;s++)for(let u=s+1;u<Math.min(s+a,i.length);u++){const p=[i[s],i[u]].sort().join("|");n.set(p,(n.get(p)||0)+1)}for(let s=0;s<e.length;s++)for(let u=s+1;u<e.length;u++){const p=[e[s],e[u]].sort().join("|");r.set(p,(r.get(p)||0)+1)}const o=new Map,l=Math.max(1,...Array.from(n.values())),c=Math.max(1,...Array.from(r.values()));return n.forEach((s,u)=>{o.set(u,(o.get(u)||0)+.4*(s/l))}),r.forEach((s,u)=>{o.set(u,(o.get(u)||0)+.6*(s/c))}),o});var Sa={value:()=>{}};function Xe(){for(var t=0,e=arguments.length,n={},r;t<e;++t){if(!(r=arguments[t]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new tn(n)}function tn(t){this._=t}function Ta(t,e){return t.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}tn.prototype=Xe.prototype={constructor:tn,on:function(t,e){var n=this._,r=Ta(t+"",n),i,a=-1,o=r.length;if(arguments.length<2){for(;++a<o;)if((i=(t=r[a]).type)&&(i=Ea(n[i],t.name)))return i;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++a<o;)if(i=(t=r[a]).type)n[i]=gr(n[i],t.name,e);else if(e==null)for(i in n)n[i]=gr(n[i],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new tn(t)},call:function(t,e){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,a;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(a=this._[t],r=0,i=a.length;r<i;++r)a[r].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,a=r.length;i<a;++i)r[i].value.apply(e,n)}};function Ea(t,e){for(var n=0,r=t.length,i;n<r;++n)if((i=t[n]).name===e)return i.value}function gr(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=Sa,t=t.slice(0,r).concat(t.slice(r+1));break}return n!=null&&t.push({name:e,value:n}),t}var Fn="http://www.w3.org/1999/xhtml";const mr={svg:"http://www.w3.org/2000/svg",xhtml:Fn,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function dn(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),mr.hasOwnProperty(e)?{space:mr[e],local:t}:t}function za(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===Fn&&e.documentElement.namespaceURI===Fn?e.createElement(t):e.createElementNS(n,t)}}function $a(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function Qr(t){var e=dn(t);return(e.local?$a:za)(e)}function Ia(){}function qn(t){return t==null?Ia:function(){return this.querySelector(t)}}function Ca(t){typeof t!="function"&&(t=qn(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var a=e[i],o=a.length,l=r[i]=new Array(o),c,s,u=0;u<o;++u)(c=a[u])&&(s=t.call(c,c.__data__,u,a))&&("__data__"in c&&(s.__data__=c.__data__),l[u]=s);return new Mt(r,this._parents)}function Ra(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function Da(){return[]}function Zr(t){return t==null?Da:function(){return this.querySelectorAll(t)}}function Fa(t){return function(){return Ra(t.apply(this,arguments))}}function Ha(t){typeof t=="function"?t=Fa(t):t=Zr(t);for(var e=this._groups,n=e.length,r=[],i=[],a=0;a<n;++a)for(var o=e[a],l=o.length,c,s=0;s<l;++s)(c=o[s])&&(r.push(t.call(c,c.__data__,s,o)),i.push(c));return new Mt(r,i)}function Jr(t){return function(){return this.matches(t)}}function ti(t){return function(e){return e.matches(t)}}var La=Array.prototype.find;function Xa(t){return function(){return La.call(this.children,t)}}function Pa(){return this.firstElementChild}function Va(t){return this.select(t==null?Pa:Xa(typeof t=="function"?t:ti(t)))}var Oa=Array.prototype.filter;function Ya(){return Array.from(this.children)}function Ba(t){return function(){return Oa.call(this.children,t)}}function qa(t){return this.selectAll(t==null?Ya:Ba(typeof t=="function"?t:ti(t)))}function Ga(t){typeof t!="function"&&(t=Jr(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var a=e[i],o=a.length,l=r[i]=[],c,s=0;s<o;++s)(c=a[s])&&t.call(c,c.__data__,s,a)&&l.push(c);return new Mt(r,this._parents)}function ei(t){return new Array(t.length)}function Wa(){return new Mt(this._enter||this._groups.map(ei),this._parents)}function an(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}an.prototype={constructor:an,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function Ua(t){return function(){return t}}function Ka(t,e,n,r,i,a){for(var o=0,l,c=e.length,s=a.length;o<s;++o)(l=e[o])?(l.__data__=a[o],r[o]=l):n[o]=new an(t,a[o]);for(;o<c;++o)(l=e[o])&&(i[o]=l)}function ja(t,e,n,r,i,a,o){var l,c,s=new Map,u=e.length,p=a.length,h=new Array(u),d;for(l=0;l<u;++l)(c=e[l])&&(h[l]=d=o.call(c,c.__data__,l,e)+"",s.has(d)?i[l]=c:s.set(d,c));for(l=0;l<p;++l)d=o.call(t,a[l],l,a)+"",(c=s.get(d))?(r[l]=c,c.__data__=a[l],s.delete(d)):n[l]=new an(t,a[l]);for(l=0;l<u;++l)(c=e[l])&&s.get(h[l])===c&&(i[l]=c)}function Qa(t){return t.__data__}function Za(t,e){if(!arguments.length)return Array.from(this,Qa);var n=e?ja:Ka,r=this._parents,i=this._groups;typeof t!="function"&&(t=Ua(t));for(var a=i.length,o=new Array(a),l=new Array(a),c=new Array(a),s=0;s<a;++s){var u=r[s],p=i[s],h=p.length,d=Ja(t.call(u,u&&u.__data__,s,r)),_=d.length,m=l[s]=new Array(_),y=o[s]=new Array(_),v=c[s]=new Array(h);n(u,p,m,y,v,d,e);for(var k=0,S=0,g,A;k<_;++k)if(g=m[k]){for(k>=S&&(S=k+1);!(A=y[S])&&++S<_;);g._next=A||null}}return o=new Mt(o,r),o._enter=l,o._exit=c,o}function Ja(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function to(){return new Mt(this._exit||this._groups.map(ei),this._parents)}function eo(t,e,n){var r=this.enter(),i=this,a=this.exit();return typeof t=="function"?(r=t(r),r&&(r=r.selection())):r=r.append(t+""),e!=null&&(i=e(i),i&&(i=i.selection())),n==null?a.remove():n(a),r&&i?r.merge(i).order():i}function no(t){for(var e=t.selection?t.selection():t,n=this._groups,r=e._groups,i=n.length,a=r.length,o=Math.min(i,a),l=new Array(i),c=0;c<o;++c)for(var s=n[c],u=r[c],p=s.length,h=l[c]=new Array(p),d,_=0;_<p;++_)(d=s[_]||u[_])&&(h[_]=d);for(;c<i;++c)l[c]=n[c];return new Mt(l,this._parents)}function ro(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r=t[e],i=r.length-1,a=r[i],o;--i>=0;)(o=r[i])&&(a&&o.compareDocumentPosition(a)^4&&a.parentNode.insertBefore(o,a),a=o);return this}function io(t){t||(t=ao);function e(p,h){return p&&h?t(p.__data__,h.__data__):!p-!h}for(var n=this._groups,r=n.length,i=new Array(r),a=0;a<r;++a){for(var o=n[a],l=o.length,c=i[a]=new Array(l),s,u=0;u<l;++u)(s=o[u])&&(c[u]=s);c.sort(e)}return new Mt(i,this._parents).order()}function ao(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function oo(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function so(){return Array.from(this)}function lo(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,a=r.length;i<a;++i){var o=r[i];if(o)return o}return null}function uo(){let t=0;for(const e of this)++t;return t}function co(){return!this.node()}function fo(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i=e[n],a=0,o=i.length,l;a<o;++a)(l=i[a])&&t.call(l,l.__data__,a,i);return this}function ho(t){return function(){this.removeAttribute(t)}}function vo(t){return function(){this.removeAttributeNS(t.space,t.local)}}function po(t,e){return function(){this.setAttribute(t,e)}}function go(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function mo(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function yo(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function xo(t,e){var n=dn(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((e==null?n.local?vo:ho:typeof e=="function"?n.local?yo:mo:n.local?go:po)(n,e))}function ni(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function _o(t){return function(){this.style.removeProperty(t)}}function wo(t,e,n){return function(){this.style.setProperty(t,e,n)}}function bo(t,e,n){return function(){var r=e.apply(this,arguments);r==null?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function ko(t,e,n){return arguments.length>1?this.each((e==null?_o:typeof e=="function"?bo:wo)(t,e,n??"")):be(this.node(),t)}function be(t,e){return t.style.getPropertyValue(e)||ni(t).getComputedStyle(t,null).getPropertyValue(e)}function No(t){return function(){delete this[t]}}function Ao(t,e){return function(){this[t]=e}}function Mo(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function So(t,e){return arguments.length>1?this.each((e==null?No:typeof e=="function"?Mo:Ao)(t,e)):this.node()[t]}function ri(t){return t.trim().split(/^|\s+/)}function Gn(t){return t.classList||new ii(t)}function ii(t){this._node=t,this._names=ri(t.getAttribute("class")||"")}ii.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function ai(t,e){for(var n=Gn(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function oi(t,e){for(var n=Gn(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function To(t){return function(){ai(this,t)}}function Eo(t){return function(){oi(this,t)}}function zo(t,e){return function(){(e.apply(this,arguments)?ai:oi)(this,t)}}function $o(t,e){var n=ri(t+"");if(arguments.length<2){for(var r=Gn(this.node()),i=-1,a=n.length;++i<a;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof e=="function"?zo:e?To:Eo)(n,e))}function Io(){this.textContent=""}function Co(t){return function(){this.textContent=t}}function Ro(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function Do(t){return arguments.length?this.each(t==null?Io:(typeof t=="function"?Ro:Co)(t)):this.node().textContent}function Fo(){this.innerHTML=""}function Ho(t){return function(){this.innerHTML=t}}function Lo(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function Xo(t){return arguments.length?this.each(t==null?Fo:(typeof t=="function"?Lo:Ho)(t)):this.node().innerHTML}function Po(){this.nextSibling&&this.parentNode.appendChild(this)}function Vo(){return this.each(Po)}function Oo(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Yo(){return this.each(Oo)}function Bo(t){var e=typeof t=="function"?t:Qr(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function qo(){return null}function Go(t,e){var n=typeof t=="function"?t:Qr(t),r=e==null?qo:typeof e=="function"?e:qn(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function Wo(){var t=this.parentNode;t&&t.removeChild(this)}function Uo(){return this.each(Wo)}function Ko(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function jo(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Qo(t){return this.select(t?jo:Ko)}function Zo(t){return arguments.length?this.property("__data__",t):this.node().__data__}function Jo(t){return function(e){t.call(this,e,this.__data__)}}function ts(t){return t.trim().split(/^|\s+/).map(function(e){var n="",r=e.indexOf(".");return r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),{type:e,name:n}})}function es(t){return function(){var e=this.__on;if(e){for(var n=0,r=-1,i=e.length,a;n<i;++n)a=e[n],(!t.type||a.type===t.type)&&a.name===t.name?this.removeEventListener(a.type,a.listener,a.options):e[++r]=a;++r?e.length=r:delete this.__on}}}function ns(t,e,n){return function(){var r=this.__on,i,a=Jo(e);if(r){for(var o=0,l=r.length;o<l;++o)if((i=r[o]).type===t.type&&i.name===t.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=a,i.options=n),i.value=e;return}}this.addEventListener(t.type,a,n),i={type:t.type,name:t.name,value:e,listener:a,options:n},r?r.push(i):this.__on=[i]}}function rs(t,e,n){var r=ts(t+""),i,a=r.length,o;if(arguments.length<2){var l=this.node().__on;if(l){for(var c=0,s=l.length,u;c<s;++c)for(i=0,u=l[c];i<a;++i)if((o=r[i]).type===u.type&&o.name===u.name)return u.value}return}for(l=e?ns:es,i=0;i<a;++i)this.each(l(r[i],e,n));return this}function si(t,e,n){var r=ni(t),i=r.CustomEvent;typeof i=="function"?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function is(t,e){return function(){return si(this,t,e)}}function as(t,e){return function(){return si(this,t,e.apply(this,arguments))}}function os(t,e){return this.each((typeof e=="function"?as:is)(t,e))}function*ss(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,a=r.length,o;i<a;++i)(o=r[i])&&(yield o)}var li=[null];function Mt(t,e){this._groups=t,this._parents=e}function Pe(){return new Mt([[document.documentElement]],li)}function ls(){return this}Mt.prototype=Pe.prototype={constructor:Mt,select:Ca,selectAll:Ha,selectChild:Va,selectChildren:qa,filter:Ga,data:Za,enter:Wa,exit:to,join:eo,merge:no,selection:ls,order:ro,sort:io,call:oo,nodes:so,node:lo,size:uo,empty:co,each:fo,attr:xo,style:ko,property:So,classed:$o,text:Do,html:Xo,raise:Vo,lower:Yo,append:Bo,insert:Go,remove:Uo,clone:Qo,datum:Zo,on:rs,dispatch:os,[Symbol.iterator]:ss};function Et(t){return typeof t=="string"?new Mt([[document.querySelector(t)]],[document.documentElement]):new Mt([[t]],li)}function us(t){let e;for(;e=t.sourceEvent;)t=e;return t}function Wt(t,e){if(t=us(t),e===void 0&&(e=t.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=t.clientX,r.y=t.clientY,r=r.matrixTransform(e.getScreenCTM().inverse()),[r.x,r.y]}if(e.getBoundingClientRect){var i=e.getBoundingClientRect();return[t.clientX-i.left-e.clientLeft,t.clientY-i.top-e.clientTop]}}return[t.pageX,t.pageY]}const cs={passive:!1},Ce={capture:!0,passive:!1};function En(t){t.stopImmediatePropagation()}function _e(t){t.preventDefault(),t.stopImmediatePropagation()}function ui(t){var e=t.document.documentElement,n=Et(t).on("dragstart.drag",_e,Ce);"onselectstart"in e?n.on("selectstart.drag",_e,Ce):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function ci(t,e){var n=t.document.documentElement,r=Et(t).on("dragstart.drag",null);e&&(r.on("click.drag",_e,Ce),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const Ke=t=>()=>t;function Hn(t,{sourceEvent:e,subject:n,target:r,identifier:i,active:a,x:o,y:l,dx:c,dy:s,dispatch:u}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:i,enumerable:!0,configurable:!0},active:{value:a,enumerable:!0,configurable:!0},x:{value:o,enumerable:!0,configurable:!0},y:{value:l,enumerable:!0,configurable:!0},dx:{value:c,enumerable:!0,configurable:!0},dy:{value:s,enumerable:!0,configurable:!0},_:{value:u}})}Hn.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};function fs(t){return!t.ctrlKey&&!t.button}function hs(){return this.parentNode}function ds(t,e){return e??{x:t.x,y:t.y}}function vs(){return navigator.maxTouchPoints||"ontouchstart"in this}function ps(){var t=fs,e=hs,n=ds,r=vs,i={},a=Xe("start","drag","end"),o=0,l,c,s,u,p=0;function h(g){g.on("mousedown.drag",d).filter(r).on("touchstart.drag",y).on("touchmove.drag",v,cs).on("touchend.drag touchcancel.drag",k).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function d(g,A){if(!(u||!t.call(this,g,A))){var N=S(this,e.call(this,g,A),g,A,"mouse");N&&(Et(g.view).on("mousemove.drag",_,Ce).on("mouseup.drag",m,Ce),ui(g.view),En(g),s=!1,l=g.clientX,c=g.clientY,N("start",g))}}function _(g){if(_e(g),!s){var A=g.clientX-l,N=g.clientY-c;s=A*A+N*N>p}i.mouse("drag",g)}function m(g){Et(g.view).on("mousemove.drag mouseup.drag",null),ci(g.view,s),_e(g),i.mouse("end",g)}function y(g,A){if(t.call(this,g,A)){var N=g.changedTouches,T=e.call(this,g,A),R=N.length,W,B;for(W=0;W<R;++W)(B=S(this,T,g,A,N[W].identifier,N[W]))&&(En(g),B("start",g,N[W]))}}function v(g){var A=g.changedTouches,N=A.length,T,R;for(T=0;T<N;++T)(R=i[A[T].identifier])&&(_e(g),R("drag",g,A[T]))}function k(g){var A=g.changedTouches,N=A.length,T,R;for(u&&clearTimeout(u),u=setTimeout(function(){u=null},500),T=0;T<N;++T)(R=i[A[T].identifier])&&(En(g),R("end",g,A[T]))}function S(g,A,N,T,R,W){var B=a.copy(),U=Wt(W||N,A),Y,et,x;if((x=n.call(g,new Hn("beforestart",{sourceEvent:N,target:h,identifier:R,active:o,x:U[0],y:U[1],dx:0,dy:0,dispatch:B}),T))!=null)return Y=x.x-U[0]||0,et=x.y-U[1]||0,function E(b,C,L){var V=U,X;switch(b){case"start":i[R]=E,X=o++;break;case"end":delete i[R],--o;case"drag":U=Wt(L||C,A),X=o;break}B.call(b,g,new Hn(b,{sourceEvent:C,subject:x,target:h,identifier:R,active:X,x:U[0]+Y,y:U[1]+et,dx:U[0]-V[0],dy:U[1]-V[1],dispatch:B}),T)}}return h.filter=function(g){return arguments.length?(t=typeof g=="function"?g:Ke(!!g),h):t},h.container=function(g){return arguments.length?(e=typeof g=="function"?g:Ke(g),h):e},h.subject=function(g){return arguments.length?(n=typeof g=="function"?g:Ke(g),h):n},h.touchable=function(g){return arguments.length?(r=typeof g=="function"?g:Ke(!!g),h):r},h.on=function(){var g=a.on.apply(a,arguments);return g===a?h:g},h.clickDistance=function(g){return arguments.length?(p=(g=+g)*g,h):Math.sqrt(p)},h}function Wn(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function fi(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function Ve(){}var Re=.7,on=1/Re,we="\\s*([+-]?\\d+)\\s*",De="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Vt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",gs=/^#([0-9a-f]{3,8})$/,ms=new RegExp(`^rgb\\(${we},${we},${we}\\)$`),ys=new RegExp(`^rgb\\(${Vt},${Vt},${Vt}\\)$`),xs=new RegExp(`^rgba\\(${we},${we},${we},${De}\\)$`),_s=new RegExp(`^rgba\\(${Vt},${Vt},${Vt},${De}\\)$`),ws=new RegExp(`^hsl\\(${De},${Vt},${Vt}\\)$`),bs=new RegExp(`^hsla\\(${De},${Vt},${Vt},${De}\\)$`),yr={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Wn(Ve,Fe,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:xr,formatHex:xr,formatHex8:ks,formatHsl:Ns,formatRgb:_r,toString:_r});function xr(){return this.rgb().formatHex()}function ks(){return this.rgb().formatHex8()}function Ns(){return hi(this).formatHsl()}function _r(){return this.rgb().formatRgb()}function Fe(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=gs.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?wr(e):n===3?new bt(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?je(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?je(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=ms.exec(t))?new bt(e[1],e[2],e[3],1):(e=ys.exec(t))?new bt(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=xs.exec(t))?je(e[1],e[2],e[3],e[4]):(e=_s.exec(t))?je(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=ws.exec(t))?Nr(e[1],e[2]/100,e[3]/100,1):(e=bs.exec(t))?Nr(e[1],e[2]/100,e[3]/100,e[4]):yr.hasOwnProperty(t)?wr(yr[t]):t==="transparent"?new bt(NaN,NaN,NaN,0):null}function wr(t){return new bt(t>>16&255,t>>8&255,t&255,1)}function je(t,e,n,r){return r<=0&&(t=e=n=NaN),new bt(t,e,n,r)}function As(t){return t instanceof Ve||(t=Fe(t)),t?(t=t.rgb(),new bt(t.r,t.g,t.b,t.opacity)):new bt}function Ln(t,e,n,r){return arguments.length===1?As(t):new bt(t,e,n,r??1)}function bt(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}Wn(bt,Ln,fi(Ve,{brighter(t){return t=t==null?on:Math.pow(on,t),new bt(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?Re:Math.pow(Re,t),new bt(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new bt(oe(this.r),oe(this.g),oe(this.b),sn(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:br,formatHex:br,formatHex8:Ms,formatRgb:kr,toString:kr}));function br(){return`#${ae(this.r)}${ae(this.g)}${ae(this.b)}`}function Ms(){return`#${ae(this.r)}${ae(this.g)}${ae(this.b)}${ae((isNaN(this.opacity)?1:this.opacity)*255)}`}function kr(){const t=sn(this.opacity);return`${t===1?"rgb(":"rgba("}${oe(this.r)}, ${oe(this.g)}, ${oe(this.b)}${t===1?")":`, ${t})`}`}function sn(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function oe(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function ae(t){return t=oe(t),(t<16?"0":"")+t.toString(16)}function Nr(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Ct(t,e,n,r)}function hi(t){if(t instanceof Ct)return new Ct(t.h,t.s,t.l,t.opacity);if(t instanceof Ve||(t=Fe(t)),!t)return new Ct;if(t instanceof Ct)return t;t=t.rgb();var e=t.r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),a=Math.max(e,n,r),o=NaN,l=a-i,c=(a+i)/2;return l?(e===a?o=(n-r)/l+(n<r)*6:n===a?o=(r-e)/l+2:o=(e-n)/l+4,l/=c<.5?a+i:2-a-i,o*=60):l=c>0&&c<1?0:o,new Ct(o,l,c,t.opacity)}function Ss(t,e,n,r){return arguments.length===1?hi(t):new Ct(t,e,n,r??1)}function Ct(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}Wn(Ct,Ss,fi(Ve,{brighter(t){return t=t==null?on:Math.pow(on,t),new Ct(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?Re:Math.pow(Re,t),new Ct(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new bt(zn(t>=240?t-240:t+120,i,r),zn(t,i,r),zn(t<120?t+240:t-120,i,r),this.opacity)},clamp(){return new Ct(Ar(this.h),Qe(this.s),Qe(this.l),sn(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=sn(this.opacity);return`${t===1?"hsl(":"hsla("}${Ar(this.h)}, ${Qe(this.s)*100}%, ${Qe(this.l)*100}%${t===1?")":`, ${t})`}`}}));function Ar(t){return t=(t||0)%360,t<0?t+360:t}function Qe(t){return Math.max(0,Math.min(1,t||0))}function zn(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}const di=t=>()=>t;function Ts(t,e){return function(n){return t+n*e}}function Es(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}function zs(t){return(t=+t)==1?vi:function(e,n){return n-e?Es(e,n,t):di(isNaN(e)?n:e)}}function vi(t,e){var n=e-t;return n?Ts(t,n):di(isNaN(t)?e:t)}const Mr=(function t(e){var n=zs(e);function r(i,a){var o=n((i=Ln(i)).r,(a=Ln(a)).r),l=n(i.g,a.g),c=n(i.b,a.b),s=vi(i.opacity,a.opacity);return function(u){return i.r=o(u),i.g=l(u),i.b=c(u),i.opacity=s(u),i+""}}return r.gamma=t,r})(1);function Jt(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}var Xn=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,$n=new RegExp(Xn.source,"g");function $s(t){return function(){return t}}function Is(t){return function(e){return t(e)+""}}function Cs(t,e){var n=Xn.lastIndex=$n.lastIndex=0,r,i,a,o=-1,l=[],c=[];for(t=t+"",e=e+"";(r=Xn.exec(t))&&(i=$n.exec(e));)(a=i.index)>n&&(a=e.slice(n,a),l[o]?l[o]+=a:l[++o]=a),(r=r[0])===(i=i[0])?l[o]?l[o]+=i:l[++o]=i:(l[++o]=null,c.push({i:o,x:Jt(r,i)})),n=$n.lastIndex;return n<e.length&&(a=e.slice(n),l[o]?l[o]+=a:l[++o]=a),l.length<2?c[0]?Is(c[0].x):$s(e):(e=c.length,function(s){for(var u=0,p;u<e;++u)l[(p=c[u]).i]=p.x(s);return l.join("")})}var Sr=180/Math.PI,Pn={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function pi(t,e,n,r,i,a){var o,l,c;return(o=Math.sqrt(t*t+e*e))&&(t/=o,e/=o),(c=t*n+e*r)&&(n-=t*c,r-=e*c),(l=Math.sqrt(n*n+r*r))&&(n/=l,r/=l,c/=l),t*r<e*n&&(t=-t,e=-e,c=-c,o=-o),{translateX:i,translateY:a,rotate:Math.atan2(e,t)*Sr,skewX:Math.atan(c)*Sr,scaleX:o,scaleY:l}}var Ze;function Rs(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?Pn:pi(e.a,e.b,e.c,e.d,e.e,e.f)}function Ds(t){return t==null||(Ze||(Ze=document.createElementNS("http://www.w3.org/2000/svg","g")),Ze.setAttribute("transform",t),!(t=Ze.transform.baseVal.consolidate()))?Pn:(t=t.matrix,pi(t.a,t.b,t.c,t.d,t.e,t.f))}function gi(t,e,n,r){function i(s){return s.length?s.pop()+" ":""}function a(s,u,p,h,d,_){if(s!==p||u!==h){var m=d.push("translate(",null,e,null,n);_.push({i:m-4,x:Jt(s,p)},{i:m-2,x:Jt(u,h)})}else(p||h)&&d.push("translate("+p+e+h+n)}function o(s,u,p,h){s!==u?(s-u>180?u+=360:u-s>180&&(s+=360),h.push({i:p.push(i(p)+"rotate(",null,r)-2,x:Jt(s,u)})):u&&p.push(i(p)+"rotate("+u+r)}function l(s,u,p,h){s!==u?h.push({i:p.push(i(p)+"skewX(",null,r)-2,x:Jt(s,u)}):u&&p.push(i(p)+"skewX("+u+r)}function c(s,u,p,h,d,_){if(s!==p||u!==h){var m=d.push(i(d)+"scale(",null,",",null,")");_.push({i:m-4,x:Jt(s,p)},{i:m-2,x:Jt(u,h)})}else(p!==1||h!==1)&&d.push(i(d)+"scale("+p+","+h+")")}return function(s,u){var p=[],h=[];return s=t(s),u=t(u),a(s.translateX,s.translateY,u.translateX,u.translateY,p,h),o(s.rotate,u.rotate,p,h),l(s.skewX,u.skewX,p,h),c(s.scaleX,s.scaleY,u.scaleX,u.scaleY,p,h),s=u=null,function(d){for(var _=-1,m=h.length,y;++_<m;)p[(y=h[_]).i]=y.x(d);return p.join("")}}}var Fs=gi(Rs,"px, ","px)","deg)"),Hs=gi(Ds,", ",")",")"),Ls=1e-12;function Tr(t){return((t=Math.exp(t))+1/t)/2}function Xs(t){return((t=Math.exp(t))-1/t)/2}function Ps(t){return((t=Math.exp(2*t))-1)/(t+1)}const Vs=(function t(e,n,r){function i(a,o){var l=a[0],c=a[1],s=a[2],u=o[0],p=o[1],h=o[2],d=u-l,_=p-c,m=d*d+_*_,y,v;if(m<Ls)v=Math.log(h/s)/e,y=function(T){return[l+T*d,c+T*_,s*Math.exp(e*T*v)]};else{var k=Math.sqrt(m),S=(h*h-s*s+r*m)/(2*s*n*k),g=(h*h-s*s-r*m)/(2*h*n*k),A=Math.log(Math.sqrt(S*S+1)-S),N=Math.log(Math.sqrt(g*g+1)-g);v=(N-A)/e,y=function(T){var R=T*v,W=Tr(A),B=s/(n*k)*(W*Ps(e*R+A)-Xs(A));return[l+B*d,c+B*_,s*W/Tr(e*R+A)]}}return y.duration=v*1e3*e/Math.SQRT2,y}return i.rho=function(a){var o=Math.max(.001,+a),l=o*o,c=l*l;return t(o,l,c)},i})(Math.SQRT2,2,4);var ke=0,$e=0,Ee=0,mi=1e3,ln,Ie,un=0,le=0,vn=0,He=typeof performance=="object"&&performance.now?performance:Date,yi=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Un(){return le||(yi(Os),le=He.now()+vn)}function Os(){le=0}function cn(){this._call=this._time=this._next=null}cn.prototype=Kn.prototype={constructor:cn,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?Un():+n)+(e==null?0:+e),!this._next&&Ie!==this&&(Ie?Ie._next=this:ln=this,Ie=this),this._call=t,this._time=n,Vn()},stop:function(){this._call&&(this._call=null,this._time=1/0,Vn())}};function Kn(t,e,n){var r=new cn;return r.restart(t,e,n),r}function Ys(){Un(),++ke;for(var t=ln,e;t;)(e=le-t._time)>=0&&t._call.call(void 0,e),t=t._next;--ke}function Er(){le=(un=He.now())+vn,ke=$e=0;try{Ys()}finally{ke=0,qs(),le=0}}function Bs(){var t=He.now(),e=t-un;e>mi&&(vn-=e,un=t)}function qs(){for(var t,e=ln,n,r=1/0;e;)e._call?(r>e._time&&(r=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:ln=n);Ie=t,Vn(r)}function Vn(t){if(!ke){$e&&($e=clearTimeout($e));var e=t-le;e>24?(t<1/0&&($e=setTimeout(Er,t-He.now()-vn)),Ee&&(Ee=clearInterval(Ee))):(Ee||(un=He.now(),Ee=setInterval(Bs,mi)),ke=1,yi(Er))}}function zr(t,e,n){var r=new cn;return e=e==null?0:+e,r.restart(i=>{r.stop(),t(i+e)},e,n),r}var Gs=Xe("start","end","cancel","interrupt"),Ws=[],xi=0,$r=1,On=2,en=3,Ir=4,Yn=5,nn=6;function pn(t,e,n,r,i,a){var o=t.__transition;if(!o)t.__transition={};else if(n in o)return;Us(t,n,{name:e,index:r,group:i,on:Gs,tween:Ws,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:xi})}function jn(t,e){var n=Rt(t,e);if(n.state>xi)throw new Error("too late; already scheduled");return n}function Ot(t,e){var n=Rt(t,e);if(n.state>en)throw new Error("too late; already running");return n}function Rt(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function Us(t,e,n){var r=t.__transition,i;r[e]=n,n.timer=Kn(a,0,n.time);function a(s){n.state=$r,n.timer.restart(o,n.delay,n.time),n.delay<=s&&o(s-n.delay)}function o(s){var u,p,h,d;if(n.state!==$r)return c();for(u in r)if(d=r[u],d.name===n.name){if(d.state===en)return zr(o);d.state===Ir?(d.state=nn,d.timer.stop(),d.on.call("interrupt",t,t.__data__,d.index,d.group),delete r[u]):+u<e&&(d.state=nn,d.timer.stop(),d.on.call("cancel",t,t.__data__,d.index,d.group),delete r[u])}if(zr(function(){n.state===en&&(n.state=Ir,n.timer.restart(l,n.delay,n.time),l(s))}),n.state=On,n.on.call("start",t,t.__data__,n.index,n.group),n.state===On){for(n.state=en,i=new Array(h=n.tween.length),u=0,p=-1;u<h;++u)(d=n.tween[u].value.call(t,t.__data__,n.index,n.group))&&(i[++p]=d);i.length=p+1}}function l(s){for(var u=s<n.duration?n.ease.call(null,s/n.duration):(n.timer.restart(c),n.state=Yn,1),p=-1,h=i.length;++p<h;)i[p].call(t,u);n.state===Yn&&(n.on.call("end",t,t.__data__,n.index,n.group),c())}function c(){n.state=nn,n.timer.stop(),delete r[e];for(var s in r)return;delete t.__transition}}function rn(t,e){var n=t.__transition,r,i,a=!0,o;if(n){e=e==null?null:e+"";for(o in n){if((r=n[o]).name!==e){a=!1;continue}i=r.state>On&&r.state<Yn,r.state=nn,r.timer.stop(),r.on.call(i?"interrupt":"cancel",t,t.__data__,r.index,r.group),delete n[o]}a&&delete t.__transition}}function Ks(t){return this.each(function(){rn(this,t)})}function js(t,e){var n,r;return function(){var i=Ot(this,t),a=i.tween;if(a!==n){r=n=a;for(var o=0,l=r.length;o<l;++o)if(r[o].name===e){r=r.slice(),r.splice(o,1);break}}i.tween=r}}function Qs(t,e,n){var r,i;if(typeof n!="function")throw new Error;return function(){var a=Ot(this,t),o=a.tween;if(o!==r){i=(r=o).slice();for(var l={name:e,value:n},c=0,s=i.length;c<s;++c)if(i[c].name===e){i[c]=l;break}c===s&&i.push(l)}a.tween=i}}function Zs(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r=Rt(this.node(),n).tween,i=0,a=r.length,o;i<a;++i)if((o=r[i]).name===t)return o.value;return null}return this.each((e==null?js:Qs)(n,t,e))}function Qn(t,e,n){var r=t._id;return t.each(function(){var i=Ot(this,r);(i.value||(i.value={}))[e]=n.apply(this,arguments)}),function(i){return Rt(i,r).value[e]}}function _i(t,e){var n;return(typeof e=="number"?Jt:e instanceof Fe?Mr:(n=Fe(e))?(e=n,Mr):Cs)(t,e)}function Js(t){return function(){this.removeAttribute(t)}}function tl(t){return function(){this.removeAttributeNS(t.space,t.local)}}function el(t,e,n){var r,i=n+"",a;return function(){var o=this.getAttribute(t);return o===i?null:o===r?a:a=e(r=o,n)}}function nl(t,e,n){var r,i=n+"",a;return function(){var o=this.getAttributeNS(t.space,t.local);return o===i?null:o===r?a:a=e(r=o,n)}}function rl(t,e,n){var r,i,a;return function(){var o,l=n(this),c;return l==null?void this.removeAttribute(t):(o=this.getAttribute(t),c=l+"",o===c?null:o===r&&c===i?a:(i=c,a=e(r=o,l)))}}function il(t,e,n){var r,i,a;return function(){var o,l=n(this),c;return l==null?void this.removeAttributeNS(t.space,t.local):(o=this.getAttributeNS(t.space,t.local),c=l+"",o===c?null:o===r&&c===i?a:(i=c,a=e(r=o,l)))}}function al(t,e){var n=dn(t),r=n==="transform"?Hs:_i;return this.attrTween(t,typeof e=="function"?(n.local?il:rl)(n,r,Qn(this,"attr."+t,e)):e==null?(n.local?tl:Js)(n):(n.local?nl:el)(n,r,e))}function ol(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function sl(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function ll(t,e){var n,r;function i(){var a=e.apply(this,arguments);return a!==r&&(n=(r=a)&&sl(t,a)),n}return i._value=e,i}function ul(t,e){var n,r;function i(){var a=e.apply(this,arguments);return a!==r&&(n=(r=a)&&ol(t,a)),n}return i._value=e,i}function cl(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var r=dn(t);return this.tween(n,(r.local?ll:ul)(r,e))}function fl(t,e){return function(){jn(this,t).delay=+e.apply(this,arguments)}}function hl(t,e){return e=+e,function(){jn(this,t).delay=e}}function dl(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?fl:hl)(e,t)):Rt(this.node(),e).delay}function vl(t,e){return function(){Ot(this,t).duration=+e.apply(this,arguments)}}function pl(t,e){return e=+e,function(){Ot(this,t).duration=e}}function gl(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?vl:pl)(e,t)):Rt(this.node(),e).duration}function ml(t,e){if(typeof e!="function")throw new Error;return function(){Ot(this,t).ease=e}}function yl(t){var e=this._id;return arguments.length?this.each(ml(e,t)):Rt(this.node(),e).ease}function xl(t,e){return function(){var n=e.apply(this,arguments);if(typeof n!="function")throw new Error;Ot(this,t).ease=n}}function _l(t){if(typeof t!="function")throw new Error;return this.each(xl(this._id,t))}function wl(t){typeof t!="function"&&(t=Jr(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var a=e[i],o=a.length,l=r[i]=[],c,s=0;s<o;++s)(c=a[s])&&t.call(c,c.__data__,s,a)&&l.push(c);return new Kt(r,this._parents,this._name,this._id)}function bl(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,i=n.length,a=Math.min(r,i),o=new Array(r),l=0;l<a;++l)for(var c=e[l],s=n[l],u=c.length,p=o[l]=new Array(u),h,d=0;d<u;++d)(h=c[d]||s[d])&&(p[d]=h);for(;l<r;++l)o[l]=e[l];return new Kt(o,this._parents,this._name,this._id)}function kl(t){return(t+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function Nl(t,e,n){var r,i,a=kl(e)?jn:Ot;return function(){var o=a(this,t),l=o.on;l!==r&&(i=(r=l).copy()).on(e,n),o.on=i}}function Al(t,e){var n=this._id;return arguments.length<2?Rt(this.node(),n).on.on(t):this.each(Nl(n,t,e))}function Ml(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function Sl(){return this.on("end.remove",Ml(this._id))}function Tl(t){var e=this._name,n=this._id;typeof t!="function"&&(t=qn(t));for(var r=this._groups,i=r.length,a=new Array(i),o=0;o<i;++o)for(var l=r[o],c=l.length,s=a[o]=new Array(c),u,p,h=0;h<c;++h)(u=l[h])&&(p=t.call(u,u.__data__,h,l))&&("__data__"in u&&(p.__data__=u.__data__),s[h]=p,pn(s[h],e,n,h,s,Rt(u,n)));return new Kt(a,this._parents,e,n)}function El(t){var e=this._name,n=this._id;typeof t!="function"&&(t=Zr(t));for(var r=this._groups,i=r.length,a=[],o=[],l=0;l<i;++l)for(var c=r[l],s=c.length,u,p=0;p<s;++p)if(u=c[p]){for(var h=t.call(u,u.__data__,p,c),d,_=Rt(u,n),m=0,y=h.length;m<y;++m)(d=h[m])&&pn(d,e,n,m,h,_);a.push(h),o.push(u)}return new Kt(a,o,e,n)}var zl=Pe.prototype.constructor;function $l(){return new zl(this._groups,this._parents)}function Il(t,e){var n,r,i;return function(){var a=be(this,t),o=(this.style.removeProperty(t),be(this,t));return a===o?null:a===n&&o===r?i:i=e(n=a,r=o)}}function wi(t){return function(){this.style.removeProperty(t)}}function Cl(t,e,n){var r,i=n+"",a;return function(){var o=be(this,t);return o===i?null:o===r?a:a=e(r=o,n)}}function Rl(t,e,n){var r,i,a;return function(){var o=be(this,t),l=n(this),c=l+"";return l==null&&(c=l=(this.style.removeProperty(t),be(this,t))),o===c?null:o===r&&c===i?a:(i=c,a=e(r=o,l))}}function Dl(t,e){var n,r,i,a="style."+e,o="end."+a,l;return function(){var c=Ot(this,t),s=c.on,u=c.value[a]==null?l||(l=wi(e)):void 0;(s!==n||i!==u)&&(r=(n=s).copy()).on(o,i=u),c.on=r}}function Fl(t,e,n){var r=(t+="")=="transform"?Fs:_i;return e==null?this.styleTween(t,Il(t,r)).on("end.style."+t,wi(t)):typeof e=="function"?this.styleTween(t,Rl(t,r,Qn(this,"style."+t,e))).each(Dl(this._id,t)):this.styleTween(t,Cl(t,r,e),n).on("end.style."+t,null)}function Hl(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}function Ll(t,e,n){var r,i;function a(){var o=e.apply(this,arguments);return o!==i&&(r=(i=o)&&Hl(t,o,n)),r}return a._value=e,a}function Xl(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(e==null)return this.tween(r,null);if(typeof e!="function")throw new Error;return this.tween(r,Ll(t,e,n??""))}function Pl(t){return function(){this.textContent=t}}function Vl(t){return function(){var e=t(this);this.textContent=e??""}}function Ol(t){return this.tween("text",typeof t=="function"?Vl(Qn(this,"text",t)):Pl(t==null?"":t+""))}function Yl(t){return function(e){this.textContent=t.call(this,e)}}function Bl(t){var e,n;function r(){var i=t.apply(this,arguments);return i!==n&&(e=(n=i)&&Yl(i)),e}return r._value=t,r}function ql(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,Bl(t))}function Gl(){for(var t=this._name,e=this._id,n=bi(),r=this._groups,i=r.length,a=0;a<i;++a)for(var o=r[a],l=o.length,c,s=0;s<l;++s)if(c=o[s]){var u=Rt(c,e);pn(c,t,n,s,o,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new Kt(r,this._parents,t,n)}function Wl(){var t,e,n=this,r=n._id,i=n.size();return new Promise(function(a,o){var l={value:o},c={value:function(){--i===0&&a()}};n.each(function(){var s=Ot(this,r),u=s.on;u!==t&&(e=(t=u).copy(),e._.cancel.push(l),e._.interrupt.push(l),e._.end.push(c)),s.on=e}),i===0&&a()})}var Ul=0;function Kt(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function bi(){return++Ul}var qt=Pe.prototype;Kt.prototype={constructor:Kt,select:Tl,selectAll:El,selectChild:qt.selectChild,selectChildren:qt.selectChildren,filter:wl,merge:bl,selection:$l,transition:Gl,call:qt.call,nodes:qt.nodes,node:qt.node,size:qt.size,empty:qt.empty,each:qt.each,on:Al,attr:al,attrTween:cl,style:Fl,styleTween:Xl,text:Ol,textTween:ql,remove:Sl,tween:Zs,delay:dl,duration:gl,ease:yl,easeVarying:_l,end:Wl,[Symbol.iterator]:qt[Symbol.iterator]};function Kl(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var jl={time:null,delay:0,duration:250,ease:Kl};function Ql(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}function Zl(t){var e,n;t instanceof Kt?(e=t._id,t=t._name):(e=bi(),(n=jl).time=Un(),t=t==null?null:t+"");for(var r=this._groups,i=r.length,a=0;a<i;++a)for(var o=r[a],l=o.length,c,s=0;s<l;++s)(c=o[s])&&pn(c,t,e,s,o,n||Ql(c,e));return new Kt(r,this._parents,t,e)}Pe.prototype.interrupt=Ks;Pe.prototype.transition=Zl;function Cr(t,e){var n,r=1;t==null&&(t=0),e==null&&(e=0);function i(){var a,o=n.length,l,c=0,s=0;for(a=0;a<o;++a)l=n[a],c+=l.x,s+=l.y;for(c=(c/o-t)*r,s=(s/o-e)*r,a=0;a<o;++a)l=n[a],l.x-=c,l.y-=s}return i.initialize=function(a){n=a},i.x=function(a){return arguments.length?(t=+a,i):t},i.y=function(a){return arguments.length?(e=+a,i):e},i.strength=function(a){return arguments.length?(r=+a,i):r},i}function Jl(t){const e=+this._x.call(null,t),n=+this._y.call(null,t);return ki(this.cover(e,n),e,n,t)}function ki(t,e,n,r){if(isNaN(e)||isNaN(n))return t;var i,a=t._root,o={data:r},l=t._x0,c=t._y0,s=t._x1,u=t._y1,p,h,d,_,m,y,v,k;if(!a)return t._root=o,t;for(;a.length;)if((m=e>=(p=(l+s)/2))?l=p:s=p,(y=n>=(h=(c+u)/2))?c=h:u=h,i=a,!(a=a[v=y<<1|m]))return i[v]=o,t;if(d=+t._x.call(null,a.data),_=+t._y.call(null,a.data),e===d&&n===_)return o.next=a,i?i[v]=o:t._root=o,t;do i=i?i[v]=new Array(4):t._root=new Array(4),(m=e>=(p=(l+s)/2))?l=p:s=p,(y=n>=(h=(c+u)/2))?c=h:u=h;while((v=y<<1|m)===(k=(_>=h)<<1|d>=p));return i[k]=a,i[v]=o,t}function tu(t){var e,n,r=t.length,i,a,o=new Array(r),l=new Array(r),c=1/0,s=1/0,u=-1/0,p=-1/0;for(n=0;n<r;++n)isNaN(i=+this._x.call(null,e=t[n]))||isNaN(a=+this._y.call(null,e))||(o[n]=i,l[n]=a,i<c&&(c=i),i>u&&(u=i),a<s&&(s=a),a>p&&(p=a));if(c>u||s>p)return this;for(this.cover(c,s).cover(u,p),n=0;n<r;++n)ki(this,o[n],l[n],t[n]);return this}function eu(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var n=this._x0,r=this._y0,i=this._x1,a=this._y1;if(isNaN(n))i=(n=Math.floor(t))+1,a=(r=Math.floor(e))+1;else{for(var o=i-n||1,l=this._root,c,s;n>t||t>=i||r>e||e>=a;)switch(s=(e<r)<<1|t<n,c=new Array(4),c[s]=l,l=c,o*=2,s){case 0:i=n+o,a=r+o;break;case 1:n=i-o,a=r+o;break;case 2:i=n+o,r=a-o;break;case 3:n=i-o,r=a-o;break}this._root&&this._root.length&&(this._root=l)}return this._x0=n,this._y0=r,this._x1=i,this._y1=a,this}function nu(){var t=[];return this.visit(function(e){if(!e.length)do t.push(e.data);while(e=e.next)}),t}function ru(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function xt(t,e,n,r,i){this.node=t,this.x0=e,this.y0=n,this.x1=r,this.y1=i}function iu(t,e,n){var r,i=this._x0,a=this._y0,o,l,c,s,u=this._x1,p=this._y1,h=[],d=this._root,_,m;for(d&&h.push(new xt(d,i,a,u,p)),n==null?n=1/0:(i=t-n,a=e-n,u=t+n,p=e+n,n*=n);_=h.pop();)if(!(!(d=_.node)||(o=_.x0)>u||(l=_.y0)>p||(c=_.x1)<i||(s=_.y1)<a))if(d.length){var y=(o+c)/2,v=(l+s)/2;h.push(new xt(d[3],y,v,c,s),new xt(d[2],o,v,y,s),new xt(d[1],y,l,c,v),new xt(d[0],o,l,y,v)),(m=(e>=v)<<1|t>=y)&&(_=h[h.length-1],h[h.length-1]=h[h.length-1-m],h[h.length-1-m]=_)}else{var k=t-+this._x.call(null,d.data),S=e-+this._y.call(null,d.data),g=k*k+S*S;if(g<n){var A=Math.sqrt(n=g);i=t-A,a=e-A,u=t+A,p=e+A,r=d.data}}return r}function au(t){if(isNaN(u=+this._x.call(null,t))||isNaN(p=+this._y.call(null,t)))return this;var e,n=this._root,r,i,a,o=this._x0,l=this._y0,c=this._x1,s=this._y1,u,p,h,d,_,m,y,v;if(!n)return this;if(n.length)for(;;){if((_=u>=(h=(o+c)/2))?o=h:c=h,(m=p>=(d=(l+s)/2))?l=d:s=d,e=n,!(n=n[y=m<<1|_]))return this;if(!n.length)break;(e[y+1&3]||e[y+2&3]||e[y+3&3])&&(r=e,v=y)}for(;n.data!==t;)if(i=n,!(n=n.next))return this;return(a=n.next)&&delete n.next,i?(a?i.next=a:delete i.next,this):e?(a?e[y]=a:delete e[y],(n=e[0]||e[1]||e[2]||e[3])&&n===(e[3]||e[2]||e[1]||e[0])&&!n.length&&(r?r[v]=n:this._root=n),this):(this._root=a,this)}function ou(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this}function su(){return this._root}function lu(){var t=0;return this.visit(function(e){if(!e.length)do++t;while(e=e.next)}),t}function uu(t){var e=[],n,r=this._root,i,a,o,l,c;for(r&&e.push(new xt(r,this._x0,this._y0,this._x1,this._y1));n=e.pop();)if(!t(r=n.node,a=n.x0,o=n.y0,l=n.x1,c=n.y1)&&r.length){var s=(a+l)/2,u=(o+c)/2;(i=r[3])&&e.push(new xt(i,s,u,l,c)),(i=r[2])&&e.push(new xt(i,a,u,s,c)),(i=r[1])&&e.push(new xt(i,s,o,l,u)),(i=r[0])&&e.push(new xt(i,a,o,s,u))}return this}function cu(t){var e=[],n=[],r;for(this._root&&e.push(new xt(this._root,this._x0,this._y0,this._x1,this._y1));r=e.pop();){var i=r.node;if(i.length){var a,o=r.x0,l=r.y0,c=r.x1,s=r.y1,u=(o+c)/2,p=(l+s)/2;(a=i[0])&&e.push(new xt(a,o,l,u,p)),(a=i[1])&&e.push(new xt(a,u,l,c,p)),(a=i[2])&&e.push(new xt(a,o,p,u,s)),(a=i[3])&&e.push(new xt(a,u,p,c,s))}n.push(r)}for(;r=n.pop();)t(r.node,r.x0,r.y0,r.x1,r.y1);return this}function fu(t){return t[0]}function hu(t){return arguments.length?(this._x=t,this):this._x}function du(t){return t[1]}function vu(t){return arguments.length?(this._y=t,this):this._y}function Zn(t,e,n){var r=new Jn(e??fu,n??du,NaN,NaN,NaN,NaN);return t==null?r:r.addAll(t)}function Jn(t,e,n,r,i,a){this._x=t,this._y=e,this._x0=n,this._y0=r,this._x1=i,this._y1=a,this._root=void 0}function Rr(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}var _t=Zn.prototype=Jn.prototype;_t.copy=function(){var t=new Jn(this._x,this._y,this._x0,this._y0,this._x1,this._y1),e=this._root,n,r;if(!e)return t;if(!e.length)return t._root=Rr(e),t;for(n=[{source:e,target:t._root=new Array(4)}];e=n.pop();)for(var i=0;i<4;++i)(r=e.source[i])&&(r.length?n.push({source:r,target:e.target[i]=new Array(4)}):e.target[i]=Rr(r));return t};_t.add=Jl;_t.addAll=tu;_t.cover=eu;_t.data=nu;_t.extent=ru;_t.find=iu;_t.remove=au;_t.removeAll=ou;_t.root=su;_t.size=lu;_t.visit=uu;_t.visitAfter=cu;_t.x=hu;_t.y=vu;function se(t){return function(){return t}}function ee(t){return(t()-.5)*1e-6}function pu(t){return t.x+t.vx}function gu(t){return t.y+t.vy}function mu(t){var e,n,r,i=1,a=1;typeof t!="function"&&(t=se(t==null?1:+t));function o(){for(var s,u=e.length,p,h,d,_,m,y,v=0;v<a;++v)for(p=Zn(e,pu,gu).visitAfter(l),s=0;s<u;++s)h=e[s],m=n[h.index],y=m*m,d=h.x+h.vx,_=h.y+h.vy,p.visit(k);function k(S,g,A,N,T){var R=S.data,W=S.r,B=m+W;if(R){if(R.index>h.index){var U=d-R.x-R.vx,Y=_-R.y-R.vy,et=U*U+Y*Y;et<B*B&&(U===0&&(U=ee(r),et+=U*U),Y===0&&(Y=ee(r),et+=Y*Y),et=(B-(et=Math.sqrt(et)))/et*i,h.vx+=(U*=et)*(B=(W*=W)/(y+W)),h.vy+=(Y*=et)*B,R.vx-=U*(B=1-B),R.vy-=Y*B)}return}return g>d+B||N<d-B||A>_+B||T<_-B}}function l(s){if(s.data)return s.r=n[s.data.index];for(var u=s.r=0;u<4;++u)s[u]&&s[u].r>s.r&&(s.r=s[u].r)}function c(){if(e){var s,u=e.length,p;for(n=new Array(u),s=0;s<u;++s)p=e[s],n[p.index]=+t(p,s,e)}}return o.initialize=function(s,u){e=s,r=u,c()},o.iterations=function(s){return arguments.length?(a=+s,o):a},o.strength=function(s){return arguments.length?(i=+s,o):i},o.radius=function(s){return arguments.length?(t=typeof s=="function"?s:se(+s),c(),o):t},o}function yu(t){return t.index}function Dr(t,e){var n=t.get(e);if(!n)throw new Error("node not found: "+e);return n}function xu(t){var e=yu,n=p,r,i=se(30),a,o,l,c,s,u=1;t==null&&(t=[]);function p(y){return 1/Math.min(l[y.source.index],l[y.target.index])}function h(y){for(var v=0,k=t.length;v<u;++v)for(var S=0,g,A,N,T,R,W,B;S<k;++S)g=t[S],A=g.source,N=g.target,T=N.x+N.vx-A.x-A.vx||ee(s),R=N.y+N.vy-A.y-A.vy||ee(s),W=Math.sqrt(T*T+R*R),W=(W-a[S])/W*y*r[S],T*=W,R*=W,N.vx-=T*(B=c[S]),N.vy-=R*B,A.vx+=T*(B=1-B),A.vy+=R*B}function d(){if(o){var y,v=o.length,k=t.length,S=new Map(o.map((A,N)=>[e(A,N,o),A])),g;for(y=0,l=new Array(v);y<k;++y)g=t[y],g.index=y,typeof g.source!="object"&&(g.source=Dr(S,g.source)),typeof g.target!="object"&&(g.target=Dr(S,g.target)),l[g.source.index]=(l[g.source.index]||0)+1,l[g.target.index]=(l[g.target.index]||0)+1;for(y=0,c=new Array(k);y<k;++y)g=t[y],c[y]=l[g.source.index]/(l[g.source.index]+l[g.target.index]);r=new Array(k),_(),a=new Array(k),m()}}function _(){if(o)for(var y=0,v=t.length;y<v;++y)r[y]=+n(t[y],y,t)}function m(){if(o)for(var y=0,v=t.length;y<v;++y)a[y]=+i(t[y],y,t)}return h.initialize=function(y,v){o=y,s=v,d()},h.links=function(y){return arguments.length?(t=y,d(),h):t},h.id=function(y){return arguments.length?(e=y,h):e},h.iterations=function(y){return arguments.length?(u=+y,h):u},h.strength=function(y){return arguments.length?(n=typeof y=="function"?y:se(+y),_(),h):n},h.distance=function(y){return arguments.length?(i=typeof y=="function"?y:se(+y),m(),h):i},h}const _u=1664525,wu=1013904223,Fr=4294967296;function bu(){let t=1;return()=>(t=(_u*t+wu)%Fr)/Fr}function ku(t){return t.x}function Nu(t){return t.y}var Au=10,Mu=Math.PI*(3-Math.sqrt(5));function Su(t){var e,n=1,r=.001,i=1-Math.pow(r,1/300),a=0,o=.6,l=new Map,c=Kn(p),s=Xe("tick","end"),u=bu();t==null&&(t=[]);function p(){h(),s.call("tick",e),n<r&&(c.stop(),s.call("end",e))}function h(m){var y,v=t.length,k;m===void 0&&(m=1);for(var S=0;S<m;++S)for(n+=(a-n)*i,l.forEach(function(g){g(n)}),y=0;y<v;++y)k=t[y],k.fx==null?k.x+=k.vx*=o:(k.x=k.fx,k.vx=0),k.fy==null?k.y+=k.vy*=o:(k.y=k.fy,k.vy=0);return e}function d(){for(var m=0,y=t.length,v;m<y;++m){if(v=t[m],v.index=m,v.fx!=null&&(v.x=v.fx),v.fy!=null&&(v.y=v.fy),isNaN(v.x)||isNaN(v.y)){var k=Au*Math.sqrt(.5+m),S=m*Mu;v.x=k*Math.cos(S),v.y=k*Math.sin(S)}(isNaN(v.vx)||isNaN(v.vy))&&(v.vx=v.vy=0)}}function _(m){return m.initialize&&m.initialize(t,u),m}return d(),e={tick:h,restart:function(){return c.restart(p),e},stop:function(){return c.stop(),e},nodes:function(m){return arguments.length?(t=m,d(),l.forEach(_),e):t},alpha:function(m){return arguments.length?(n=+m,e):n},alphaMin:function(m){return arguments.length?(r=+m,e):r},alphaDecay:function(m){return arguments.length?(i=+m,e):+i},alphaTarget:function(m){return arguments.length?(a=+m,e):a},velocityDecay:function(m){return arguments.length?(o=1-m,e):1-o},randomSource:function(m){return arguments.length?(u=m,l.forEach(_),e):u},force:function(m,y){return arguments.length>1?(y==null?l.delete(m):l.set(m,_(y)),e):l.get(m)},find:function(m,y,v){var k=0,S=t.length,g,A,N,T,R;for(v==null?v=1/0:v*=v,k=0;k<S;++k)T=t[k],g=m-T.x,A=y-T.y,N=g*g+A*A,N<v&&(R=T,v=N);return R},on:function(m,y){return arguments.length>1?(s.on(m,y),e):s.on(m)}}}function Tu(){var t,e,n,r,i=se(-30),a,o=1,l=1/0,c=.81;function s(d){var _,m=t.length,y=Zn(t,ku,Nu).visitAfter(p);for(r=d,_=0;_<m;++_)e=t[_],y.visit(h)}function u(){if(t){var d,_=t.length,m;for(a=new Array(_),d=0;d<_;++d)m=t[d],a[m.index]=+i(m,d,t)}}function p(d){var _=0,m,y,v=0,k,S,g;if(d.length){for(k=S=g=0;g<4;++g)(m=d[g])&&(y=Math.abs(m.value))&&(_+=m.value,v+=y,k+=y*m.x,S+=y*m.y);d.x=k/v,d.y=S/v}else{m=d,m.x=m.data.x,m.y=m.data.y;do _+=a[m.data.index];while(m=m.next)}d.value=_}function h(d,_,m,y){if(!d.value)return!0;var v=d.x-e.x,k=d.y-e.y,S=y-_,g=v*v+k*k;if(S*S/c<g)return g<l&&(v===0&&(v=ee(n),g+=v*v),k===0&&(k=ee(n),g+=k*k),g<o&&(g=Math.sqrt(o*g)),e.vx+=v*d.value*r/g,e.vy+=k*d.value*r/g),!0;if(d.length||g>=l)return;(d.data!==e||d.next)&&(v===0&&(v=ee(n),g+=v*v),k===0&&(k=ee(n),g+=k*k),g<o&&(g=Math.sqrt(o*g)));do d.data!==e&&(S=a[d.data.index]*r/g,e.vx+=v*S,e.vy+=k*S);while(d=d.next)}return s.initialize=function(d,_){t=d,n=_,u()},s.strength=function(d){return arguments.length?(i=typeof d=="function"?d:se(+d),u(),s):i},s.distanceMin=function(d){return arguments.length?(o=d*d,s):Math.sqrt(o)},s.distanceMax=function(d){return arguments.length?(l=d*d,s):Math.sqrt(l)},s.theta=function(d){return arguments.length?(c=d*d,s):Math.sqrt(c)},s}function Eu(t){for(var e=t.length/6|0,n=new Array(e),r=0;r<e;)n[r]="#"+t.slice(r*6,++r*6);return n}const zu=Eu("4e79a7f28e2ce1575976b7b259a14fedc949af7aa1ff9da79c755fbab0ab"),Je=t=>()=>t;function $u(t,{sourceEvent:e,target:n,transform:r,dispatch:i}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:i}})}function Ut(t,e,n){this.k=t,this.x=e,this.y=n}Ut.prototype={constructor:Ut,scale:function(t){return t===1?this:new Ut(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new Ut(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var tr=new Ut(1,0,0);Ut.prototype;function In(t){t.stopImmediatePropagation()}function ze(t){t.preventDefault(),t.stopImmediatePropagation()}function Iu(t){return(!t.ctrlKey||t.type==="wheel")&&!t.button}function Cu(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t,t.hasAttribute("viewBox")?(t=t.viewBox.baseVal,[[t.x,t.y],[t.x+t.width,t.y+t.height]]):[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]):[[0,0],[t.clientWidth,t.clientHeight]]}function Hr(){return this.__zoom||tr}function Ru(t){return-t.deltaY*(t.deltaMode===1?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function Du(){return navigator.maxTouchPoints||"ontouchstart"in this}function Fu(t,e,n){var r=t.invertX(e[0][0])-n[0][0],i=t.invertX(e[1][0])-n[1][0],a=t.invertY(e[0][1])-n[0][1],o=t.invertY(e[1][1])-n[1][1];return t.translate(i>r?(r+i)/2:Math.min(0,r)||Math.max(0,i),o>a?(a+o)/2:Math.min(0,a)||Math.max(0,o))}function Hu(){var t=Iu,e=Cu,n=Fu,r=Ru,i=Du,a=[0,1/0],o=[[-1/0,-1/0],[1/0,1/0]],l=250,c=Vs,s=Xe("start","zoom","end"),u,p,h,d=500,_=150,m=0,y=10;function v(x){x.property("__zoom",Hr).on("wheel.zoom",R,{passive:!1}).on("mousedown.zoom",W).on("dblclick.zoom",B).filter(i).on("touchstart.zoom",U).on("touchmove.zoom",Y).on("touchend.zoom touchcancel.zoom",et).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}v.transform=function(x,E,b,C){var L=x.selection?x.selection():x;L.property("__zoom",Hr),x!==L?A(x,E,b,C):L.interrupt().each(function(){N(this,arguments).event(C).start().zoom(null,typeof E=="function"?E.apply(this,arguments):E).end()})},v.scaleBy=function(x,E,b,C){v.scaleTo(x,function(){var L=this.__zoom.k,V=typeof E=="function"?E.apply(this,arguments):E;return L*V},b,C)},v.scaleTo=function(x,E,b,C){v.transform(x,function(){var L=e.apply(this,arguments),V=this.__zoom,X=b==null?g(L):typeof b=="function"?b.apply(this,arguments):b,Q=V.invert(X),nt=typeof E=="function"?E.apply(this,arguments):E;return n(S(k(V,nt),X,Q),L,o)},b,C)},v.translateBy=function(x,E,b,C){v.transform(x,function(){return n(this.__zoom.translate(typeof E=="function"?E.apply(this,arguments):E,typeof b=="function"?b.apply(this,arguments):b),e.apply(this,arguments),o)},null,C)},v.translateTo=function(x,E,b,C,L){v.transform(x,function(){var V=e.apply(this,arguments),X=this.__zoom,Q=C==null?g(V):typeof C=="function"?C.apply(this,arguments):C;return n(tr.translate(Q[0],Q[1]).scale(X.k).translate(typeof E=="function"?-E.apply(this,arguments):-E,typeof b=="function"?-b.apply(this,arguments):-b),V,o)},C,L)};function k(x,E){return E=Math.max(a[0],Math.min(a[1],E)),E===x.k?x:new Ut(E,x.x,x.y)}function S(x,E,b){var C=E[0]-b[0]*x.k,L=E[1]-b[1]*x.k;return C===x.x&&L===x.y?x:new Ut(x.k,C,L)}function g(x){return[(+x[0][0]+ +x[1][0])/2,(+x[0][1]+ +x[1][1])/2]}function A(x,E,b,C){x.on("start.zoom",function(){N(this,arguments).event(C).start()}).on("interrupt.zoom end.zoom",function(){N(this,arguments).event(C).end()}).tween("zoom",function(){var L=this,V=arguments,X=N(L,V).event(C),Q=e.apply(L,V),nt=b==null?g(Q):typeof b=="function"?b.apply(L,V):b,M=Math.max(Q[1][0]-Q[0][0],Q[1][1]-Q[0][1]),z=L.__zoom,G=typeof E=="function"?E.apply(L,V):E,K=c(z.invert(nt).concat(M/z.k),G.invert(nt).concat(M/G.k));return function(w){if(w===1)w=G;else{var F=K(w),q=M/F[2];w=new Ut(q,nt[0]-F[0]*q,nt[1]-F[1]*q)}X.zoom(null,w)}})}function N(x,E,b){return!b&&x.__zooming||new T(x,E)}function T(x,E){this.that=x,this.args=E,this.active=0,this.sourceEvent=null,this.extent=e.apply(x,E),this.taps=0}T.prototype={event:function(x){return x&&(this.sourceEvent=x),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(x,E){return this.mouse&&x!=="mouse"&&(this.mouse[1]=E.invert(this.mouse[0])),this.touch0&&x!=="touch"&&(this.touch0[1]=E.invert(this.touch0[0])),this.touch1&&x!=="touch"&&(this.touch1[1]=E.invert(this.touch1[0])),this.that.__zoom=E,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(x){var E=Et(this.that).datum();s.call(x,this.that,new $u(x,{sourceEvent:this.sourceEvent,target:v,transform:this.that.__zoom,dispatch:s}),E)}};function R(x,...E){if(!t.apply(this,arguments))return;var b=N(this,E).event(x),C=this.__zoom,L=Math.max(a[0],Math.min(a[1],C.k*Math.pow(2,r.apply(this,arguments)))),V=Wt(x);if(b.wheel)(b.mouse[0][0]!==V[0]||b.mouse[0][1]!==V[1])&&(b.mouse[1]=C.invert(b.mouse[0]=V)),clearTimeout(b.wheel);else{if(C.k===L)return;b.mouse=[V,C.invert(V)],rn(this),b.start()}ze(x),b.wheel=setTimeout(X,_),b.zoom("mouse",n(S(k(C,L),b.mouse[0],b.mouse[1]),b.extent,o));function X(){b.wheel=null,b.end()}}function W(x,...E){if(h||!t.apply(this,arguments))return;var b=x.currentTarget,C=N(this,E,!0).event(x),L=Et(x.view).on("mousemove.zoom",nt,!0).on("mouseup.zoom",M,!0),V=Wt(x,b),X=x.clientX,Q=x.clientY;ui(x.view),In(x),C.mouse=[V,this.__zoom.invert(V)],rn(this),C.start();function nt(z){if(ze(z),!C.moved){var G=z.clientX-X,K=z.clientY-Q;C.moved=G*G+K*K>m}C.event(z).zoom("mouse",n(S(C.that.__zoom,C.mouse[0]=Wt(z,b),C.mouse[1]),C.extent,o))}function M(z){L.on("mousemove.zoom mouseup.zoom",null),ci(z.view,C.moved),ze(z),C.event(z).end()}}function B(x,...E){if(t.apply(this,arguments)){var b=this.__zoom,C=Wt(x.changedTouches?x.changedTouches[0]:x,this),L=b.invert(C),V=b.k*(x.shiftKey?.5:2),X=n(S(k(b,V),C,L),e.apply(this,E),o);ze(x),l>0?Et(this).transition().duration(l).call(A,X,C,x):Et(this).call(v.transform,X,C,x)}}function U(x,...E){if(t.apply(this,arguments)){var b=x.touches,C=b.length,L=N(this,E,x.changedTouches.length===C).event(x),V,X,Q,nt;for(In(x),X=0;X<C;++X)Q=b[X],nt=Wt(Q,this),nt=[nt,this.__zoom.invert(nt),Q.identifier],L.touch0?!L.touch1&&L.touch0[2]!==nt[2]&&(L.touch1=nt,L.taps=0):(L.touch0=nt,V=!0,L.taps=1+!!u);u&&(u=clearTimeout(u)),V&&(L.taps<2&&(p=nt[0],u=setTimeout(function(){u=null},d)),rn(this),L.start())}}function Y(x,...E){if(this.__zooming){var b=N(this,E).event(x),C=x.changedTouches,L=C.length,V,X,Q,nt;for(ze(x),V=0;V<L;++V)X=C[V],Q=Wt(X,this),b.touch0&&b.touch0[2]===X.identifier?b.touch0[0]=Q:b.touch1&&b.touch1[2]===X.identifier&&(b.touch1[0]=Q);if(X=b.that.__zoom,b.touch1){var M=b.touch0[0],z=b.touch0[1],G=b.touch1[0],K=b.touch1[1],w=(w=G[0]-M[0])*w+(w=G[1]-M[1])*w,F=(F=K[0]-z[0])*F+(F=K[1]-z[1])*F;X=k(X,Math.sqrt(w/F)),Q=[(M[0]+G[0])/2,(M[1]+G[1])/2],nt=[(z[0]+K[0])/2,(z[1]+K[1])/2]}else if(b.touch0)Q=b.touch0[0],nt=b.touch0[1];else return;b.zoom("touch",n(S(X,Q,nt),b.extent,o))}}function et(x,...E){if(this.__zooming){var b=N(this,E).event(x),C=x.changedTouches,L=C.length,V,X;for(In(x),h&&clearTimeout(h),h=setTimeout(function(){h=null},d),V=0;V<L;++V)X=C[V],b.touch0&&b.touch0[2]===X.identifier?delete b.touch0:b.touch1&&b.touch1[2]===X.identifier&&delete b.touch1;if(b.touch1&&!b.touch0&&(b.touch0=b.touch1,delete b.touch1),b.touch0)b.touch0[1]=this.__zoom.invert(b.touch0[0]);else if(b.end(),b.taps===2&&(X=Wt(X,this),Math.hypot(p[0]-X[0],p[1]-X[1])<y)){var Q=Et(this).on("dblclick.zoom");Q&&Q.apply(this,arguments)}}}return v.wheelDelta=function(x){return arguments.length?(r=typeof x=="function"?x:Je(+x),v):r},v.filter=function(x){return arguments.length?(t=typeof x=="function"?x:Je(!!x),v):t},v.touchable=function(x){return arguments.length?(i=typeof x=="function"?x:Je(!!x),v):i},v.extent=function(x){return arguments.length?(e=typeof x=="function"?x:Je([[+x[0][0],+x[0][1]],[+x[1][0],+x[1][1]]]),v):e},v.scaleExtent=function(x){return arguments.length?(a[0]=+x[0],a[1]=+x[1],v):[a[0],a[1]]},v.translateExtent=function(x){return arguments.length?(o[0][0]=+x[0][0],o[1][0]=+x[1][0],o[0][1]=+x[0][1],o[1][1]=+x[1][1],v):[[o[0][0],o[0][1]],[o[1][0],o[1][1]]]},v.constrain=function(x){return arguments.length?(n=x,v):n},v.duration=function(x){return arguments.length?(l=+x,v):l},v.interpolate=function(x){return arguments.length?(c=x,v):c},v.on=function(){var x=s.on.apply(s,arguments);return x===s?v:x},v.clickDistance=function(x){return arguments.length?(m=(x=+x)*x,v):Math.sqrt(m)},v.tapDistance=function(x){return arguments.length?(y=+x,v):y},v}var Lu=ft('<div class="network-container w-full h-full bg-gray-50 rounded-lg border border-gray-200 svelte-126w1mt"></div>');function Xu(t,e){qr(e,!1);let n=Xt(e,"items",24,()=>[]),r=Xt(e,"neighbors",24,()=>({})),i=Xt(e,"onNodeClick",8,()=>{}),a=Xt(e,"onNodeHover",8,()=>{}),o=Xt(e,"selectedId",8,null),l=Xt(e,"maxNodes",8,500),c=Xt(e,"minScore",8,.02),s=Xt(e,"userSimilarity",24,()=>new Map),u=Xt(e,"userWeight",8,0),p=mt(),h=mt(),d=mt(),_=[],m=[],y=new Map,v=zu,k=1200,S=700,g;function A(){if(!f(p)||!f(h))return;const M=f(p).getBoundingClientRect();k=Math.max(320,Math.floor(M.width)),S=Math.max(400,S),f(h).attr("width",k).attr("height",S).attr("viewBox",[0,0,k,S])}function N(){A(),f(d)&&f(d).force("center",Cr(k/2,S/2)).alpha(.2).restart()}let T=null;Xr(()=>{R(),A(),typeof window<"u"&&(window.addEventListener("resize",N),T=()=>window.removeEventListener("resize",N))}),typeof window<"u"&&Vi(()=>{f(d)&&f(d).stop(),T&&T()});function R(){pt(h,Et(f(p)).append("svg").attr("width",k).attr("height",S).attr("viewBox",[0,0,k,S]).attr("style","max-width: 100%; height: auto;")),f(h).on("click",function(M){(M.target===this||M.target.tagName==="svg")&&i()("")}),g=Hu().scaleExtent([.1,10]).on("zoom",M=>{f(h).select(".graph-container").attr("transform",M.transform)}),f(h).call(g),f(h).append("g").attr("class","graph-container")}function W(){if(!f(h))return;const M=new Set,z=[];n().slice(0,l()).forEach(w=>{M.add(w.id)}),Object.entries(r()).forEach(([w,F])=>{M.has(w)&&F.forEach(q=>{M.has(q.id)&&q.score>=c()&&z.push({source:w,target:q.id,score:q.score,baseScore:q.score,S_text:q.S_text,S_date:q.S_date,S_place:q.S_place})})}),_=Array.from(M).map(w=>{const F=n().find(q=>q.id===w);return{id:w,title:Array.isArray(F?.title)?F.title[0]:F?.title||w,year:F?.year,type:F?.type,collection:F?.collection,degree:0,cluster:0}});const K=new Map;z.forEach(w=>{const F=typeof w.source=="string"?w.source:w.source.id,q=typeof w.target=="string"?w.target:w.target.id;K.set(F,(K.get(F)||0)+1),K.set(q,(K.get(q)||0)+1)}),_.forEach(w=>{w.degree=K.get(w.id)||0}),m=z,U(),Y(),x()}function B(M,z){return[M,z].sort().join("|")}function U(){if(m)for(const M of m){const z=typeof M.source=="string"?M.source:M.source.id,G=typeof M.target=="string"?M.target:M.target.id,K=Number.isFinite(M.baseScore)?M.baseScore:M.score,w=s()?.get(B(z,G))??0,F=Math.max(0,Math.min(1,K+(u()||0)*w));M.score=F}}function Y(){const M=new Map;m.forEach(w=>{const F=typeof w.source=="string"?w.source:w.source.id,q=typeof w.target=="string"?w.target:w.target.id,Z=Number.isFinite(w.score)?w.score:1;M.has(F)||M.set(F,new Map),M.has(q)||M.set(q,new Map),M.get(F).set(q,(M.get(F).get(q)||0)+Z),M.get(q).set(F,(M.get(q).get(F)||0)+Z)});const z=et(M,40);y.clear();const G=new Map;let K=0;for(const w of _){const F=z.get(w.id)||w.id;G.has(F)||G.set(F,K++),y.set(w.id,G.get(F))}_.forEach(w=>{w.cluster=y.get(w.id)||0})}function et(M,z=30){const G=new Map,K=_.map(w=>w.id);for(const w of K)G.set(w,w);for(let w=0;w<z;w++){let F=0;const q=K.slice();for(let Z=q.length-1;Z>0;Z--){const ht=Math.floor(Math.random()*(Z+1));[q[Z],q[ht]]=[q[ht],q[Z]]}for(const Z of q){const ht=M.get(Z);if(!ht||ht.size===0)continue;const jt=new Map;ht.forEach((at,st)=>{const lt=G.get(st)||st;jt.set(lt,(jt.get(lt)||0)+at)});let D=G.get(Z)||Z,tt=-1/0;jt.forEach((at,st)=>{(at>tt||at===tt&&st<D)&&(tt=at,D=st)}),D!==G.get(Z)&&(G.set(Z,D),F++)}if(F===0)break}return G}function x(){const M=f(h).select(".graph-container");M.selectAll("*").remove();const z=M.append("g").attr("class","links").selectAll("line").data(m).join("line").attr("stroke","#999").attr("stroke-opacity",w=>.2+w.score*.6).attr("stroke-width",w=>Math.max(.5,w.score*3)),G=M.append("g").attr("class","nodes").selectAll("g").data(_).join("g").attr("cursor","pointer").call(b(f(d)));G.append("circle").attr("r",w=>Math.max(3,Math.min(15,3+Math.sqrt(w.degree)))).attr("fill",w=>v[w.cluster%v.length]).attr("stroke","#fff").attr("stroke-width",1.5).on("click",(w,F)=>{w.stopPropagation(),i()(F.id)}).on("mouseover",function(w,F){Et(this).attr("stroke","#000").attr("stroke-width",2);try{a()(F.id)}catch{}const q=M.append("g").attr("class","tooltip").attr("transform",`translate(${F.x},${F.y})`),Z=q.append("text").attr("dy",-20).attr("text-anchor","middle").style("font-size","12px").style("font-weight","bold").style("fill","#000").style("pointer-events","none");Z.append("tspan").text(F.title.substring(0,50)+(F.title.length>50?"...":""));const ht=Z.node().getBBox();q.insert("rect","text").attr("x",ht.x-4).attr("y",ht.y-2).attr("width",ht.width+8).attr("height",ht.height+4).attr("fill","white").attr("stroke","#000").attr("rx",3)}).on("mouseout",function(){Et(this).attr("stroke","#fff").attr("stroke-width",1.5),M.selectAll(".tooltip").remove();try{a()(null)}catch{}}),G.filter(w=>w.degree>5).append("text").attr("dx",8).attr("dy",3).style("font-size","8px").style("fill","#333").style("pointer-events","none").text(w=>w.title.substring(0,20)),pt(d,Su(_).force("link",xu(m).id(w=>w.id).distance(w=>100-w.score*50).strength(w=>w.score)).force("charge",Tu().strength(-30).distanceMax(200)).force("cluster",E()).force("collision",mu().radius(w=>Math.max(3,Math.min(15,3+Math.sqrt(w.degree)))+2)).force("center",Cr(k/2,S/2)).on("tick",K));function K(){z.attr("x1",w=>w.source.x).attr("y1",w=>w.source.y).attr("x2",w=>w.target.x).attr("y2",w=>w.target.y),G.attr("transform",w=>`translate(${w.x},${w.y})`)}}function E(){let M;const G=k/2,K=S/2;function w(F){const q=new Map;M.forEach(Z=>{if(!q.has(Z.cluster)){const ht=Z.cluster/10*2*Math.PI,jt=200;q.set(Z.cluster,{x:G+Math.cos(ht)*jt,y:K+Math.sin(ht)*jt,count:0})}}),M.forEach(Z=>{const ht=q.get(Z.cluster);ht&&Z.x!==void 0&&Z.y!==void 0&&(Z.vx=(Z.vx||0)+(ht.x-Z.x)*.3*F,Z.vy=(Z.vy||0)+(ht.y-Z.y)*.3*F)})}return w.initialize=function(F){M=F},w}function b(M){function z(w){w.active||M.alphaTarget(.3).restart(),w.subject.fx=w.subject.x,w.subject.fy=w.subject.y}function G(w){w.subject.fx=w.x,w.subject.fy=w.y}function K(w){w.active||M.alphaTarget(0),w.subject.fx=null,w.subject.fy=null}return ps().on("start",z).on("drag",G).on("end",K)}function C(){if(!f(h)||!o())return;const M=new Set;M.add(o()),m.forEach(z=>{const G=typeof z.source=="string"?z.source:z.source.id,K=typeof z.target=="string"?z.target:z.target.id;G===o()&&M.add(K),K===o()&&M.add(G)}),f(h).select(".nodes").selectAll("g").attr("opacity",z=>M.has(z.id)?1:.15),f(h).select(".nodes").selectAll("circle").attr("stroke",z=>z.id===o()?"#ff0000":"#fff").attr("stroke-width",z=>z.id===o()?3:1.5),f(h).select(".links").selectAll("line").attr("stroke",z=>z.source.id===o()||z.target.id===o()?"#ff6b6b":"#999").attr("stroke-opacity",z=>z.source.id===o()||z.target.id===o()?.9:.08)}function L(){f(h)&&(f(h).select(".nodes").selectAll("g").attr("opacity",1),f(h).select(".nodes").selectAll("circle").attr("stroke","#fff").attr("stroke-width",1.5),f(h).select(".links").selectAll("line").attr("stroke","#999").attr("stroke-opacity",M=>.2+M.score*.6))}function V(){f(h)&&g&&f(h).transition().duration(750).call(g.transform,tr)}function X(){f(d)&&f(d).alpha(1).restart()}te(()=>(f(p),rt(n()),rt(r())),()=>{f(p)&&n().length>0&&r()&&W()}),te(()=>(f(h),rt(o())),()=>{f(h)&&(o()?C():L())}),te(()=>(f(d),f(h),rt(u()),rt(s())),()=>{if(f(d)&&f(h)){u(),s(),U(),Y(),f(h).select(".nodes").selectAll("circle").attr("fill",z=>v[(z.cluster??0)%v.length]),f(h).select(".links").selectAll("line").attr("stroke-opacity",z=>.2+z.score*.6).attr("stroke-width",z=>Math.max(.5,z.score*3));const M=f(d).force("link");M&&typeof M.distance=="function"&&typeof M.strength=="function"&&M.distance(z=>100-z.score*50).strength(z=>z.score),f(d).alpha(.6).restart()}}),Gr();var Q={resetZoom:V,reheat:X};Lr();var nt=Lu();return ye(nt,M=>pt(p,M),()=>f(p)),ct(t,nt),pr(e,"resetZoom",V),pr(e,"reheat",X),Wr(Q)}var Pu=ft('<img class="w-full h-auto rounded mb-2"/>'),Vu=ft('<div class="text-xs"> </div>'),Ou=ft('<div class="text-xs"> </div>'),Yu=ft('<a target="_blank" class="text-blue-600 text-sm hover:underline">View on Europeana</a>'),Bu=ft('<span class="text-purple-600 ml-1" title="User interaction boost"></span>'),qu=ft('<li class="py-2"><div class="flex items-start justify-between gap-2"><button class="text-left text-sm hover:underline"> </button> <span class="text-xs text-gray-600 whitespace-nowrap"> <!></span></div> <div class="mt-1"><div class="flex items-center gap-2 text-[11px] text-gray-600 flex-wrap"><span class="inline-flex items-center gap-1"><span class="inline-block w-2 h-2 bg-indigo-500 rounded"></span> </span> <span class="inline-flex items-center gap-1"><span class="inline-block w-2 h-2 bg-emerald-500 rounded"></span> </span> <span class="inline-flex items-center gap-1"><span class="inline-block w-2 h-2 bg-amber-500 rounded"></span> </span> <span><span class="inline-block w-2 h-2 bg-purple-500 rounded"></span> </span></div></div></li>'),Gu=ft('<div class="mt-4 border-t pt-3"><div class="flex items-center justify-between mb-2"><h4 class="font-semibold">Top neighbors</h4> <span class="text-[10px] text-gray-500"> </span></div> <ul class="divide-y"></ul></div>'),Wu=ft('<!> <div class="space-y-1"><div class="font-medium"> </div> <div class="text-xs text-gray-600"> </div> <!> <!> <!> <button> </button> <div class="text-[11px] text-gray-500 mt-1"> </div></div> <!>',1),Uu=ft('<p class="text-sm text-gray-600">Hover a node to preview it; click a node to keep it here until you hover another.</p>'),Ku=ft('<div class="border rounded-lg bg-white p-4 space-y-3"><div class="flex gap-4 items-center flex-wrap"><button class="px-3 py-1 bg-gray-600 text-white rounded text-sm">Reset Zoom</button> <button class="ml-auto px-3 py-1 rounded text-sm border bg-gray-100 hover:bg-gray-200" aria-controls="preview-panel"> </button> <button class="px-3 py-1 rounded text-sm border bg-red-50 hover:bg-red-100 text-red-700" title="Reset interaction history">Reset Interactions</button></div> <div class="flex flex-col lg:flex-row gap-4 items-start"><div class="flex-1 min-w-0"><!></div> <div role="separator" aria-orientation="vertical" class="hidden lg:block w-1 cursor-col-resize self-stretch bg-gray-300 hover:bg-gray-400 transition-colors" title="Drag to resize details panel"></div> <aside id="preview-panel"><h3 class="font-semibold mb-2">Details</h3> <!></aside></div></div>'),ju=ft("<option> </option>"),Qu=ft('<li class="p-0"><button type="button" class="w-full text-left p-2 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500"><div class="text-sm font-medium"> </div> <div class="text-xs text-gray-500"> </div></button></li>'),Zu=ft('<div class="border rounded p-3"><div class="text-lg font-semibold"> </div> <div class="text-sm text-gray-600"> </div></div>'),Ju=ft('<div class="text-gray-500">No item found.</div>'),tc=ft('<li class="p-2 flex justify-between items-center"><button class="text-left text-sm hover:underline"> </button> <span class="text-xs text-gray-500"> </span></li>'),ec=ft('<!> <div class="border rounded"><div class="px-3 py-2 font-semibold bg-gray-50">Closest neighbors</div> <ul class="divide-y max-h-[40vh] overflow-auto"></ul></div>',1),nc=ft('<p class="text-gray-600">Select an item on the left to see its "good neighbors."</p>'),rc=ft('<div class="grid md:grid-cols-3 gap-4 svelte-1uha8ag"><section class="md:col-span-1 space-y-3"><h2 class="text-lg font-semibold">Search & Filter</h2> <input class="border rounded px-2 py-1 w-full" placeholder="Search title"/> <div class="flex gap-2"><select class="border rounded px-2 py-1"><option>All languages</option><!></select> <input class="border rounded px-2 py-1 w-24" type="number" placeholder="Year "/> <input class="border rounded px-2 py-1 w-24" type="number" placeholder="Year "/></div> <ul class="border rounded divide-y max-h-[50vh] overflow-auto"></ul></section> <section class="md:col-span-2 space-y-4"><!></section></div>'),ic=ft(`<div class="mt-12 border-t-2 pt-8 bg-gradient-to-b from-gray-50 to-white"><div class="max-w-6xl mx-auto"><div class="text-center mb-8"><h2 class="text-3xl font-bold text-gray-800 mb-2">Understanding the Visualization</h2> <p class="text-gray-600">Follow the journey from concept to interaction</p></div> <div class="relative"><div class="hidden md:block absolute left-8 top-0 bottom-0 w-0.5 bg-gradient-to-b from-blue-400 via-green-400 via-purple-400 to-amber-400"></div> <div class="relative mb-8 md:mb-12"><div class="flex flex-col md:flex-row gap-4 items-start"><div class="flex-shrink-0 w-16 h-16 rounded-full bg-gradient-to-br from-blue-400 to-indigo-500 flex items-center justify-center text-white font-bold text-xl shadow-lg z-10"><span class="text-2xl"></span></div> <div class="flex-1 bg-white rounded-xl shadow-md hover:shadow-xl transition-shadow duration-300 border-l-4 border-blue-400"><details open class="group svelte-1uha8ag"><summary class="cursor-pointer p-6 select-none flex items-center justify-between svelte-1uha8ag"><div><div class="flex items-center gap-3 mb-1"><span class="text-xs font-semibold text-blue-600 uppercase tracking-wider">Step 1</span> <span class="text-gray-400"></span></div> <h3 class="text-xl font-bold text-gray-800">What are you seeing here?</h3> <p class="text-sm text-gray-500 mt-1">Discover the topology of connections</p></div> <span class="text-gray-400 text-xl group-open:rotate-180 transition-transform duration-300"></span></summary> <div class="px-6 pb-6 text-gray-600 space-y-3 animate-fadeIn border-t pt-4 svelte-1uha8ag"><p>Each node is an abstract representation of an archival item (digital object + digital 
                  artifact). Edges indicate similarity based on metadata such as titles, dates, places, 
                  or themes. Clusters emerge where items share multiple attributes, forming 
                  "neighborhoods" of related material.</p> <p>These neighborhoods shift as you interact with the archive: items you view, bookmark, 
                  or hover over influence the layout, bringing similar nodes closer to your focus. 
                  This simulates a personalized exploration of the archiveone in which your interests 
                  and questions shape the connections you see, surfacing related items that might remain 
                  hidden in traditional search or browsing workflows.</p></div></details></div></div></div> <div class="relative mb-8 md:mb-12"><div class="flex flex-col md:flex-row gap-4 items-start"><div class="flex-shrink-0 w-16 h-16 rounded-full bg-gradient-to-br from-green-400 to-emerald-500 flex items-center justify-center text-white font-bold text-xl shadow-lg z-10"><span class="text-2xl"></span></div> <div class="flex-1 bg-white rounded-xl shadow-md hover:shadow-xl transition-shadow duration-300 border-l-4 border-green-400"><details class="group svelte-1uha8ag"><summary class="cursor-pointer p-6 select-none flex items-center justify-between svelte-1uha8ag"><div><div class="flex items-center gap-3 mb-1"><span class="text-xs font-semibold text-green-600 uppercase tracking-wider">Step 2</span> <span class="text-gray-400"></span></div> <h3 class="text-xl font-bold text-gray-800">How to use it?</h3> <p class="text-sm text-gray-500 mt-1">Navigate and interact with the archive</p></div> <span class="text-gray-400 text-xl group-open:rotate-180 transition-transform duration-300"></span></summary> <div class="px-6 pb-6 text-gray-600 space-y-3 animate-fadeIn border-t pt-4 svelte-1uha8ag"><p>In Network View, hover over nodes to preview item details in the side panel; click a 
                  node to pin it there. Use the search and filter panel to locate specific items or narrow 
                  the view. The graph adjusts dynamically based on your interactions, highlighting items 
                  similar to those you engage with.</p> <p>From the details panel, you can bookmark items for later reference; these bookmarks 
                  also influence the layout, bringing related materials closer to your attention. You can 
                  explore each item's "top neighbors," with similarity scores broken down by attribute 
                  type. The more you interact, the more the graph adapts to your evolving interests.</p> <p class="text-sm italic text-gray-500"> Tip: You can reset your interaction history at any time to start fresh.</p></div></details></div></div></div> <div class="relative mb-8 md:mb-12"><div class="flex flex-col md:flex-row gap-4 items-start"><div class="flex-shrink-0 w-16 h-16 rounded-full bg-gradient-to-br from-purple-400 to-pink-500 flex items-center justify-center text-white font-bold text-xl shadow-lg z-10"><span class="text-2xl"></span></div> <div class="flex-1 bg-white rounded-xl shadow-md hover:shadow-xl transition-shadow duration-300 border-l-4 border-purple-400"><details class="group svelte-1uha8ag"><summary class="cursor-pointer p-6 select-none flex items-center justify-between svelte-1uha8ag"><div><div class="flex items-center gap-3 mb-1"><span class="text-xs font-semibold text-purple-600 uppercase tracking-wider">Step 3</span> <span class="text-gray-400"></span></div> <h3 class="text-xl font-bold text-gray-800">What about my data?</h3> <p class="text-sm text-gray-500 mt-1">Your privacy and data security</p></div> <span class="text-gray-400 text-xl group-open:rotate-180 transition-transform duration-300"></span></summary> <div class="px-6 pb-6 text-gray-600 space-y-3 animate-fadeIn border-t pt-4 svelte-1uha8ag"><p>Your interactions (views, hovers, bookmarks) are stored locally in your browser and 
                  are never transmitted to any server. This keeps your exploration private and 
                  personalized without external tracking.</p> <p>It also means your history will disappear if you clear your browser data or switch 
                  devices. This is a conceptual demo meant to prototype new modes of archival navigation, 
                  not a production platform.</p></div></details></div></div></div> <div class="relative"><div class="flex flex-col md:flex-row gap-4 items-start"><div class="flex-shrink-0 w-16 h-16 rounded-full bg-gradient-to-br from-amber-400 to-orange-500 flex items-center justify-center text-white font-bold text-xl shadow-lg z-10"><span class="text-2xl"></span></div> <div class="flex-1 bg-white rounded-xl shadow-md hover:shadow-xl transition-shadow duration-300 border-l-4 border-amber-400"><details class="group svelte-1uha8ag"><summary class="cursor-pointer p-6 select-none flex items-center justify-between svelte-1uha8ag"><div><div class="flex items-center gap-3 mb-1"><span class="text-xs font-semibold text-amber-600 uppercase tracking-wider">Step 4</span> <span class="text-gray-400"></span></div> <h3 class="text-xl font-bold text-gray-800">Why this visualization?</h3> <p class="text-sm text-gray-500 mt-1">The conceptual foundation</p></div> <span class="text-gray-400 text-xl group-open:rotate-180 transition-transform duration-300"></span></summary> <div class="px-6 pb-6 text-gray-600 space-y-3 animate-fadeIn border-t pt-4 svelte-1uha8ag"><p>Digital concepts are hard to grasp narratively. Technical jargon and algorithmic 
                  formulas often obscure more than they clarify, and recommendation systems can feel 
                  like black boxes even to their creators.</p> <p>By visualizing the relational topology of an archive, and allowing users to see how 
                  their interactions reshape that topology, this project aims to demystify how digital 
                  archives suggest, relate, and connect items. The visualization invites reflection on 
                  how meaning is constructed through adjacency and traversal, challenging traditional 
                  notions of archival organization and navigation.</p></div></details></div></div></div></div> <div class="flex justify-center mt-8"><button class="px-6 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-full text-sm font-medium transition-colors shadow-sm hover:shadow-md"> </button></div></div></div>`),ac=ft(`<div class="p-4 space-y-4"><div class="flex justify-between items-center"><h1 class="text-2xl font-bold">Graphical Archive</h1> <h2 class="text-sm text-gray-600">A Conceptual Visualization of the Graphical Topology of the Archive</h2> <div class="flex gap-2"><button>Network View</button> <button>List View</button></div></div> <div class="border-t pt-4"><p class="text-md text-gray-600 mb-3">This visualization sketches what we are calling the "graphical topology" of the archive: 
    a space where items relate to one another through textual metadata, dates, places, and 
    patterns of interaction. It is not a working archival platform but a conceptual model 
    meant to explore how archives might be navigated through relational proximity rather 
    than fixed hierarchies or linear search.</p></div> <!> <!></div>`);function pc(t,e){qr(e,!1);const n=()=>ie(Zt,"$selectedId",s),r=()=>ie(Dn,"$items",s),i=()=>ie(We,"$filters",s),a=()=>ie(Kr,"$byId",s),o=()=>ie(Ma,"$userSimilarity",s),l=()=>ie(xe,"$userInteractions",s),c=()=>ie(ka,"$neighborsOfSelected",s),[s,u]=ha(),p=mt(),h=mt(),d=mt();let _=Xt(e,"data",8),m=mt(!0),y=mt(),v=mt(!0),k=mt(null),S=mt([]);const g={text:.6,date:.2,place:.2,user:.5};let A=null,N=mt(360);const T=260,R=640;let W=!1,B=0,U=0,Y=mt([]),et=mt(!1);function x(){pt(et,!f(et)),f(Y).forEach(D=>{D&&(D.open=f(et))})}function E(D){return Array.isArray(D)?D:Array.isArray(D?.pairs)?D.pairs.map(tt=>({source:tt.a,target:tt.b,score:tt.score})):D?.graph?.edges??[]}Xr(()=>{if(Dn.set(_().metadata||[]),jr.set(E(_().neighbors)),typeof window<"u"){pt(v,window.innerWidth>=1024);const D=Number(localStorage.getItem("ga_panel_width"));!Number.isNaN(D)&&D>=T&&D<=R&&pt(N,D)}});let b=mt("");function C(D){D===""?Zt.set(null):(A&&(clearTimeout(A),A=null),Zt.set(D),xe.trackView(D))}function L(D){if(A&&(clearTimeout(A),A=null),pt(k,D),D){const tt=D;A=setTimeout(()=>{f(k)===tt&&(xe.trackHover(tt),Zt.set(tt)),A=null},3e3)}}function V(D){f(v)&&(W=!0,B="touches"in D?D.touches[0].clientX:D.clientX,U=f(N),window.addEventListener("mousemove",X),window.addEventListener("touchmove",X,{passive:!1}),window.addEventListener("mouseup",Q),window.addEventListener("touchend",Q),document.body.style.cursor="col-resize",document.body.style.userSelect="none")}function X(D){if(!W)return;if("preventDefault"in D)try{D.preventDefault()}catch{}const tt="touches"in D?D.touches[0].clientX:D.clientX,at=B-tt,st=Math.max(T,Math.min(R,U+at));pt(N,st)}function Q(){W=!1,window.removeEventListener("mousemove",X),window.removeEventListener("touchmove",X),window.removeEventListener("mouseup",Q),window.removeEventListener("touchend",Q),document.body.style.cursor="",document.body.style.userSelect=""}function nt(D,tt=10){if(!D)return[];const at=_()?.neighbors;return(Array.isArray(at)?[]:at?.[D]??[]).slice(0,tt).map(lt=>({...lt,item:a().get(lt.id)}))}te(()=>(f(k),n()),()=>{pt(p,f(k)??n()??null)}),te(()=>f(N),()=>{try{localStorage.setItem("ga_panel_width",String(f(N)))}catch{}}),te(()=>f(b),()=>{pt(h,f(b).toLowerCase())}),te(()=>(r(),f(h),i()),()=>{pt(d,r().filter(D=>{const tt=(Array.isArray(D.title)?D.title[0]:D.title)??"",at=!f(h)||String(tt).toLowerCase().includes(f(h)),st=D.language&&D.language[0]||"",lt=!i().lang||st===i().lang,kt=Number(D.year),Dt=(!i().yearFrom||kt>=i().yearFrom)&&(!i().yearTo||kt<=i().yearTo||Number.isNaN(kt));return at&&lt&&Dt}))}),te(()=>f(p),()=>{pt(S,nt(f(p),10))}),Gr(),Lr();var M=ac(),z=I(M),G=H(I(z),4),K=I(G),w=H(K,2);$(G),$(z);var F=H(z,4);{var q=D=>{var tt=Ku(),at=I(tt),st=I(at),lt=H(st,2),kt=I(lt,!0);$(lt);var Dt=H(lt,2);$(at);var ue=H(at,2),Ft=I(ue),ce=I(Ft);{var ne=J=>{ye(Xu(J,{get items(){return r()},get neighbors(){return rt(_()),P(()=>_().neighbors)},get userSimilarity(){return o()},get userWeight(){return P(()=>g.user)},get selectedId(){return n()},onNodeClick:C,onNodeHover:L,$$legacy:!0}),O=>pt(y,O),()=>f(y))};St(ce,J=>{J(ne)})}$(Ft);var Yt=H(Ft,2),zt=H(Yt,2),fe=H(I(zt),2);{var he=J=>{const O=Gt(()=>(a(),f(p),P(()=>a().get(f(p))))),Nt=Gt(()=>(rt(f(O)),P(()=>Array.isArray(f(O).title)?f(O).title[0]:f(O).title)));var At=Wu(),Ht=vr(At);{var $t=ut=>{var dt=Pu();wt(()=>{ge(dt,"src",(rt(f(O)),P(()=>f(O).thumbnail))),ge(dt,"alt",f(Nt)||"thumbnail")}),ct(ut,dt)};St(Ht,ut=>{rt(f(O)),P(()=>f(O).thumbnail)&&ut($t)})}var gt=H(Ht,2),j=I(gt),Qt=I(j,!0);$(j);var It=H(j,2),Lt=I(It);$(It);var de=H(It,2);{var re=ut=>{var dt=Vu(),Bt=I(dt);$(dt),wt(()=>ot(Bt,`Country: ${rt(f(O)),P(()=>f(O).country)??""}`)),ct(ut,dt)};St(de,ut=>{rt(f(O)),P(()=>f(O).country)&&ut(re)})}var ve=H(de,2);{var Ne=ut=>{var dt=Ou(),Bt=I(dt);$(dt),wt(()=>ot(Bt,`Collection: ${rt(f(O)),P(()=>f(O).collection)??""}`)),ct(ut,dt)};St(ve,ut=>{rt(f(O)),P(()=>f(O).collection)&&ut(Ne)})}var er=H(ve,2);{var Ni=ut=>{var dt=Yu();wt(()=>ge(dt,"href",(rt(f(O)),P(()=>f(O).link)))),ct(ut,dt)};St(er,ut=>{rt(f(O)),P(()=>f(O).link)&&ut(Ni)})}var Ae=H(er,2),Ai=I(Ae,!0);$(Ae);var nr=H(Ae,2),Mi=I(nr);$(nr),$(gt);var Si=H(gt,2);{var Ti=ut=>{var dt=Gu(),Bt=I(dt),Oe=H(I(Bt),2),Ei=I(Oe);$(Oe),$(Bt);var rr=H(Bt,2);Ge(rr,5,()=>f(S),qe,(zi,vt)=>{const ir=Gt(()=>(f(vt),P(()=>Array.isArray(f(vt).item?.title)?f(vt).item?.title[0]:f(vt).item?.title))),pe=Gt(()=>(o(),f(p),f(vt),P(()=>o().get([f(p),f(vt).id].sort().join("|"))??0))),ar=Gt(()=>(f(vt),rt(f(pe)),P(()=>(f(vt).score??0)+g.user*f(pe))));var gn=qu(),mn=I(gn),Ye=I(mn),$i=I(Ye,!0);$(Ye);var or=H(Ye,2),sr=I(or),Ii=H(sr);{var Ci=Me=>{var bn=Bu();ct(Me,bn)};St(Ii,Me=>{f(pe)>0&&Me(Ci)})}$(or),$(mn);var lr=H(mn,2),ur=I(lr),yn=I(ur),Ri=H(I(yn));$(yn);var xn=H(yn,2),Di=H(I(xn));$(xn);var _n=H(xn,2),Fi=H(I(_n));$(_n);var wn=H(_n,2),Hi=H(I(wn));$(wn),$(ur),$(lr),$(gn),wt((Me,bn,Li,Xi,Pi)=>{ot($i,(rt(f(ir)),f(vt),P(()=>f(ir)??f(vt).title??f(vt).id))),ot(sr,`${Me??""} `),ot(Ri,`Text ${bn??""}`),ot(Di,`Date ${Li??""}`),ot(Fi,`Place ${Xi??""}`),Te(wn,1,`inline-flex items-center gap-1 ${f(pe)>0?"text-purple-600 font-medium":""}`),ot(Hi,`User ${Pi??""}`)},[()=>(rt(f(ar)),P(()=>f(ar).toFixed(2))),()=>(f(vt),P(()=>Number(f(vt).S_text??0).toFixed(2))),()=>(f(vt),P(()=>Number(f(vt).S_date??0).toFixed(2))),()=>(f(vt),P(()=>Number(f(vt).S_place??0).toFixed(2))),()=>(rt(f(pe)),P(()=>f(pe).toFixed(2)))]),yt("click",Ye,()=>{Zt.set(f(vt).id),pt(k,null)}),ct(zi,gn)}),$(rr),$(dt),wt(()=>ot(Ei,`G = ${P(()=>g.text)??""}Text + ${P(()=>g.date)??""}Date + ${P(()=>g.place)??""}Place + ${P(()=>g.user)??""}User`)),ct(ut,dt)};St(Si,ut=>{f(S),P(()=>f(S).length)&&ut(Ti)})}wt((ut,dt,Bt,Oe)=>{ot(Qt,f(Nt)??"(no title)"),ot(Lt,`${rt(f(O)),P(()=>f(O).year??"")??""}  ${ut??""}`),Te(Ae,1,`mt-2 px-2 py-1 text-xs rounded ${dt??""}`),ot(Ai,Bt),ot(Mi,`Hover views: ${Oe??""}`)},[()=>(rt(f(O)),P(()=>f(O).language&&f(O).language.join(", ")||"")),()=>(l(),f(p),P(()=>l().bookmarks.has(f(p))?"bg-yellow-100 text-yellow-800 border border-yellow-300":"bg-gray-100 text-gray-700 border border-gray-300")),()=>(l(),f(p),P(()=>l().bookmarks.has(f(p))?" Bookmarked":" Bookmark")),()=>(l(),f(p),P(()=>l().hoverTimestamps?.get(f(p))?.length||0))]),yt("click",Ae,()=>xe.toggleBookmark(f(p))),ct(J,At)},it=J=>{var O=Uu();ct(J,O)};St(fe,J=>{f(p),a(),P(()=>f(p)&&a().get(f(p)))?J(he):J(it,!1)})}$(zt),$(ue),$(tt),wt(()=>{ge(lt,"aria-expanded",f(v)),ot(kt,f(v)?"Hide panel":"Show panel"),ge(Yt,"aria-hidden",!f(v)),Te(zt,1,`border rounded-lg p-3 bg-gray-50 max-h-[80vh] overflow-auto w-full lg:w-auto flex-shrink-0 ${f(v)?"block":"hidden"}`),ge(zt,"aria-hidden",!f(v)),ya(zt,`width: ${f(v)?f(N)+"px":"auto"}`)}),yt("click",st,()=>f(y)?.resetZoom()),yt("click",lt,()=>pt(v,!f(v))),yt("click",Dt,()=>{confirm("Clear all tracked views and bookmarks?")&&xe.reset()}),yt("mousedown",Yt,V),yt("touchstart",Yt,V),ct(D,tt)},Z=D=>{var tt=rc(),at=I(tt),st=H(I(at),2);da(st);var lt=H(st,2),kt=I(lt),Dt=I(kt);Dt.value=Dt.__value="";var ue=H(Dt);Ge(ue,1,()=>(r(),P(()=>Array.from(new Set(r().flatMap(it=>it.language||[]))))),qe,(it,J)=>{var O=ju(),Nt=I(O,!0);$(O);var At={};wt(()=>{ot(Nt,f(J)),At!==(At=f(J))&&(O.value=(O.__value=f(J))??"")}),ct(it,O)}),$(kt);var Ft=H(kt,2),ce=H(Ft,2);$(lt);var ne=H(lt,2);Ge(ne,5,()=>(f(d),P(()=>f(d).slice(0,200))),qe,(it,J)=>{var O=Qu(),Nt=I(O),At=I(Nt),Ht=I(At,!0);$(At);var $t=H(At,2),gt=I($t);$($t),$(Nt),$(O),wt((j,Qt)=>{ot(Ht,j),ot(gt,`${f(J),P(()=>f(J).year)??""}  ${Qt??""}`)},[()=>(f(J),P(()=>Array.isArray(f(J).title)?f(J).title[0]:f(J).title)),()=>(f(J),P(()=>f(J).language&&f(J).language.join(", ")||""))]),yt("click",Nt,()=>Zt.set(f(J).id)),ct(it,O)}),$(ne),$(at);var Yt=H(at,2),zt=I(Yt);{var fe=it=>{var J=ec(),O=vr(J);{var Nt=gt=>{const j=Gt(()=>(a(),n(),P(()=>a().get(n())))),Qt=Gt(()=>(rt(f(j)),P(()=>Array.isArray(f(j).title)?f(j).title[0]:f(j).title)));var It=Zu(),Lt=I(It),de=I(Lt,!0);$(Lt);var re=H(Lt,2),ve=I(re);$(re),$(It),wt(Ne=>{ot(de,f(Qt)??"(no title)"),ot(ve,`${rt(f(j)),P(()=>f(j).year??"")??""}  ${Ne??""}`)},[()=>(rt(f(j)),P(()=>f(j).language&&f(j).language.join(", ")||""))]),ct(gt,It)},At=gt=>{var j=Ju();ct(gt,j)};St(O,gt=>{a(),n(),P(()=>a().get(n()))?gt(Nt):gt(At,!1)})}var Ht=H(O,2),$t=H(I(Ht),2);Ge($t,5,c,qe,(gt,j)=>{const Qt=Gt(()=>(f(j),P(()=>Array.isArray(f(j).item?.title)?f(j).item?.title[0]:f(j).item?.title)));var It=tc(),Lt=I(It),de=I(Lt,!0);$(Lt);var re=H(Lt,2),ve=I(re,!0);$(re),$(It),wt(Ne=>{ot(de,(rt(f(Qt)),f(j),P(()=>f(Qt)??f(j).id))),ot(ve,Ne)},[()=>(f(j),P(()=>f(j).score.toFixed(2)))]),yt("click",Lt,()=>Zt.set(f(j).id)),ct(gt,It)}),$($t),$(Ht),ct(it,J)},he=it=>{var J=nc();ct(it,J)};St(zt,it=>{n()?it(fe):it(he,!1)})}$(Yt),$(tt),xa(st,()=>f(b),it=>pt(b,it)),yt("change",kt,it=>We.set({...i(),lang:it.target.value||void 0})),yt("change",Ft,it=>We.set({...i(),yearFrom:Number(it.target.value)||void 0})),yt("change",ce,it=>We.set({...i(),yearTo:Number(it.target.value)||void 0})),ct(D,tt)};St(F,D=>{f(m)?D(q):D(Z,!1)})}var ht=H(F,2);{var jt=D=>{var tt=ic(),at=I(tt),st=H(I(at),2),lt=H(I(st),2),kt=I(lt),Dt=H(I(kt),2),ue=I(Dt);ye(ue,j=>Be(Y,f(Y)[0]=j),()=>f(Y)?.[0]),$(Dt),$(kt),$(lt);var Ft=H(lt,2),ce=I(Ft),ne=H(I(ce),2),Yt=I(ne);ye(Yt,j=>Be(Y,f(Y)[1]=j),()=>f(Y)?.[1]),$(ne),$(ce),$(Ft);var zt=H(Ft,2),fe=I(zt),he=H(I(fe),2),it=I(he);ye(it,j=>Be(Y,f(Y)[2]=j),()=>f(Y)?.[2]),$(he),$(fe),$(zt);var J=H(zt,2),O=I(J),Nt=H(I(O),2),At=I(Nt);ye(At,j=>Be(Y,f(Y)[3]=j),()=>f(Y)?.[3]),$(Nt),$(O),$(J),$(st);var Ht=H(st,2),$t=I(Ht),gt=I($t,!0);$($t),$(Ht),$(at),$(tt),wt(()=>ot(gt,f(et)?" Collapse All Steps":" Expand All Steps")),yt("click",$t,x),ct(D,tt)};St(ht,D=>{f(m)&&D(jt)})}$(M),wt(()=>{Te(K,1,`px-4 py-2 rounded ${f(m)?"bg-blue-600 text-white":"bg-gray-200"}`),Te(w,1,`px-4 py-2 rounded ${f(m)?"bg-gray-200":"bg-blue-600 text-white"}`)}),yt("click",K,()=>pt(m,!0)),yt("click",w,()=>pt(m,!1)),ct(t,M),Wr(),u()}export{pc as component,vc as universal};
