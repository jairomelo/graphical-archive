import{a as Sa,b as Ta}from"../chunks/9J9VfSXx.js";import{f as _t,a as mt,e as bt,s as j}from"../chunks/DtOTFtxs.js";import{i as oi}from"../chunks/aT1KbmMU.js";import{d as Kn,w as Se,o as li,a as Ea}from"../chunks/SiFdexJ-.js";import{e as ui,F as $a,aM as ci,M as An,h as Nt,ab as za,G as Ia,t as u,a0 as ie,I as Ca,J as Ra,K as Rr,O as Sn,i as me,ac as Da,aK as Fa,f as Pn,s as Ha,aN as tn,aO as en,c as ae,as as Dr,V as ct,ak as Fr,aI as fi,aP as Pa,r as hi,p as La,aQ as Xa,aR as Tn,q as Oa,d as di,aS as Ba,ad as Va,aT as Ya,aH as qa,aU as Wa,_ as Ga,aV as Ua,ah as Ka,l as P,Q as Qa,aW as Za,X as Ja,R as ja,y as pi,W as st,aX as kt,v as tt,aY as gi,B as vi,C as D,A as Et,E as H,D as z,ae as ts,aZ as De,z as es}from"../chunks/BM_x5Dol.js";import{p as yt,b as mi,i as Ot,s as ns,a as ee}from"../chunks/Ds825DM1.js";import{s as Gt,r as ne}from"../chunks/CeiPr8Dp.js";function En(t,e){return e}function rs(t,e,n){for(var r=t.items,i=[],a=e.length,s=0;s<a;s++)Ya(e[s].e,i,!0);var l=a>0&&i.length===0&&n!==null;if(l){var f=n.parentNode;qa(f),f.append(n),r.clear(),$t(t,e[0].prev,e[a-1].next)}Wa(i,()=>{for(var o=0;o<a;o++){var c=e[o];l||(r.delete(c.k),$t(t,c.prev,c.next)),di(c.e,!l)}})}function $n(t,e,n,r,i,a=null){var s=t,l={flags:e,items:new Map,first:null},f=(e&ci)!==0;if(f){var o=t;s=Nt?An(za(o)):o.appendChild(ui())}Nt&&Ia();var c=null,x=!1,h=new Map,v=ie(()=>{var g=n();return Pa(g)?g:g==null?[]:fi(g)}),w,d;function p(){is(d,w,l,h,s,i,e,r,n),a!==null&&(w.length===0?c?hi(c):c=Pn(()=>a(s)):c!==null&&La(c,()=>{c=null}))}$a(()=>{d??=Ga,w=u(v);var g=w.length;if(x&&g===0)return;x=g===0;let b=!1;if(Nt){var E=Ca(s)===Ra;E!==(g===0)&&(s=Rr(),An(s),Sn(!1),b=!0)}if(Nt){for(var m=null,_,k=0;k<g;k++){if(me.nodeType===Da&&me.data===Fa){s=me,b=!0,Sn(!1);break}var A=w[k],C=r(A,k);_=Ln(me,l,m,null,A,C,k,i,e,n),l.items.set(C,_),m=_}g>0&&An(Rr())}if(Nt)g===0&&a&&(c=Pn(()=>a(s)));else if(Ha()){var q=new Set,V=ae;for(k=0;k<g;k+=1){A=w[k],C=r(A,k);var G=l.items.get(C)??h.get(C);G?(e&(tn|en))!==0&&yi(G,A,k,e):(_=Ln(null,l,null,null,A,C,k,i,e,n,!0),h.set(C,_)),q.add(C)}for(const[K,et]of l.items)q.has(K)||V.skipped_effects.add(et.e);V.oncommit(p)}else p();b&&Sn(!0),u(v)}),Nt&&(s=me)}function is(t,e,n,r,i,a,s,l,f){var o=(s&Ba)!==0,c=(s&(tn|en))!==0,x=e.length,h=n.items,v=n.first,w=v,d,p=null,g,b=[],E=[],m,_,k,A;if(o)for(A=0;A<x;A+=1)m=e[A],_=l(m,A),k=h.get(_),k!==void 0&&(k.a?.measure(),(g??=new Set).add(k));for(A=0;A<x;A+=1){if(m=e[A],_=l(m,A),k=h.get(_),k===void 0){var C=r.get(_);if(C!==void 0){r.delete(_),h.set(_,C);var q=p?p.next:w;$t(n,p,C),$t(n,C,q),zn(C,q,i),p=C}else{var V=w?w.e.nodes_start:i;p=Ln(V,n,p,p===null?n.first:p.next,m,_,A,a,s,f)}h.set(_,p),b=[],E=[],w=p.next;continue}if(c&&yi(k,m,A,s),(k.e.f&Tn)!==0&&(hi(k.e),o&&(k.a?.unfix(),(g??=new Set).delete(k))),k!==w){if(d!==void 0&&d.has(k)){if(b.length<E.length){var G=E[0],K;p=G.prev;var et=b[0],y=b[b.length-1];for(K=0;K<b.length;K+=1)zn(b[K],G,i);for(K=0;K<E.length;K+=1)d.delete(E[K]);$t(n,et.prev,y.next),$t(n,p,et),$t(n,y,G),w=G,p=y,A-=1,b=[],E=[]}else d.delete(k),zn(k,w,i),$t(n,k.prev,k.next),$t(n,k,p===null?n.first:p.next),$t(n,p,k),p=k;continue}for(b=[],E=[];w!==null&&w.k!==_;)(w.e.f&Tn)===0&&(d??=new Set).add(w),E.push(w),w=w.next;if(w===null)continue;k=w}b.push(k),p=k,w=k.next}if(w!==null||d!==void 0){for(var $=d===void 0?[]:fi(d);w!==null;)(w.e.f&Tn)===0&&$.push(w),w=w.next;var N=$.length;if(N>0){var R=(s&ci)!==0&&x===0?i:null;if(o){for(A=0;A<N;A+=1)$[A].a?.measure();for(A=0;A<N;A+=1)$[A].a?.fix()}rs(n,$,R)}}o&&Oa(()=>{if(g!==void 0)for(k of g)k.a?.apply()}),t.first=n.first&&n.first.e,t.last=p&&p.e;for(var L of r.values())di(L.e);r.clear()}function yi(t,e,n,r){(r&tn)!==0&&Dr(t.v,e),(r&en)!==0?Dr(t.i,n):t.i=n}function Ln(t,e,n,r,i,a,s,l,f,o,c){var x=(f&tn)!==0,h=(f&Xa)===0,v=x?h?ct(i,!1,!1):Fr(i):i,w=(f&en)===0?s:Fr(s),d={i:w,v,k:a,a:null,e:null,prev:n,next:r};try{if(t===null){var p=document.createDocumentFragment();p.append(t=ui())}return d.e=Pn(()=>l(t,v,w,o),Nt),d.e.prev=n&&n.e,d.e.next=r&&r.e,n===null?c||(e.first=d):(n.next=d,n.e.next=d.e),r!==null&&(r.prev=d,r.e.prev=d.e),d}finally{}}function zn(t,e,n){for(var r=t.next?t.next.e.nodes_start:n,i=e?e.e.nodes_start:n,a=t.e.nodes_start;a!==null&&a!==r;){var s=Va(a);i.before(a),a=s}}function $t(t,e,n){e===null?t.first=n:(e.next=n,e.e.next=n&&n.e),n!==null&&(n.prev=e,n.e.prev=e&&e.e)}function as(t,e,n){var r=t==null?"":""+t;return r===""?null:r}function ss(t,e){return t==null?null:String(t)}function Fe(t,e,n,r,i,a){var s=t.__className;if(Nt||s!==n||s===void 0){var l=as(n);(!Nt||l!==t.getAttribute("class"))&&(l==null?t.removeAttribute("class"):t.className=l),t.__className=n}return a}function os(t,e,n,r){var i=t.__style;if(Nt||i!==e){var a=ss(e);(!Nt||a!==t.getAttribute("style"))&&(a==null?t.removeAttribute("style"):t.style.cssText=a),t.__style=e}return r}function re(t,e,n=e){var r=new WeakSet;Ua(t,"input",async i=>{var a=i?t.defaultValue:t.value;if(a=In(t)?Cn(a):a,n(a),ae!==null&&r.add(ae),await Ka(),a!==(a=e())){var s=t.selectionStart,l=t.selectionEnd,f=t.value.length;if(t.value=a??"",l!==null){var o=t.value.length;s===l&&l===f&&o>f?(t.selectionStart=o,t.selectionEnd=o):(t.selectionStart=s,t.selectionEnd=Math.min(l,o))}}}),(Nt&&t.defaultValue!==t.value||P(e)==null&&t.value)&&(n(In(t)?Cn(t.value):t.value),ae!==null&&r.add(ae)),Qa(()=>{var i=e();if(t===document.activeElement){var a=Za??ae;if(r.has(a))return}In(t)&&i===Cn(t.value)||t.type==="date"&&!i&&!t.value||i!==t.value&&(t.value=i??"")})}function In(t){var e=t.type;return e==="number"||e==="range"}function Cn(t){return t===""?null:+t}function Hr(t,e,n){var r=Ja(t,e);r&&r.set&&(t[e]=n,ja(()=>{t[e]=null}))}function ls(t){return function(...e){var n=e[0];return n.stopPropagation(),t?.apply(this,e)}}function Pr(t){return(Sa||Ta)+t}const us=!1,cs=!0;async function fs({fetch:t}){const[e,n]=await Promise.all([t(Pr("/data/europeana_metadata.json")),t(Pr("/data/europeana_neighbors.json"))]);return{metadata:await e.json(),neighbors:await n.json()}}const Gc=Object.freeze(Object.defineProperty({__proto__:null,load:fs,prerender:cs,ssr:us},Symbol.toStringTag,{value:"Module"})),Xn=Se([]),xi=Kn(Xn,t=>{const e=new Map;for(const n of t)e.set(n.id,n);return e}),_i=Se([]),Ut=Se(null),He=Se({});Kn([Ut,_i,xi],([t,e,n])=>t?e.filter(r=>r.source===t||r.target===t).map(r=>({id:r.source===t?r.target:r.source,score:r.score,item:n.get(r.source===t?r.target:r.source)})).filter(r=>r.item).sort((r,i)=>i.score-r.score):[]);function hs(){if(typeof window>"u")return{views:new Set,bookmarks:new Set,viewTimestamps:new Map,hoverTimestamps:new Map};try{const t=sessionStorage.getItem("europeana_user_interactions");if(!t)return{views:new Set,bookmarks:new Set,viewTimestamps:new Map,hoverTimestamps:new Map};const e=JSON.parse(t);return{views:new Set(e.views||[]),bookmarks:new Set(e.bookmarks||[]),viewTimestamps:new Map(e.viewTimestamps||[]),hoverTimestamps:new Map(e.hoverTimestamps||[])}}catch{return{views:new Set,bookmarks:new Set,viewTimestamps:new Map,hoverTimestamps:new Map}}}function Pe(t){if(!(typeof window>"u"))try{sessionStorage.setItem("europeana_user_interactions",JSON.stringify({views:Array.from(t.views),bookmarks:Array.from(t.bookmarks),viewTimestamps:Array.from(t.viewTimestamps.entries()),hoverTimestamps:Array.from((t.hoverTimestamps||new Map).entries())}))}catch(e){console.warn("Failed to save interactions:",e)}}function ds(){const{subscribe:t,update:e}=Se(hs());return{subscribe:t,trackView:n=>e(r=>{r.views.add(n);const i=r.viewTimestamps.get(n)||[];return i.push(Date.now()),r.viewTimestamps.set(n,i),Pe(r),r}),trackHover:n=>e(r=>{r.hoverTimestamps=r.hoverTimestamps||new Map;const i=r.hoverTimestamps.get(n)||[];return i.push(Date.now()),r.hoverTimestamps.set(n,i),Pe(r),r}),toggleBookmark:n=>e(r=>(r.bookmarks.has(n)?r.bookmarks.delete(n):r.bookmarks.add(n),Pe(r),r)),reset:()=>e(()=>{const n={views:new Set,bookmarks:new Set,viewTimestamps:new Map,hoverTimestamps:new Map};return Pe(n),n})}}const se=ds(),ps=Kn([se],([t])=>{Array.from(t.views);const e=Array.from(t.bookmarks),n=new Map,r=new Map,i=Array.from(t.viewTimestamps.entries()).sort((o,c)=>{const x=o[1][o[1].length-1]||0,h=c[1][c[1].length-1]||0;return x-h}).map(o=>o[0]),a=5;for(let o=0;o<i.length;o++)for(let c=o+1;c<Math.min(o+a,i.length);c++){const x=[i[o],i[c]].sort().join("|");n.set(x,(n.get(x)||0)+1)}for(let o=0;o<e.length;o++)for(let c=o+1;c<e.length;c++){const x=[e[o],e[c]].sort().join("|");r.set(x,(r.get(x)||0)+1)}const s=new Map,l=Math.max(1,...Array.from(n.values())),f=Math.max(1,...Array.from(r.values()));return n.forEach((o,c)=>{s.set(c,(s.get(c)||0)+.4*(o/l))}),r.forEach((o,c)=>{s.set(c,(s.get(c)||0)+.6*(o/f))}),s});var gs={value:()=>{}};function Te(){for(var t=0,e=arguments.length,n={},r;t<e;++t){if(!(r=arguments[t]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new Ye(n)}function Ye(t){this._=t}function vs(t,e){return t.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}Ye.prototype=Te.prototype={constructor:Ye,on:function(t,e){var n=this._,r=vs(t+"",n),i,a=-1,s=r.length;if(arguments.length<2){for(;++a<s;)if((i=(t=r[a]).type)&&(i=ms(n[i],t.name)))return i;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++a<s;)if(i=(t=r[a]).type)n[i]=Lr(n[i],t.name,e);else if(e==null)for(i in n)n[i]=Lr(n[i],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new Ye(t)},call:function(t,e){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,a;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(a=this._[t],r=0,i=a.length;r<i;++r)a[r].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,a=r.length;i<a;++i)r[i].value.apply(e,n)}};function ms(t,e){for(var n=0,r=t.length,i;n<r;++n)if((i=t[n]).name===e)return i.value}function Lr(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=gs,t=t.slice(0,r).concat(t.slice(r+1));break}return n!=null&&t.push({name:e,value:n}),t}var On="http://www.w3.org/1999/xhtml";const Xr={svg:"http://www.w3.org/2000/svg",xhtml:On,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function nn(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),Xr.hasOwnProperty(e)?{space:Xr[e],local:t}:t}function ys(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===On&&e.documentElement.namespaceURI===On?e.createElement(t):e.createElementNS(n,t)}}function xs(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function wi(t){var e=nn(t);return(e.local?xs:ys)(e)}function _s(){}function Qn(t){return t==null?_s:function(){return this.querySelector(t)}}function ws(t){typeof t!="function"&&(t=Qn(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var a=e[i],s=a.length,l=r[i]=new Array(s),f,o,c=0;c<s;++c)(f=a[c])&&(o=t.call(f,f.__data__,c,a))&&("__data__"in f&&(o.__data__=f.__data__),l[c]=o);return new xt(r,this._parents)}function bs(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function ks(){return[]}function bi(t){return t==null?ks:function(){return this.querySelectorAll(t)}}function Ns(t){return function(){return bs(t.apply(this,arguments))}}function Ms(t){typeof t=="function"?t=Ns(t):t=bi(t);for(var e=this._groups,n=e.length,r=[],i=[],a=0;a<n;++a)for(var s=e[a],l=s.length,f,o=0;o<l;++o)(f=s[o])&&(r.push(t.call(f,f.__data__,o,s)),i.push(f));return new xt(r,i)}function ki(t){return function(){return this.matches(t)}}function Ni(t){return function(e){return e.matches(t)}}var As=Array.prototype.find;function Ss(t){return function(){return As.call(this.children,t)}}function Ts(){return this.firstElementChild}function Es(t){return this.select(t==null?Ts:Ss(typeof t=="function"?t:Ni(t)))}var $s=Array.prototype.filter;function zs(){return Array.from(this.children)}function Is(t){return function(){return $s.call(this.children,t)}}function Cs(t){return this.selectAll(t==null?zs:Is(typeof t=="function"?t:Ni(t)))}function Rs(t){typeof t!="function"&&(t=ki(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var a=e[i],s=a.length,l=r[i]=[],f,o=0;o<s;++o)(f=a[o])&&t.call(f,f.__data__,o,a)&&l.push(f);return new xt(r,this._parents)}function Mi(t){return new Array(t.length)}function Ds(){return new xt(this._enter||this._groups.map(Mi),this._parents)}function Ue(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}Ue.prototype={constructor:Ue,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function Fs(t){return function(){return t}}function Hs(t,e,n,r,i,a){for(var s=0,l,f=e.length,o=a.length;s<o;++s)(l=e[s])?(l.__data__=a[s],r[s]=l):n[s]=new Ue(t,a[s]);for(;s<f;++s)(l=e[s])&&(i[s]=l)}function Ps(t,e,n,r,i,a,s){var l,f,o=new Map,c=e.length,x=a.length,h=new Array(c),v;for(l=0;l<c;++l)(f=e[l])&&(h[l]=v=s.call(f,f.__data__,l,e)+"",o.has(v)?i[l]=f:o.set(v,f));for(l=0;l<x;++l)v=s.call(t,a[l],l,a)+"",(f=o.get(v))?(r[l]=f,f.__data__=a[l],o.delete(v)):n[l]=new Ue(t,a[l]);for(l=0;l<c;++l)(f=e[l])&&o.get(h[l])===f&&(i[l]=f)}function Ls(t){return t.__data__}function Xs(t,e){if(!arguments.length)return Array.from(this,Ls);var n=e?Ps:Hs,r=this._parents,i=this._groups;typeof t!="function"&&(t=Fs(t));for(var a=i.length,s=new Array(a),l=new Array(a),f=new Array(a),o=0;o<a;++o){var c=r[o],x=i[o],h=x.length,v=Os(t.call(c,c&&c.__data__,o,r)),w=v.length,d=l[o]=new Array(w),p=s[o]=new Array(w),g=f[o]=new Array(h);n(c,x,d,p,g,v,e);for(var b=0,E=0,m,_;b<w;++b)if(m=d[b]){for(b>=E&&(E=b+1);!(_=p[E])&&++E<w;);m._next=_||null}}return s=new xt(s,r),s._enter=l,s._exit=f,s}function Os(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function Bs(){return new xt(this._exit||this._groups.map(Mi),this._parents)}function Vs(t,e,n){var r=this.enter(),i=this,a=this.exit();return typeof t=="function"?(r=t(r),r&&(r=r.selection())):r=r.append(t+""),e!=null&&(i=e(i),i&&(i=i.selection())),n==null?a.remove():n(a),r&&i?r.merge(i).order():i}function Ys(t){for(var e=t.selection?t.selection():t,n=this._groups,r=e._groups,i=n.length,a=r.length,s=Math.min(i,a),l=new Array(i),f=0;f<s;++f)for(var o=n[f],c=r[f],x=o.length,h=l[f]=new Array(x),v,w=0;w<x;++w)(v=o[w]||c[w])&&(h[w]=v);for(;f<i;++f)l[f]=n[f];return new xt(l,this._parents)}function qs(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r=t[e],i=r.length-1,a=r[i],s;--i>=0;)(s=r[i])&&(a&&s.compareDocumentPosition(a)^4&&a.parentNode.insertBefore(s,a),a=s);return this}function Ws(t){t||(t=Gs);function e(x,h){return x&&h?t(x.__data__,h.__data__):!x-!h}for(var n=this._groups,r=n.length,i=new Array(r),a=0;a<r;++a){for(var s=n[a],l=s.length,f=i[a]=new Array(l),o,c=0;c<l;++c)(o=s[c])&&(f[c]=o);f.sort(e)}return new xt(i,this._parents).order()}function Gs(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function Us(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function Ks(){return Array.from(this)}function Qs(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,a=r.length;i<a;++i){var s=r[i];if(s)return s}return null}function Zs(){let t=0;for(const e of this)++t;return t}function Js(){return!this.node()}function js(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i=e[n],a=0,s=i.length,l;a<s;++a)(l=i[a])&&t.call(l,l.__data__,a,i);return this}function to(t){return function(){this.removeAttribute(t)}}function eo(t){return function(){this.removeAttributeNS(t.space,t.local)}}function no(t,e){return function(){this.setAttribute(t,e)}}function ro(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function io(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function ao(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function so(t,e){var n=nn(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((e==null?n.local?eo:to:typeof e=="function"?n.local?ao:io:n.local?ro:no)(n,e))}function Ai(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function oo(t){return function(){this.style.removeProperty(t)}}function lo(t,e,n){return function(){this.style.setProperty(t,e,n)}}function uo(t,e,n){return function(){var r=e.apply(this,arguments);r==null?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function co(t,e,n){return arguments.length>1?this.each((e==null?oo:typeof e=="function"?uo:lo)(t,e,n??"")):ue(this.node(),t)}function ue(t,e){return t.style.getPropertyValue(e)||Ai(t).getComputedStyle(t,null).getPropertyValue(e)}function fo(t){return function(){delete this[t]}}function ho(t,e){return function(){this[t]=e}}function po(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function go(t,e){return arguments.length>1?this.each((e==null?fo:typeof e=="function"?po:ho)(t,e)):this.node()[t]}function Si(t){return t.trim().split(/^|\s+/)}function Zn(t){return t.classList||new Ti(t)}function Ti(t){this._node=t,this._names=Si(t.getAttribute("class")||"")}Ti.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function Ei(t,e){for(var n=Zn(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function $i(t,e){for(var n=Zn(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function vo(t){return function(){Ei(this,t)}}function mo(t){return function(){$i(this,t)}}function yo(t,e){return function(){(e.apply(this,arguments)?Ei:$i)(this,t)}}function xo(t,e){var n=Si(t+"");if(arguments.length<2){for(var r=Zn(this.node()),i=-1,a=n.length;++i<a;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof e=="function"?yo:e?vo:mo)(n,e))}function _o(){this.textContent=""}function wo(t){return function(){this.textContent=t}}function bo(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function ko(t){return arguments.length?this.each(t==null?_o:(typeof t=="function"?bo:wo)(t)):this.node().textContent}function No(){this.innerHTML=""}function Mo(t){return function(){this.innerHTML=t}}function Ao(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function So(t){return arguments.length?this.each(t==null?No:(typeof t=="function"?Ao:Mo)(t)):this.node().innerHTML}function To(){this.nextSibling&&this.parentNode.appendChild(this)}function Eo(){return this.each(To)}function $o(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function zo(){return this.each($o)}function Io(t){var e=typeof t=="function"?t:wi(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function Co(){return null}function Ro(t,e){var n=typeof t=="function"?t:wi(t),r=e==null?Co:typeof e=="function"?e:Qn(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function Do(){var t=this.parentNode;t&&t.removeChild(this)}function Fo(){return this.each(Do)}function Ho(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Po(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Lo(t){return this.select(t?Po:Ho)}function Xo(t){return arguments.length?this.property("__data__",t):this.node().__data__}function Oo(t){return function(e){t.call(this,e,this.__data__)}}function Bo(t){return t.trim().split(/^|\s+/).map(function(e){var n="",r=e.indexOf(".");return r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),{type:e,name:n}})}function Vo(t){return function(){var e=this.__on;if(e){for(var n=0,r=-1,i=e.length,a;n<i;++n)a=e[n],(!t.type||a.type===t.type)&&a.name===t.name?this.removeEventListener(a.type,a.listener,a.options):e[++r]=a;++r?e.length=r:delete this.__on}}}function Yo(t,e,n){return function(){var r=this.__on,i,a=Oo(e);if(r){for(var s=0,l=r.length;s<l;++s)if((i=r[s]).type===t.type&&i.name===t.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=a,i.options=n),i.value=e;return}}this.addEventListener(t.type,a,n),i={type:t.type,name:t.name,value:e,listener:a,options:n},r?r.push(i):this.__on=[i]}}function qo(t,e,n){var r=Bo(t+""),i,a=r.length,s;if(arguments.length<2){var l=this.node().__on;if(l){for(var f=0,o=l.length,c;f<o;++f)for(i=0,c=l[f];i<a;++i)if((s=r[i]).type===c.type&&s.name===c.name)return c.value}return}for(l=e?Yo:Vo,i=0;i<a;++i)this.each(l(r[i],e,n));return this}function zi(t,e,n){var r=Ai(t),i=r.CustomEvent;typeof i=="function"?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function Wo(t,e){return function(){return zi(this,t,e)}}function Go(t,e){return function(){return zi(this,t,e.apply(this,arguments))}}function Uo(t,e){return this.each((typeof e=="function"?Go:Wo)(t,e))}function*Ko(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,a=r.length,s;i<a;++i)(s=r[i])&&(yield s)}var Ii=[null];function xt(t,e){this._groups=t,this._parents=e}function Ee(){return new xt([[document.documentElement]],Ii)}function Qo(){return this}xt.prototype=Ee.prototype={constructor:xt,select:ws,selectAll:Ms,selectChild:Es,selectChildren:Cs,filter:Rs,data:Xs,enter:Ds,exit:Bs,join:Vs,merge:Ys,selection:Qo,order:qs,sort:Ws,call:Us,nodes:Ks,node:Qs,size:Zs,empty:Js,each:js,attr:so,style:co,property:go,classed:xo,text:ko,html:So,raise:Eo,lower:zo,append:Io,insert:Ro,remove:Fo,clone:Lo,datum:Xo,on:qo,dispatch:Uo,[Symbol.iterator]:Ko};function Mt(t){return typeof t=="string"?new xt([[document.querySelector(t)]],[document.documentElement]):new xt([[t]],Ii)}function Zo(t){let e;for(;e=t.sourceEvent;)t=e;return t}function Ht(t,e){if(t=Zo(t),e===void 0&&(e=t.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=t.clientX,r.y=t.clientY,r=r.matrixTransform(e.getScreenCTM().inverse()),[r.x,r.y]}if(e.getBoundingClientRect){var i=e.getBoundingClientRect();return[t.clientX-i.left-e.clientLeft,t.clientY-i.top-e.clientTop]}}return[t.pageX,t.pageY]}const Jo={passive:!1},be={capture:!0,passive:!1};function Rn(t){t.stopImmediatePropagation()}function oe(t){t.preventDefault(),t.stopImmediatePropagation()}function Ci(t){var e=t.document.documentElement,n=Mt(t).on("dragstart.drag",oe,be);"onselectstart"in e?n.on("selectstart.drag",oe,be):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function Ri(t,e){var n=t.document.documentElement,r=Mt(t).on("dragstart.drag",null);e&&(r.on("click.drag",oe,be),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const Le=t=>()=>t;function Bn(t,{sourceEvent:e,subject:n,target:r,identifier:i,active:a,x:s,y:l,dx:f,dy:o,dispatch:c}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:i,enumerable:!0,configurable:!0},active:{value:a,enumerable:!0,configurable:!0},x:{value:s,enumerable:!0,configurable:!0},y:{value:l,enumerable:!0,configurable:!0},dx:{value:f,enumerable:!0,configurable:!0},dy:{value:o,enumerable:!0,configurable:!0},_:{value:c}})}Bn.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};function jo(t){return!t.ctrlKey&&!t.button}function tl(){return this.parentNode}function el(t,e){return e??{x:t.x,y:t.y}}function nl(){return navigator.maxTouchPoints||"ontouchstart"in this}function rl(){var t=jo,e=tl,n=el,r=nl,i={},a=Te("start","drag","end"),s=0,l,f,o,c,x=0;function h(m){m.on("mousedown.drag",v).filter(r).on("touchstart.drag",p).on("touchmove.drag",g,Jo).on("touchend.drag touchcancel.drag",b).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function v(m,_){if(!(c||!t.call(this,m,_))){var k=E(this,e.call(this,m,_),m,_,"mouse");k&&(Mt(m.view).on("mousemove.drag",w,be).on("mouseup.drag",d,be),Ci(m.view),Rn(m),o=!1,l=m.clientX,f=m.clientY,k("start",m))}}function w(m){if(oe(m),!o){var _=m.clientX-l,k=m.clientY-f;o=_*_+k*k>x}i.mouse("drag",m)}function d(m){Mt(m.view).on("mousemove.drag mouseup.drag",null),Ri(m.view,o),oe(m),i.mouse("end",m)}function p(m,_){if(t.call(this,m,_)){var k=m.changedTouches,A=e.call(this,m,_),C=k.length,q,V;for(q=0;q<C;++q)(V=E(this,A,m,_,k[q].identifier,k[q]))&&(Rn(m),V("start",m,k[q]))}}function g(m){var _=m.changedTouches,k=_.length,A,C;for(A=0;A<k;++A)(C=i[_[A].identifier])&&(oe(m),C("drag",m,_[A]))}function b(m){var _=m.changedTouches,k=_.length,A,C;for(c&&clearTimeout(c),c=setTimeout(function(){c=null},500),A=0;A<k;++A)(C=i[_[A].identifier])&&(Rn(m),C("end",m,_[A]))}function E(m,_,k,A,C,q){var V=a.copy(),G=Ht(q||k,_),K,et,y;if((y=n.call(m,new Bn("beforestart",{sourceEvent:k,target:h,identifier:C,active:s,x:G[0],y:G[1],dx:0,dy:0,dispatch:V}),A))!=null)return K=y.x-G[0]||0,et=y.y-G[1]||0,function $(N,R,L){var X=G,O;switch(N){case"start":i[C]=$,O=s++;break;case"end":delete i[C],--s;case"drag":G=Ht(L||R,_),O=s;break}V.call(N,m,new Bn(N,{sourceEvent:R,subject:y,target:h,identifier:C,active:O,x:G[0]+K,y:G[1]+et,dx:G[0]-X[0],dy:G[1]-X[1],dispatch:V}),A)}}return h.filter=function(m){return arguments.length?(t=typeof m=="function"?m:Le(!!m),h):t},h.container=function(m){return arguments.length?(e=typeof m=="function"?m:Le(m),h):e},h.subject=function(m){return arguments.length?(n=typeof m=="function"?m:Le(m),h):n},h.touchable=function(m){return arguments.length?(r=typeof m=="function"?m:Le(!!m),h):r},h.on=function(){var m=a.on.apply(a,arguments);return m===a?h:m},h.clickDistance=function(m){return arguments.length?(x=(m=+m)*m,h):Math.sqrt(x)},h}function Jn(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function Di(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function $e(){}var ke=.7,Ke=1/ke,le="\\s*([+-]?\\d+)\\s*",Ne="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",zt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",il=/^#([0-9a-f]{3,8})$/,al=new RegExp(`^rgb\\(${le},${le},${le}\\)$`),sl=new RegExp(`^rgb\\(${zt},${zt},${zt}\\)$`),ol=new RegExp(`^rgba\\(${le},${le},${le},${Ne}\\)$`),ll=new RegExp(`^rgba\\(${zt},${zt},${zt},${Ne}\\)$`),ul=new RegExp(`^hsl\\(${Ne},${zt},${zt}\\)$`),cl=new RegExp(`^hsla\\(${Ne},${zt},${zt},${Ne}\\)$`),Or={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Jn($e,Me,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:Br,formatHex:Br,formatHex8:fl,formatHsl:hl,formatRgb:Vr,toString:Vr});function Br(){return this.rgb().formatHex()}function fl(){return this.rgb().formatHex8()}function hl(){return Fi(this).formatHsl()}function Vr(){return this.rgb().formatRgb()}function Me(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=il.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?Yr(e):n===3?new vt(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?Xe(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?Xe(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=al.exec(t))?new vt(e[1],e[2],e[3],1):(e=sl.exec(t))?new vt(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=ol.exec(t))?Xe(e[1],e[2],e[3],e[4]):(e=ll.exec(t))?Xe(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=ul.exec(t))?Gr(e[1],e[2]/100,e[3]/100,1):(e=cl.exec(t))?Gr(e[1],e[2]/100,e[3]/100,e[4]):Or.hasOwnProperty(t)?Yr(Or[t]):t==="transparent"?new vt(NaN,NaN,NaN,0):null}function Yr(t){return new vt(t>>16&255,t>>8&255,t&255,1)}function Xe(t,e,n,r){return r<=0&&(t=e=n=NaN),new vt(t,e,n,r)}function dl(t){return t instanceof $e||(t=Me(t)),t?(t=t.rgb(),new vt(t.r,t.g,t.b,t.opacity)):new vt}function Vn(t,e,n,r){return arguments.length===1?dl(t):new vt(t,e,n,r??1)}function vt(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}Jn(vt,Vn,Di($e,{brighter(t){return t=t==null?Ke:Math.pow(Ke,t),new vt(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?ke:Math.pow(ke,t),new vt(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new vt(Qt(this.r),Qt(this.g),Qt(this.b),Qe(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:qr,formatHex:qr,formatHex8:pl,formatRgb:Wr,toString:Wr}));function qr(){return`#${Kt(this.r)}${Kt(this.g)}${Kt(this.b)}`}function pl(){return`#${Kt(this.r)}${Kt(this.g)}${Kt(this.b)}${Kt((isNaN(this.opacity)?1:this.opacity)*255)}`}function Wr(){const t=Qe(this.opacity);return`${t===1?"rgb(":"rgba("}${Qt(this.r)}, ${Qt(this.g)}, ${Qt(this.b)}${t===1?")":`, ${t})`}`}function Qe(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Qt(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Kt(t){return t=Qt(t),(t<16?"0":"")+t.toString(16)}function Gr(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new At(t,e,n,r)}function Fi(t){if(t instanceof At)return new At(t.h,t.s,t.l,t.opacity);if(t instanceof $e||(t=Me(t)),!t)return new At;if(t instanceof At)return t;t=t.rgb();var e=t.r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),a=Math.max(e,n,r),s=NaN,l=a-i,f=(a+i)/2;return l?(e===a?s=(n-r)/l+(n<r)*6:n===a?s=(r-e)/l+2:s=(e-n)/l+4,l/=f<.5?a+i:2-a-i,s*=60):l=f>0&&f<1?0:s,new At(s,l,f,t.opacity)}function gl(t,e,n,r){return arguments.length===1?Fi(t):new At(t,e,n,r??1)}function At(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}Jn(At,gl,Di($e,{brighter(t){return t=t==null?Ke:Math.pow(Ke,t),new At(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?ke:Math.pow(ke,t),new At(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new vt(Dn(t>=240?t-240:t+120,i,r),Dn(t,i,r),Dn(t<120?t+240:t-120,i,r),this.opacity)},clamp(){return new At(Ur(this.h),Oe(this.s),Oe(this.l),Qe(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Qe(this.opacity);return`${t===1?"hsl(":"hsla("}${Ur(this.h)}, ${Oe(this.s)*100}%, ${Oe(this.l)*100}%${t===1?")":`, ${t})`}`}}));function Ur(t){return t=(t||0)%360,t<0?t+360:t}function Oe(t){return Math.max(0,Math.min(1,t||0))}function Dn(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}const Hi=t=>()=>t;function vl(t,e){return function(n){return t+n*e}}function ml(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}function yl(t){return(t=+t)==1?Pi:function(e,n){return n-e?ml(e,n,t):Hi(isNaN(e)?n:e)}}function Pi(t,e){var n=e-t;return n?vl(t,n):Hi(isNaN(t)?e:t)}const Kr=(function t(e){var n=yl(e);function r(i,a){var s=n((i=Vn(i)).r,(a=Vn(a)).r),l=n(i.g,a.g),f=n(i.b,a.b),o=Pi(i.opacity,a.opacity);return function(c){return i.r=s(c),i.g=l(c),i.b=f(c),i.opacity=o(c),i+""}}return r.gamma=t,r})(1);function Bt(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}var Yn=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Fn=new RegExp(Yn.source,"g");function xl(t){return function(){return t}}function _l(t){return function(e){return t(e)+""}}function wl(t,e){var n=Yn.lastIndex=Fn.lastIndex=0,r,i,a,s=-1,l=[],f=[];for(t=t+"",e=e+"";(r=Yn.exec(t))&&(i=Fn.exec(e));)(a=i.index)>n&&(a=e.slice(n,a),l[s]?l[s]+=a:l[++s]=a),(r=r[0])===(i=i[0])?l[s]?l[s]+=i:l[++s]=i:(l[++s]=null,f.push({i:s,x:Bt(r,i)})),n=Fn.lastIndex;return n<e.length&&(a=e.slice(n),l[s]?l[s]+=a:l[++s]=a),l.length<2?f[0]?_l(f[0].x):xl(e):(e=f.length,function(o){for(var c=0,x;c<e;++c)l[(x=f[c]).i]=x.x(o);return l.join("")})}var Qr=180/Math.PI,qn={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Li(t,e,n,r,i,a){var s,l,f;return(s=Math.sqrt(t*t+e*e))&&(t/=s,e/=s),(f=t*n+e*r)&&(n-=t*f,r-=e*f),(l=Math.sqrt(n*n+r*r))&&(n/=l,r/=l,f/=l),t*r<e*n&&(t=-t,e=-e,f=-f,s=-s),{translateX:i,translateY:a,rotate:Math.atan2(e,t)*Qr,skewX:Math.atan(f)*Qr,scaleX:s,scaleY:l}}var Be;function bl(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?qn:Li(e.a,e.b,e.c,e.d,e.e,e.f)}function kl(t){return t==null||(Be||(Be=document.createElementNS("http://www.w3.org/2000/svg","g")),Be.setAttribute("transform",t),!(t=Be.transform.baseVal.consolidate()))?qn:(t=t.matrix,Li(t.a,t.b,t.c,t.d,t.e,t.f))}function Xi(t,e,n,r){function i(o){return o.length?o.pop()+" ":""}function a(o,c,x,h,v,w){if(o!==x||c!==h){var d=v.push("translate(",null,e,null,n);w.push({i:d-4,x:Bt(o,x)},{i:d-2,x:Bt(c,h)})}else(x||h)&&v.push("translate("+x+e+h+n)}function s(o,c,x,h){o!==c?(o-c>180?c+=360:c-o>180&&(o+=360),h.push({i:x.push(i(x)+"rotate(",null,r)-2,x:Bt(o,c)})):c&&x.push(i(x)+"rotate("+c+r)}function l(o,c,x,h){o!==c?h.push({i:x.push(i(x)+"skewX(",null,r)-2,x:Bt(o,c)}):c&&x.push(i(x)+"skewX("+c+r)}function f(o,c,x,h,v,w){if(o!==x||c!==h){var d=v.push(i(v)+"scale(",null,",",null,")");w.push({i:d-4,x:Bt(o,x)},{i:d-2,x:Bt(c,h)})}else(x!==1||h!==1)&&v.push(i(v)+"scale("+x+","+h+")")}return function(o,c){var x=[],h=[];return o=t(o),c=t(c),a(o.translateX,o.translateY,c.translateX,c.translateY,x,h),s(o.rotate,c.rotate,x,h),l(o.skewX,c.skewX,x,h),f(o.scaleX,o.scaleY,c.scaleX,c.scaleY,x,h),o=c=null,function(v){for(var w=-1,d=h.length,p;++w<d;)x[(p=h[w]).i]=p.x(v);return x.join("")}}}var Nl=Xi(bl,"px, ","px)","deg)"),Ml=Xi(kl,", ",")",")"),Al=1e-12;function Zr(t){return((t=Math.exp(t))+1/t)/2}function Sl(t){return((t=Math.exp(t))-1/t)/2}function Tl(t){return((t=Math.exp(2*t))-1)/(t+1)}const El=(function t(e,n,r){function i(a,s){var l=a[0],f=a[1],o=a[2],c=s[0],x=s[1],h=s[2],v=c-l,w=x-f,d=v*v+w*w,p,g;if(d<Al)g=Math.log(h/o)/e,p=function(A){return[l+A*v,f+A*w,o*Math.exp(e*A*g)]};else{var b=Math.sqrt(d),E=(h*h-o*o+r*d)/(2*o*n*b),m=(h*h-o*o-r*d)/(2*h*n*b),_=Math.log(Math.sqrt(E*E+1)-E),k=Math.log(Math.sqrt(m*m+1)-m);g=(k-_)/e,p=function(A){var C=A*g,q=Zr(_),V=o/(n*b)*(q*Tl(e*C+_)-Sl(_));return[l+V*v,f+V*w,o*q/Zr(e*C+_)]}}return p.duration=g*1e3*e/Math.SQRT2,p}return i.rho=function(a){var s=Math.max(.001,+a),l=s*s,f=l*l;return t(s,l,f)},i})(Math.SQRT2,2,4);var ce=0,_e=0,ye=0,Oi=1e3,Ze,we,Je=0,Jt=0,rn=0,Ae=typeof performance=="object"&&performance.now?performance:Date,Bi=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function jn(){return Jt||(Bi($l),Jt=Ae.now()+rn)}function $l(){Jt=0}function je(){this._call=this._time=this._next=null}je.prototype=tr.prototype={constructor:je,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?jn():+n)+(e==null?0:+e),!this._next&&we!==this&&(we?we._next=this:Ze=this,we=this),this._call=t,this._time=n,Wn()},stop:function(){this._call&&(this._call=null,this._time=1/0,Wn())}};function tr(t,e,n){var r=new je;return r.restart(t,e,n),r}function zl(){jn(),++ce;for(var t=Ze,e;t;)(e=Jt-t._time)>=0&&t._call.call(void 0,e),t=t._next;--ce}function Jr(){Jt=(Je=Ae.now())+rn,ce=_e=0;try{zl()}finally{ce=0,Cl(),Jt=0}}function Il(){var t=Ae.now(),e=t-Je;e>Oi&&(rn-=e,Je=t)}function Cl(){for(var t,e=Ze,n,r=1/0;e;)e._call?(r>e._time&&(r=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:Ze=n);we=t,Wn(r)}function Wn(t){if(!ce){_e&&(_e=clearTimeout(_e));var e=t-Jt;e>24?(t<1/0&&(_e=setTimeout(Jr,t-Ae.now()-rn)),ye&&(ye=clearInterval(ye))):(ye||(Je=Ae.now(),ye=setInterval(Il,Oi)),ce=1,Bi(Jr))}}function jr(t,e,n){var r=new je;return e=e==null?0:+e,r.restart(i=>{r.stop(),t(i+e)},e,n),r}var Rl=Te("start","end","cancel","interrupt"),Dl=[],Vi=0,ti=1,Gn=2,qe=3,ei=4,Un=5,We=6;function an(t,e,n,r,i,a){var s=t.__transition;if(!s)t.__transition={};else if(n in s)return;Fl(t,n,{name:e,index:r,group:i,on:Rl,tween:Dl,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:Vi})}function er(t,e){var n=St(t,e);if(n.state>Vi)throw new Error("too late; already scheduled");return n}function It(t,e){var n=St(t,e);if(n.state>qe)throw new Error("too late; already running");return n}function St(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function Fl(t,e,n){var r=t.__transition,i;r[e]=n,n.timer=tr(a,0,n.time);function a(o){n.state=ti,n.timer.restart(s,n.delay,n.time),n.delay<=o&&s(o-n.delay)}function s(o){var c,x,h,v;if(n.state!==ti)return f();for(c in r)if(v=r[c],v.name===n.name){if(v.state===qe)return jr(s);v.state===ei?(v.state=We,v.timer.stop(),v.on.call("interrupt",t,t.__data__,v.index,v.group),delete r[c]):+c<e&&(v.state=We,v.timer.stop(),v.on.call("cancel",t,t.__data__,v.index,v.group),delete r[c])}if(jr(function(){n.state===qe&&(n.state=ei,n.timer.restart(l,n.delay,n.time),l(o))}),n.state=Gn,n.on.call("start",t,t.__data__,n.index,n.group),n.state===Gn){for(n.state=qe,i=new Array(h=n.tween.length),c=0,x=-1;c<h;++c)(v=n.tween[c].value.call(t,t.__data__,n.index,n.group))&&(i[++x]=v);i.length=x+1}}function l(o){for(var c=o<n.duration?n.ease.call(null,o/n.duration):(n.timer.restart(f),n.state=Un,1),x=-1,h=i.length;++x<h;)i[x].call(t,c);n.state===Un&&(n.on.call("end",t,t.__data__,n.index,n.group),f())}function f(){n.state=We,n.timer.stop(),delete r[e];for(var o in r)return;delete t.__transition}}function Ge(t,e){var n=t.__transition,r,i,a=!0,s;if(n){e=e==null?null:e+"";for(s in n){if((r=n[s]).name!==e){a=!1;continue}i=r.state>Gn&&r.state<Un,r.state=We,r.timer.stop(),r.on.call(i?"interrupt":"cancel",t,t.__data__,r.index,r.group),delete n[s]}a&&delete t.__transition}}function Hl(t){return this.each(function(){Ge(this,t)})}function Pl(t,e){var n,r;return function(){var i=It(this,t),a=i.tween;if(a!==n){r=n=a;for(var s=0,l=r.length;s<l;++s)if(r[s].name===e){r=r.slice(),r.splice(s,1);break}}i.tween=r}}function Ll(t,e,n){var r,i;if(typeof n!="function")throw new Error;return function(){var a=It(this,t),s=a.tween;if(s!==r){i=(r=s).slice();for(var l={name:e,value:n},f=0,o=i.length;f<o;++f)if(i[f].name===e){i[f]=l;break}f===o&&i.push(l)}a.tween=i}}function Xl(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r=St(this.node(),n).tween,i=0,a=r.length,s;i<a;++i)if((s=r[i]).name===t)return s.value;return null}return this.each((e==null?Pl:Ll)(n,t,e))}function nr(t,e,n){var r=t._id;return t.each(function(){var i=It(this,r);(i.value||(i.value={}))[e]=n.apply(this,arguments)}),function(i){return St(i,r).value[e]}}function Yi(t,e){var n;return(typeof e=="number"?Bt:e instanceof Me?Kr:(n=Me(e))?(e=n,Kr):wl)(t,e)}function Ol(t){return function(){this.removeAttribute(t)}}function Bl(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Vl(t,e,n){var r,i=n+"",a;return function(){var s=this.getAttribute(t);return s===i?null:s===r?a:a=e(r=s,n)}}function Yl(t,e,n){var r,i=n+"",a;return function(){var s=this.getAttributeNS(t.space,t.local);return s===i?null:s===r?a:a=e(r=s,n)}}function ql(t,e,n){var r,i,a;return function(){var s,l=n(this),f;return l==null?void this.removeAttribute(t):(s=this.getAttribute(t),f=l+"",s===f?null:s===r&&f===i?a:(i=f,a=e(r=s,l)))}}function Wl(t,e,n){var r,i,a;return function(){var s,l=n(this),f;return l==null?void this.removeAttributeNS(t.space,t.local):(s=this.getAttributeNS(t.space,t.local),f=l+"",s===f?null:s===r&&f===i?a:(i=f,a=e(r=s,l)))}}function Gl(t,e){var n=nn(t),r=n==="transform"?Ml:Yi;return this.attrTween(t,typeof e=="function"?(n.local?Wl:ql)(n,r,nr(this,"attr."+t,e)):e==null?(n.local?Bl:Ol)(n):(n.local?Yl:Vl)(n,r,e))}function Ul(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function Kl(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function Ql(t,e){var n,r;function i(){var a=e.apply(this,arguments);return a!==r&&(n=(r=a)&&Kl(t,a)),n}return i._value=e,i}function Zl(t,e){var n,r;function i(){var a=e.apply(this,arguments);return a!==r&&(n=(r=a)&&Ul(t,a)),n}return i._value=e,i}function Jl(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var r=nn(t);return this.tween(n,(r.local?Ql:Zl)(r,e))}function jl(t,e){return function(){er(this,t).delay=+e.apply(this,arguments)}}function tu(t,e){return e=+e,function(){er(this,t).delay=e}}function eu(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?jl:tu)(e,t)):St(this.node(),e).delay}function nu(t,e){return function(){It(this,t).duration=+e.apply(this,arguments)}}function ru(t,e){return e=+e,function(){It(this,t).duration=e}}function iu(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?nu:ru)(e,t)):St(this.node(),e).duration}function au(t,e){if(typeof e!="function")throw new Error;return function(){It(this,t).ease=e}}function su(t){var e=this._id;return arguments.length?this.each(au(e,t)):St(this.node(),e).ease}function ou(t,e){return function(){var n=e.apply(this,arguments);if(typeof n!="function")throw new Error;It(this,t).ease=n}}function lu(t){if(typeof t!="function")throw new Error;return this.each(ou(this._id,t))}function uu(t){typeof t!="function"&&(t=ki(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var a=e[i],s=a.length,l=r[i]=[],f,o=0;o<s;++o)(f=a[o])&&t.call(f,f.__data__,o,a)&&l.push(f);return new Lt(r,this._parents,this._name,this._id)}function cu(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,i=n.length,a=Math.min(r,i),s=new Array(r),l=0;l<a;++l)for(var f=e[l],o=n[l],c=f.length,x=s[l]=new Array(c),h,v=0;v<c;++v)(h=f[v]||o[v])&&(x[v]=h);for(;l<r;++l)s[l]=e[l];return new Lt(s,this._parents,this._name,this._id)}function fu(t){return(t+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function hu(t,e,n){var r,i,a=fu(e)?er:It;return function(){var s=a(this,t),l=s.on;l!==r&&(i=(r=l).copy()).on(e,n),s.on=i}}function du(t,e){var n=this._id;return arguments.length<2?St(this.node(),n).on.on(t):this.each(hu(n,t,e))}function pu(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function gu(){return this.on("end.remove",pu(this._id))}function vu(t){var e=this._name,n=this._id;typeof t!="function"&&(t=Qn(t));for(var r=this._groups,i=r.length,a=new Array(i),s=0;s<i;++s)for(var l=r[s],f=l.length,o=a[s]=new Array(f),c,x,h=0;h<f;++h)(c=l[h])&&(x=t.call(c,c.__data__,h,l))&&("__data__"in c&&(x.__data__=c.__data__),o[h]=x,an(o[h],e,n,h,o,St(c,n)));return new Lt(a,this._parents,e,n)}function mu(t){var e=this._name,n=this._id;typeof t!="function"&&(t=bi(t));for(var r=this._groups,i=r.length,a=[],s=[],l=0;l<i;++l)for(var f=r[l],o=f.length,c,x=0;x<o;++x)if(c=f[x]){for(var h=t.call(c,c.__data__,x,f),v,w=St(c,n),d=0,p=h.length;d<p;++d)(v=h[d])&&an(v,e,n,d,h,w);a.push(h),s.push(c)}return new Lt(a,s,e,n)}var yu=Ee.prototype.constructor;function xu(){return new yu(this._groups,this._parents)}function _u(t,e){var n,r,i;return function(){var a=ue(this,t),s=(this.style.removeProperty(t),ue(this,t));return a===s?null:a===n&&s===r?i:i=e(n=a,r=s)}}function qi(t){return function(){this.style.removeProperty(t)}}function wu(t,e,n){var r,i=n+"",a;return function(){var s=ue(this,t);return s===i?null:s===r?a:a=e(r=s,n)}}function bu(t,e,n){var r,i,a;return function(){var s=ue(this,t),l=n(this),f=l+"";return l==null&&(f=l=(this.style.removeProperty(t),ue(this,t))),s===f?null:s===r&&f===i?a:(i=f,a=e(r=s,l))}}function ku(t,e){var n,r,i,a="style."+e,s="end."+a,l;return function(){var f=It(this,t),o=f.on,c=f.value[a]==null?l||(l=qi(e)):void 0;(o!==n||i!==c)&&(r=(n=o).copy()).on(s,i=c),f.on=r}}function Nu(t,e,n){var r=(t+="")=="transform"?Nl:Yi;return e==null?this.styleTween(t,_u(t,r)).on("end.style."+t,qi(t)):typeof e=="function"?this.styleTween(t,bu(t,r,nr(this,"style."+t,e))).each(ku(this._id,t)):this.styleTween(t,wu(t,r,e),n).on("end.style."+t,null)}function Mu(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}function Au(t,e,n){var r,i;function a(){var s=e.apply(this,arguments);return s!==i&&(r=(i=s)&&Mu(t,s,n)),r}return a._value=e,a}function Su(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(e==null)return this.tween(r,null);if(typeof e!="function")throw new Error;return this.tween(r,Au(t,e,n??""))}function Tu(t){return function(){this.textContent=t}}function Eu(t){return function(){var e=t(this);this.textContent=e??""}}function $u(t){return this.tween("text",typeof t=="function"?Eu(nr(this,"text",t)):Tu(t==null?"":t+""))}function zu(t){return function(e){this.textContent=t.call(this,e)}}function Iu(t){var e,n;function r(){var i=t.apply(this,arguments);return i!==n&&(e=(n=i)&&zu(i)),e}return r._value=t,r}function Cu(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,Iu(t))}function Ru(){for(var t=this._name,e=this._id,n=Wi(),r=this._groups,i=r.length,a=0;a<i;++a)for(var s=r[a],l=s.length,f,o=0;o<l;++o)if(f=s[o]){var c=St(f,e);an(f,t,n,o,s,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new Lt(r,this._parents,t,n)}function Du(){var t,e,n=this,r=n._id,i=n.size();return new Promise(function(a,s){var l={value:s},f={value:function(){--i===0&&a()}};n.each(function(){var o=It(this,r),c=o.on;c!==t&&(e=(t=c).copy(),e._.cancel.push(l),e._.interrupt.push(l),e._.end.push(f)),o.on=e}),i===0&&a()})}var Fu=0;function Lt(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function Wi(){return++Fu}var Ft=Ee.prototype;Lt.prototype={constructor:Lt,select:vu,selectAll:mu,selectChild:Ft.selectChild,selectChildren:Ft.selectChildren,filter:uu,merge:cu,selection:xu,transition:Ru,call:Ft.call,nodes:Ft.nodes,node:Ft.node,size:Ft.size,empty:Ft.empty,each:Ft.each,on:du,attr:Gl,attrTween:Jl,style:Nu,styleTween:Su,text:$u,textTween:Cu,remove:gu,tween:Xl,delay:eu,duration:iu,ease:su,easeVarying:lu,end:Du,[Symbol.iterator]:Ft[Symbol.iterator]};function Hu(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var Pu={time:null,delay:0,duration:250,ease:Hu};function Lu(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}function Xu(t){var e,n;t instanceof Lt?(e=t._id,t=t._name):(e=Wi(),(n=Pu).time=jn(),t=t==null?null:t+"");for(var r=this._groups,i=r.length,a=0;a<i;++a)for(var s=r[a],l=s.length,f,o=0;o<l;++o)(f=s[o])&&an(f,t,e,o,s,n||Lu(f,e));return new Lt(r,this._parents,t,e)}Ee.prototype.interrupt=Hl;Ee.prototype.transition=Xu;function ni(t,e){var n,r=1;t==null&&(t=0),e==null&&(e=0);function i(){var a,s=n.length,l,f=0,o=0;for(a=0;a<s;++a)l=n[a],f+=l.x,o+=l.y;for(f=(f/s-t)*r,o=(o/s-e)*r,a=0;a<s;++a)l=n[a],l.x-=f,l.y-=o}return i.initialize=function(a){n=a},i.x=function(a){return arguments.length?(t=+a,i):t},i.y=function(a){return arguments.length?(e=+a,i):e},i.strength=function(a){return arguments.length?(r=+a,i):r},i}function Ou(t){const e=+this._x.call(null,t),n=+this._y.call(null,t);return Gi(this.cover(e,n),e,n,t)}function Gi(t,e,n,r){if(isNaN(e)||isNaN(n))return t;var i,a=t._root,s={data:r},l=t._x0,f=t._y0,o=t._x1,c=t._y1,x,h,v,w,d,p,g,b;if(!a)return t._root=s,t;for(;a.length;)if((d=e>=(x=(l+o)/2))?l=x:o=x,(p=n>=(h=(f+c)/2))?f=h:c=h,i=a,!(a=a[g=p<<1|d]))return i[g]=s,t;if(v=+t._x.call(null,a.data),w=+t._y.call(null,a.data),e===v&&n===w)return s.next=a,i?i[g]=s:t._root=s,t;do i=i?i[g]=new Array(4):t._root=new Array(4),(d=e>=(x=(l+o)/2))?l=x:o=x,(p=n>=(h=(f+c)/2))?f=h:c=h;while((g=p<<1|d)===(b=(w>=h)<<1|v>=x));return i[b]=a,i[g]=s,t}function Bu(t){var e,n,r=t.length,i,a,s=new Array(r),l=new Array(r),f=1/0,o=1/0,c=-1/0,x=-1/0;for(n=0;n<r;++n)isNaN(i=+this._x.call(null,e=t[n]))||isNaN(a=+this._y.call(null,e))||(s[n]=i,l[n]=a,i<f&&(f=i),i>c&&(c=i),a<o&&(o=a),a>x&&(x=a));if(f>c||o>x)return this;for(this.cover(f,o).cover(c,x),n=0;n<r;++n)Gi(this,s[n],l[n],t[n]);return this}function Vu(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var n=this._x0,r=this._y0,i=this._x1,a=this._y1;if(isNaN(n))i=(n=Math.floor(t))+1,a=(r=Math.floor(e))+1;else{for(var s=i-n||1,l=this._root,f,o;n>t||t>=i||r>e||e>=a;)switch(o=(e<r)<<1|t<n,f=new Array(4),f[o]=l,l=f,s*=2,o){case 0:i=n+s,a=r+s;break;case 1:n=i-s,a=r+s;break;case 2:i=n+s,r=a-s;break;case 3:n=i-s,r=a-s;break}this._root&&this._root.length&&(this._root=l)}return this._x0=n,this._y0=r,this._x1=i,this._y1=a,this}function Yu(){var t=[];return this.visit(function(e){if(!e.length)do t.push(e.data);while(e=e.next)}),t}function qu(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function pt(t,e,n,r,i){this.node=t,this.x0=e,this.y0=n,this.x1=r,this.y1=i}function Wu(t,e,n){var r,i=this._x0,a=this._y0,s,l,f,o,c=this._x1,x=this._y1,h=[],v=this._root,w,d;for(v&&h.push(new pt(v,i,a,c,x)),n==null?n=1/0:(i=t-n,a=e-n,c=t+n,x=e+n,n*=n);w=h.pop();)if(!(!(v=w.node)||(s=w.x0)>c||(l=w.y0)>x||(f=w.x1)<i||(o=w.y1)<a))if(v.length){var p=(s+f)/2,g=(l+o)/2;h.push(new pt(v[3],p,g,f,o),new pt(v[2],s,g,p,o),new pt(v[1],p,l,f,g),new pt(v[0],s,l,p,g)),(d=(e>=g)<<1|t>=p)&&(w=h[h.length-1],h[h.length-1]=h[h.length-1-d],h[h.length-1-d]=w)}else{var b=t-+this._x.call(null,v.data),E=e-+this._y.call(null,v.data),m=b*b+E*E;if(m<n){var _=Math.sqrt(n=m);i=t-_,a=e-_,c=t+_,x=e+_,r=v.data}}return r}function Gu(t){if(isNaN(c=+this._x.call(null,t))||isNaN(x=+this._y.call(null,t)))return this;var e,n=this._root,r,i,a,s=this._x0,l=this._y0,f=this._x1,o=this._y1,c,x,h,v,w,d,p,g;if(!n)return this;if(n.length)for(;;){if((w=c>=(h=(s+f)/2))?s=h:f=h,(d=x>=(v=(l+o)/2))?l=v:o=v,e=n,!(n=n[p=d<<1|w]))return this;if(!n.length)break;(e[p+1&3]||e[p+2&3]||e[p+3&3])&&(r=e,g=p)}for(;n.data!==t;)if(i=n,!(n=n.next))return this;return(a=n.next)&&delete n.next,i?(a?i.next=a:delete i.next,this):e?(a?e[p]=a:delete e[p],(n=e[0]||e[1]||e[2]||e[3])&&n===(e[3]||e[2]||e[1]||e[0])&&!n.length&&(r?r[g]=n:this._root=n),this):(this._root=a,this)}function Uu(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this}function Ku(){return this._root}function Qu(){var t=0;return this.visit(function(e){if(!e.length)do++t;while(e=e.next)}),t}function Zu(t){var e=[],n,r=this._root,i,a,s,l,f;for(r&&e.push(new pt(r,this._x0,this._y0,this._x1,this._y1));n=e.pop();)if(!t(r=n.node,a=n.x0,s=n.y0,l=n.x1,f=n.y1)&&r.length){var o=(a+l)/2,c=(s+f)/2;(i=r[3])&&e.push(new pt(i,o,c,l,f)),(i=r[2])&&e.push(new pt(i,a,c,o,f)),(i=r[1])&&e.push(new pt(i,o,s,l,c)),(i=r[0])&&e.push(new pt(i,a,s,o,c))}return this}function Ju(t){var e=[],n=[],r;for(this._root&&e.push(new pt(this._root,this._x0,this._y0,this._x1,this._y1));r=e.pop();){var i=r.node;if(i.length){var a,s=r.x0,l=r.y0,f=r.x1,o=r.y1,c=(s+f)/2,x=(l+o)/2;(a=i[0])&&e.push(new pt(a,s,l,c,x)),(a=i[1])&&e.push(new pt(a,c,l,f,x)),(a=i[2])&&e.push(new pt(a,s,x,c,o)),(a=i[3])&&e.push(new pt(a,c,x,f,o))}n.push(r)}for(;r=n.pop();)t(r.node,r.x0,r.y0,r.x1,r.y1);return this}function ju(t){return t[0]}function tc(t){return arguments.length?(this._x=t,this):this._x}function ec(t){return t[1]}function nc(t){return arguments.length?(this._y=t,this):this._y}function rr(t,e,n){var r=new ir(e??ju,n??ec,NaN,NaN,NaN,NaN);return t==null?r:r.addAll(t)}function ir(t,e,n,r,i,a){this._x=t,this._y=e,this._x0=n,this._y0=r,this._x1=i,this._y1=a,this._root=void 0}function ri(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}var gt=rr.prototype=ir.prototype;gt.copy=function(){var t=new ir(this._x,this._y,this._x0,this._y0,this._x1,this._y1),e=this._root,n,r;if(!e)return t;if(!e.length)return t._root=ri(e),t;for(n=[{source:e,target:t._root=new Array(4)}];e=n.pop();)for(var i=0;i<4;++i)(r=e.source[i])&&(r.length?n.push({source:r,target:e.target[i]=new Array(4)}):e.target[i]=ri(r));return t};gt.add=Ou;gt.addAll=Bu;gt.cover=Vu;gt.data=Yu;gt.extent=qu;gt.find=Wu;gt.remove=Gu;gt.removeAll=Uu;gt.root=Ku;gt.size=Qu;gt.visit=Zu;gt.visitAfter=Ju;gt.x=tc;gt.y=nc;function Zt(t){return function(){return t}}function Vt(t){return(t()-.5)*1e-6}function rc(t){return t.x+t.vx}function ic(t){return t.y+t.vy}function ac(t){var e,n,r,i=1,a=1;typeof t!="function"&&(t=Zt(t==null?1:+t));function s(){for(var o,c=e.length,x,h,v,w,d,p,g=0;g<a;++g)for(x=rr(e,rc,ic).visitAfter(l),o=0;o<c;++o)h=e[o],d=n[h.index],p=d*d,v=h.x+h.vx,w=h.y+h.vy,x.visit(b);function b(E,m,_,k,A){var C=E.data,q=E.r,V=d+q;if(C){if(C.index>h.index){var G=v-C.x-C.vx,K=w-C.y-C.vy,et=G*G+K*K;et<V*V&&(G===0&&(G=Vt(r),et+=G*G),K===0&&(K=Vt(r),et+=K*K),et=(V-(et=Math.sqrt(et)))/et*i,h.vx+=(G*=et)*(V=(q*=q)/(p+q)),h.vy+=(K*=et)*V,C.vx-=G*(V=1-V),C.vy-=K*V)}return}return m>v+V||k<v-V||_>w+V||A<w-V}}function l(o){if(o.data)return o.r=n[o.data.index];for(var c=o.r=0;c<4;++c)o[c]&&o[c].r>o.r&&(o.r=o[c].r)}function f(){if(e){var o,c=e.length,x;for(n=new Array(c),o=0;o<c;++o)x=e[o],n[x.index]=+t(x,o,e)}}return s.initialize=function(o,c){e=o,r=c,f()},s.iterations=function(o){return arguments.length?(a=+o,s):a},s.strength=function(o){return arguments.length?(i=+o,s):i},s.radius=function(o){return arguments.length?(t=typeof o=="function"?o:Zt(+o),f(),s):t},s}function sc(t){return t.index}function ii(t,e){var n=t.get(e);if(!n)throw new Error("node not found: "+e);return n}function oc(t){var e=sc,n=x,r,i=Zt(30),a,s,l,f,o,c=1;t==null&&(t=[]);function x(p){return 1/Math.min(l[p.source.index],l[p.target.index])}function h(p){for(var g=0,b=t.length;g<c;++g)for(var E=0,m,_,k,A,C,q,V;E<b;++E)m=t[E],_=m.source,k=m.target,A=k.x+k.vx-_.x-_.vx||Vt(o),C=k.y+k.vy-_.y-_.vy||Vt(o),q=Math.sqrt(A*A+C*C),q=(q-a[E])/q*p*r[E],A*=q,C*=q,k.vx-=A*(V=f[E]),k.vy-=C*V,_.vx+=A*(V=1-V),_.vy+=C*V}function v(){if(s){var p,g=s.length,b=t.length,E=new Map(s.map((_,k)=>[e(_,k,s),_])),m;for(p=0,l=new Array(g);p<b;++p)m=t[p],m.index=p,typeof m.source!="object"&&(m.source=ii(E,m.source)),typeof m.target!="object"&&(m.target=ii(E,m.target)),l[m.source.index]=(l[m.source.index]||0)+1,l[m.target.index]=(l[m.target.index]||0)+1;for(p=0,f=new Array(b);p<b;++p)m=t[p],f[p]=l[m.source.index]/(l[m.source.index]+l[m.target.index]);r=new Array(b),w(),a=new Array(b),d()}}function w(){if(s)for(var p=0,g=t.length;p<g;++p)r[p]=+n(t[p],p,t)}function d(){if(s)for(var p=0,g=t.length;p<g;++p)a[p]=+i(t[p],p,t)}return h.initialize=function(p,g){s=p,o=g,v()},h.links=function(p){return arguments.length?(t=p,v(),h):t},h.id=function(p){return arguments.length?(e=p,h):e},h.iterations=function(p){return arguments.length?(c=+p,h):c},h.strength=function(p){return arguments.length?(n=typeof p=="function"?p:Zt(+p),w(),h):n},h.distance=function(p){return arguments.length?(i=typeof p=="function"?p:Zt(+p),d(),h):i},h}const lc=1664525,uc=1013904223,ai=4294967296;function cc(){let t=1;return()=>(t=(lc*t+uc)%ai)/ai}function fc(t){return t.x}function hc(t){return t.y}var dc=10,pc=Math.PI*(3-Math.sqrt(5));function gc(t){var e,n=1,r=.001,i=1-Math.pow(r,1/300),a=0,s=.6,l=new Map,f=tr(x),o=Te("tick","end"),c=cc();t==null&&(t=[]);function x(){h(),o.call("tick",e),n<r&&(f.stop(),o.call("end",e))}function h(d){var p,g=t.length,b;d===void 0&&(d=1);for(var E=0;E<d;++E)for(n+=(a-n)*i,l.forEach(function(m){m(n)}),p=0;p<g;++p)b=t[p],b.fx==null?b.x+=b.vx*=s:(b.x=b.fx,b.vx=0),b.fy==null?b.y+=b.vy*=s:(b.y=b.fy,b.vy=0);return e}function v(){for(var d=0,p=t.length,g;d<p;++d){if(g=t[d],g.index=d,g.fx!=null&&(g.x=g.fx),g.fy!=null&&(g.y=g.fy),isNaN(g.x)||isNaN(g.y)){var b=dc*Math.sqrt(.5+d),E=d*pc;g.x=b*Math.cos(E),g.y=b*Math.sin(E)}(isNaN(g.vx)||isNaN(g.vy))&&(g.vx=g.vy=0)}}function w(d){return d.initialize&&d.initialize(t,c),d}return v(),e={tick:h,restart:function(){return f.restart(x),e},stop:function(){return f.stop(),e},nodes:function(d){return arguments.length?(t=d,v(),l.forEach(w),e):t},alpha:function(d){return arguments.length?(n=+d,e):n},alphaMin:function(d){return arguments.length?(r=+d,e):r},alphaDecay:function(d){return arguments.length?(i=+d,e):+i},alphaTarget:function(d){return arguments.length?(a=+d,e):a},velocityDecay:function(d){return arguments.length?(s=1-d,e):1-s},randomSource:function(d){return arguments.length?(c=d,l.forEach(w),e):c},force:function(d,p){return arguments.length>1?(p==null?l.delete(d):l.set(d,w(p)),e):l.get(d)},find:function(d,p,g){var b=0,E=t.length,m,_,k,A,C;for(g==null?g=1/0:g*=g,b=0;b<E;++b)A=t[b],m=d-A.x,_=p-A.y,k=m*m+_*_,k<g&&(C=A,g=k);return C},on:function(d,p){return arguments.length>1?(o.on(d,p),e):o.on(d)}}}function vc(){var t,e,n,r,i=Zt(-30),a,s=1,l=1/0,f=.81;function o(v){var w,d=t.length,p=rr(t,fc,hc).visitAfter(x);for(r=v,w=0;w<d;++w)e=t[w],p.visit(h)}function c(){if(t){var v,w=t.length,d;for(a=new Array(w),v=0;v<w;++v)d=t[v],a[d.index]=+i(d,v,t)}}function x(v){var w=0,d,p,g=0,b,E,m;if(v.length){for(b=E=m=0;m<4;++m)(d=v[m])&&(p=Math.abs(d.value))&&(w+=d.value,g+=p,b+=p*d.x,E+=p*d.y);v.x=b/g,v.y=E/g}else{d=v,d.x=d.data.x,d.y=d.data.y;do w+=a[d.data.index];while(d=d.next)}v.value=w}function h(v,w,d,p){if(!v.value)return!0;var g=v.x-e.x,b=v.y-e.y,E=p-w,m=g*g+b*b;if(E*E/f<m)return m<l&&(g===0&&(g=Vt(n),m+=g*g),b===0&&(b=Vt(n),m+=b*b),m<s&&(m=Math.sqrt(s*m)),e.vx+=g*v.value*r/m,e.vy+=b*v.value*r/m),!0;if(v.length||m>=l)return;(v.data!==e||v.next)&&(g===0&&(g=Vt(n),m+=g*g),b===0&&(b=Vt(n),m+=b*b),m<s&&(m=Math.sqrt(s*m)));do v.data!==e&&(E=a[v.data.index]*r/m,e.vx+=g*E,e.vy+=b*E);while(v=v.next)}return o.initialize=function(v,w){t=v,n=w,c()},o.strength=function(v){return arguments.length?(i=typeof v=="function"?v:Zt(+v),c(),o):i},o.distanceMin=function(v){return arguments.length?(s=v*v,o):Math.sqrt(s)},o.distanceMax=function(v){return arguments.length?(l=v*v,o):Math.sqrt(l)},o.theta=function(v){return arguments.length?(f=v*v,o):Math.sqrt(f)},o}function mc(t){for(var e=t.length/6|0,n=new Array(e),r=0;r<e;)n[r]="#"+t.slice(r*6,++r*6);return n}const yc=mc("4e79a7f28e2ce1575976b7b259a14fedc949af7aa1ff9da79c755fbab0ab"),Ve=t=>()=>t;function xc(t,{sourceEvent:e,target:n,transform:r,dispatch:i}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:i}})}function Pt(t,e,n){this.k=t,this.x=e,this.y=n}Pt.prototype={constructor:Pt,scale:function(t){return t===1?this:new Pt(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new Pt(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var ar=new Pt(1,0,0);Pt.prototype;function Hn(t){t.stopImmediatePropagation()}function xe(t){t.preventDefault(),t.stopImmediatePropagation()}function _c(t){return(!t.ctrlKey||t.type==="wheel")&&!t.button}function wc(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t,t.hasAttribute("viewBox")?(t=t.viewBox.baseVal,[[t.x,t.y],[t.x+t.width,t.y+t.height]]):[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]):[[0,0],[t.clientWidth,t.clientHeight]]}function si(){return this.__zoom||ar}function bc(t){return-t.deltaY*(t.deltaMode===1?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function kc(){return navigator.maxTouchPoints||"ontouchstart"in this}function Nc(t,e,n){var r=t.invertX(e[0][0])-n[0][0],i=t.invertX(e[1][0])-n[1][0],a=t.invertY(e[0][1])-n[0][1],s=t.invertY(e[1][1])-n[1][1];return t.translate(i>r?(r+i)/2:Math.min(0,r)||Math.max(0,i),s>a?(a+s)/2:Math.min(0,a)||Math.max(0,s))}function Mc(){var t=_c,e=wc,n=Nc,r=bc,i=kc,a=[0,1/0],s=[[-1/0,-1/0],[1/0,1/0]],l=250,f=El,o=Te("start","zoom","end"),c,x,h,v=500,w=150,d=0,p=10;function g(y){y.property("__zoom",si).on("wheel.zoom",C,{passive:!1}).on("mousedown.zoom",q).on("dblclick.zoom",V).filter(i).on("touchstart.zoom",G).on("touchmove.zoom",K).on("touchend.zoom touchcancel.zoom",et).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}g.transform=function(y,$,N,R){var L=y.selection?y.selection():y;L.property("__zoom",si),y!==L?_(y,$,N,R):L.interrupt().each(function(){k(this,arguments).event(R).start().zoom(null,typeof $=="function"?$.apply(this,arguments):$).end()})},g.scaleBy=function(y,$,N,R){g.scaleTo(y,function(){var L=this.__zoom.k,X=typeof $=="function"?$.apply(this,arguments):$;return L*X},N,R)},g.scaleTo=function(y,$,N,R){g.transform(y,function(){var L=e.apply(this,arguments),X=this.__zoom,O=N==null?m(L):typeof N=="function"?N.apply(this,arguments):N,Q=X.invert(O),Z=typeof $=="function"?$.apply(this,arguments):$;return n(E(b(X,Z),O,Q),L,s)},N,R)},g.translateBy=function(y,$,N,R){g.transform(y,function(){return n(this.__zoom.translate(typeof $=="function"?$.apply(this,arguments):$,typeof N=="function"?N.apply(this,arguments):N),e.apply(this,arguments),s)},null,R)},g.translateTo=function(y,$,N,R,L){g.transform(y,function(){var X=e.apply(this,arguments),O=this.__zoom,Q=R==null?m(X):typeof R=="function"?R.apply(this,arguments):R;return n(ar.translate(Q[0],Q[1]).scale(O.k).translate(typeof $=="function"?-$.apply(this,arguments):-$,typeof N=="function"?-N.apply(this,arguments):-N),X,s)},R,L)};function b(y,$){return $=Math.max(a[0],Math.min(a[1],$)),$===y.k?y:new Pt($,y.x,y.y)}function E(y,$,N){var R=$[0]-N[0]*y.k,L=$[1]-N[1]*y.k;return R===y.x&&L===y.y?y:new Pt(y.k,R,L)}function m(y){return[(+y[0][0]+ +y[1][0])/2,(+y[0][1]+ +y[1][1])/2]}function _(y,$,N,R){y.on("start.zoom",function(){k(this,arguments).event(R).start()}).on("interrupt.zoom end.zoom",function(){k(this,arguments).event(R).end()}).tween("zoom",function(){var L=this,X=arguments,O=k(L,X).event(R),Q=e.apply(L,X),Z=N==null?m(Q):typeof N=="function"?N.apply(L,X):N,ft=Math.max(Q[1][0]-Q[0][0],Q[1][1]-Q[0][1]),rt=L.__zoom,ut=typeof $=="function"?$.apply(L,X):$,T=f(rt.invert(Z).concat(ft/rt.k),ut.invert(Z).concat(ft/ut.k));return function(F){if(F===1)F=ut;else{var W=T(F),J=ft/W[2];F=new Pt(J,Z[0]-W[0]*J,Z[1]-W[1]*J)}O.zoom(null,F)}})}function k(y,$,N){return!N&&y.__zooming||new A(y,$)}function A(y,$){this.that=y,this.args=$,this.active=0,this.sourceEvent=null,this.extent=e.apply(y,$),this.taps=0}A.prototype={event:function(y){return y&&(this.sourceEvent=y),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(y,$){return this.mouse&&y!=="mouse"&&(this.mouse[1]=$.invert(this.mouse[0])),this.touch0&&y!=="touch"&&(this.touch0[1]=$.invert(this.touch0[0])),this.touch1&&y!=="touch"&&(this.touch1[1]=$.invert(this.touch1[0])),this.that.__zoom=$,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(y){var $=Mt(this.that).datum();o.call(y,this.that,new xc(y,{sourceEvent:this.sourceEvent,target:g,transform:this.that.__zoom,dispatch:o}),$)}};function C(y,...$){if(!t.apply(this,arguments))return;var N=k(this,$).event(y),R=this.__zoom,L=Math.max(a[0],Math.min(a[1],R.k*Math.pow(2,r.apply(this,arguments)))),X=Ht(y);if(N.wheel)(N.mouse[0][0]!==X[0]||N.mouse[0][1]!==X[1])&&(N.mouse[1]=R.invert(N.mouse[0]=X)),clearTimeout(N.wheel);else{if(R.k===L)return;N.mouse=[X,R.invert(X)],Ge(this),N.start()}xe(y),N.wheel=setTimeout(O,w),N.zoom("mouse",n(E(b(R,L),N.mouse[0],N.mouse[1]),N.extent,s));function O(){N.wheel=null,N.end()}}function q(y,...$){if(h||!t.apply(this,arguments))return;var N=y.currentTarget,R=k(this,$,!0).event(y),L=Mt(y.view).on("mousemove.zoom",Z,!0).on("mouseup.zoom",ft,!0),X=Ht(y,N),O=y.clientX,Q=y.clientY;Ci(y.view),Hn(y),R.mouse=[X,this.__zoom.invert(X)],Ge(this),R.start();function Z(rt){if(xe(rt),!R.moved){var ut=rt.clientX-O,T=rt.clientY-Q;R.moved=ut*ut+T*T>d}R.event(rt).zoom("mouse",n(E(R.that.__zoom,R.mouse[0]=Ht(rt,N),R.mouse[1]),R.extent,s))}function ft(rt){L.on("mousemove.zoom mouseup.zoom",null),Ri(rt.view,R.moved),xe(rt),R.event(rt).end()}}function V(y,...$){if(t.apply(this,arguments)){var N=this.__zoom,R=Ht(y.changedTouches?y.changedTouches[0]:y,this),L=N.invert(R),X=N.k*(y.shiftKey?.5:2),O=n(E(b(N,X),R,L),e.apply(this,$),s);xe(y),l>0?Mt(this).transition().duration(l).call(_,O,R,y):Mt(this).call(g.transform,O,R,y)}}function G(y,...$){if(t.apply(this,arguments)){var N=y.touches,R=N.length,L=k(this,$,y.changedTouches.length===R).event(y),X,O,Q,Z;for(Hn(y),O=0;O<R;++O)Q=N[O],Z=Ht(Q,this),Z=[Z,this.__zoom.invert(Z),Q.identifier],L.touch0?!L.touch1&&L.touch0[2]!==Z[2]&&(L.touch1=Z,L.taps=0):(L.touch0=Z,X=!0,L.taps=1+!!c);c&&(c=clearTimeout(c)),X&&(L.taps<2&&(x=Z[0],c=setTimeout(function(){c=null},v)),Ge(this),L.start())}}function K(y,...$){if(this.__zooming){var N=k(this,$).event(y),R=y.changedTouches,L=R.length,X,O,Q,Z;for(xe(y),X=0;X<L;++X)O=R[X],Q=Ht(O,this),N.touch0&&N.touch0[2]===O.identifier?N.touch0[0]=Q:N.touch1&&N.touch1[2]===O.identifier&&(N.touch1[0]=Q);if(O=N.that.__zoom,N.touch1){var ft=N.touch0[0],rt=N.touch0[1],ut=N.touch1[0],T=N.touch1[1],F=(F=ut[0]-ft[0])*F+(F=ut[1]-ft[1])*F,W=(W=T[0]-rt[0])*W+(W=T[1]-rt[1])*W;O=b(O,Math.sqrt(F/W)),Q=[(ft[0]+ut[0])/2,(ft[1]+ut[1])/2],Z=[(rt[0]+T[0])/2,(rt[1]+T[1])/2]}else if(N.touch0)Q=N.touch0[0],Z=N.touch0[1];else return;N.zoom("touch",n(E(O,Q,Z),N.extent,s))}}function et(y,...$){if(this.__zooming){var N=k(this,$).event(y),R=y.changedTouches,L=R.length,X,O;for(Hn(y),h&&clearTimeout(h),h=setTimeout(function(){h=null},v),X=0;X<L;++X)O=R[X],N.touch0&&N.touch0[2]===O.identifier?delete N.touch0:N.touch1&&N.touch1[2]===O.identifier&&delete N.touch1;if(N.touch1&&!N.touch0&&(N.touch0=N.touch1,delete N.touch1),N.touch0)N.touch0[1]=this.__zoom.invert(N.touch0[0]);else if(N.end(),N.taps===2&&(O=Ht(O,this),Math.hypot(x[0]-O[0],x[1]-O[1])<p)){var Q=Mt(this).on("dblclick.zoom");Q&&Q.apply(this,arguments)}}}return g.wheelDelta=function(y){return arguments.length?(r=typeof y=="function"?y:Ve(+y),g):r},g.filter=function(y){return arguments.length?(t=typeof y=="function"?y:Ve(!!y),g):t},g.touchable=function(y){return arguments.length?(i=typeof y=="function"?y:Ve(!!y),g):i},g.extent=function(y){return arguments.length?(e=typeof y=="function"?y:Ve([[+y[0][0],+y[0][1]],[+y[1][0],+y[1][1]]]),g):e},g.scaleExtent=function(y){return arguments.length?(a[0]=+y[0],a[1]=+y[1],g):[a[0],a[1]]},g.translateExtent=function(y){return arguments.length?(s[0][0]=+y[0][0],s[1][0]=+y[1][0],s[0][1]=+y[0][1],s[1][1]=+y[1][1],g):[[s[0][0],s[0][1]],[s[1][0],s[1][1]]]},g.constrain=function(y){return arguments.length?(n=y,g):n},g.duration=function(y){return arguments.length?(l=+y,g):l},g.interpolate=function(y){return arguments.length?(f=y,g):f},g.on=function(){var y=o.on.apply(o,arguments);return y===o?g:y},g.clickDistance=function(y){return arguments.length?(d=(y=+y)*y,g):Math.sqrt(d)},g.tapDistance=function(y){return arguments.length?(p=+y,g):p},g}var Ac=_t('<div class="network-container w-full h-full bg-gray-50 rounded-lg border border-gray-200"></div>');function Sc(t,e){pi(e,!1);let n=yt(e,"items",24,()=>[]),r=yt(e,"neighbors",24,()=>({})),i=yt(e,"onNodeClick",8,()=>{}),a=yt(e,"onNodeHover",8,()=>{}),s=yt(e,"selectedId",8,null),l=yt(e,"maxNodes",8,500),f=yt(e,"minScore",8,.02),o=yt(e,"userSimilarity",24,()=>new Map),c=yt(e,"textWeight",8,.6),x=yt(e,"dateWeight",8,.2),h=yt(e,"placeWeight",8,.2),v=yt(e,"userWeight",8,0),w=ct(),d=ct(),p=ct(),g=[],b=[],E=new Map,m=yc,_=1200,k=700,A;function C(){if(!u(w)||!u(d))return;const T=u(w).getBoundingClientRect();_=Math.max(320,Math.floor(T.width)),k=Math.max(400,k),u(d).attr("width",_).attr("height",k).attr("viewBox",[0,0,_,k])}function q(){C(),u(p)&&u(p).force("center",ni(_/2,k/2)).alpha(.2).restart()}let V=null;li(()=>{G(),C(),typeof window<"u"&&(window.addEventListener("resize",q),V=()=>window.removeEventListener("resize",q))}),typeof window<"u"&&Ea(()=>{u(p)&&u(p).stop(),V&&V()});function G(){st(d,Mt(u(w)).append("svg").attr("width",_).attr("height",k).attr("viewBox",[0,0,_,k]).attr("style","max-width: 100%; height: auto;")),u(d).on("click",function(T){(T.target===this||T.target.tagName==="svg")&&i()("")}),A=Mc().scaleExtent([.1,10]).on("zoom",T=>{u(d).select(".graph-container").attr("transform",T.transform)}),u(d).call(A),u(d).append("g").attr("class","graph-container")}function K(){if(!u(d))return;const T=new Set,F=[];n().slice(0,l()).forEach(M=>{T.add(M.id)}),Object.entries(r()).forEach(([M,B])=>{T.has(M)&&B.forEach(Y=>{T.has(Y.id)&&Y.score>=f()&&F.push({source:M,target:Y.id,score:Y.score,baseScore:Y.score,S_text:Y.S_text,S_date:Y.S_date,S_place:Y.S_place})})}),g=Array.from(T).map(M=>{const B=n().find(Y=>Y.id===M);return{id:M,title:Array.isArray(B?.title)?B.title[0]:B?.title||M,year:B?.year,type:B?.type,collection:B?.collection,degree:0,cluster:0}});const J=new Map;F.forEach(M=>{const B=typeof M.source=="string"?M.source:M.source.id,Y=typeof M.target=="string"?M.target:M.target.id;J.set(B,(J.get(B)||0)+1),J.set(Y,(J.get(Y)||0)+1)}),g.forEach(M=>{M.degree=J.get(M.id)||0}),b=F,y(),$(),R()}function et(T,F){return[T,F].sort().join("|")}function y(){if(b)for(const T of b){const F=typeof T.source=="string"?T.source:T.source.id,W=typeof T.target=="string"?T.target:T.target.id,J=(T.S_text??0)*c(),M=(T.S_date??0)*x(),B=(T.S_place??0)*h(),U=(o()?.get(et(F,W))??0)*v(),nt=J+M+B+U,wt=Math.max(0,Math.min(1,nt));T.score=wt}}function $(){const T=new Map;b.forEach(M=>{const B=typeof M.source=="string"?M.source:M.source.id,Y=typeof M.target=="string"?M.target:M.target.id,U=Number.isFinite(M.score)?M.score:1;T.has(B)||T.set(B,new Map),T.has(Y)||T.set(Y,new Map),T.get(B).set(Y,(T.get(B).get(Y)||0)+U),T.get(Y).set(B,(T.get(Y).get(B)||0)+U)});const F=N(T,40);E.clear();const W=new Map;let J=0;for(const M of g){const B=F.get(M.id)||M.id;W.has(B)||W.set(B,J++),E.set(M.id,W.get(B))}g.forEach(M=>{M.cluster=E.get(M.id)||0})}function N(T,F=30){const W=new Map,J=g.map(M=>M.id);for(const M of J)W.set(M,M);for(let M=0;M<F;M++){let B=0;const Y=J.slice();for(let U=Y.length-1;U>0;U--){const nt=Math.floor(Math.random()*(U+1));[Y[U],Y[nt]]=[Y[nt],Y[U]]}for(const U of Y){const nt=T.get(U);if(!nt||nt.size===0)continue;const wt=new Map;nt.forEach((Xt,Ct)=>{const jt=W.get(Ct)||Ct;wt.set(jt,(wt.get(jt)||0)+Xt)});let Yt=W.get(U)||U,fe=-1/0;wt.forEach((Xt,Ct)=>{(Xt>fe||Xt===fe&&Ct<Yt)&&(fe=Xt,Yt=Ct)}),Yt!==W.get(U)&&(W.set(U,Yt),B++)}if(B===0)break}return W}function R(){const T=u(d).select(".graph-container");T.selectAll("*").remove();const F=T.append("g").attr("class","links").selectAll("line").data(b).join("line").attr("stroke","#999").attr("stroke-opacity",M=>.2+M.score*.6).attr("stroke-width",M=>Math.max(.5,M.score*3)),W=T.append("g").attr("class","nodes").selectAll("g").data(g).join("g").attr("cursor","pointer").call(X(u(p)));W.append("circle").attr("r",M=>Math.max(3,Math.min(15,3+Math.sqrt(M.degree)))).attr("fill",M=>m[M.cluster%m.length]).attr("stroke","#fff").attr("stroke-width",1.5).on("click",(M,B)=>{M.stopPropagation(),i()(B.id)}).on("mouseover",function(M,B){Mt(this).attr("stroke","#000").attr("stroke-width",2);try{a()(B.id)}catch{}const Y=T.append("g").attr("class","tooltip").attr("transform",`translate(${B.x},${B.y})`),U=Y.append("text").attr("dy",-20).attr("text-anchor","middle").style("font-size","12px").style("font-weight","bold").style("fill","#000").style("pointer-events","none");U.append("tspan").text(B.title.substring(0,50)+(B.title.length>50?"...":""));const nt=U.node().getBBox();Y.insert("rect","text").attr("x",nt.x-4).attr("y",nt.y-2).attr("width",nt.width+8).attr("height",nt.height+4).attr("fill","white").attr("stroke","#000").attr("rx",3)}).on("mouseout",function(){Mt(this).attr("stroke","#fff").attr("stroke-width",1.5),T.selectAll(".tooltip").remove();try{a()(null)}catch{}}),W.filter(M=>M.degree>5).append("text").attr("dx",8).attr("dy",3).style("font-size","8px").style("fill","#333").style("pointer-events","none").text(M=>M.title.substring(0,20)),st(p,gc(g).force("link",oc(b).id(M=>M.id).distance(M=>100-M.score*50).strength(M=>M.score)).force("charge",vc().strength(-30).distanceMax(200)).force("cluster",L()).force("collision",ac().radius(M=>Math.max(3,Math.min(15,3+Math.sqrt(M.degree)))+2)).force("center",ni(_/2,k/2)).on("tick",J));function J(){F.attr("x1",M=>M.source.x).attr("y1",M=>M.source.y).attr("x2",M=>M.target.x).attr("y2",M=>M.target.y),W.attr("transform",M=>`translate(${M.x},${M.y})`)}}function L(){let T;const W=_/2,J=k/2;function M(B){const Y=new Map;T.forEach(U=>{if(!Y.has(U.cluster)){const nt=U.cluster/10*2*Math.PI,wt=200;Y.set(U.cluster,{x:W+Math.cos(nt)*wt,y:J+Math.sin(nt)*wt,count:0})}}),T.forEach(U=>{const nt=Y.get(U.cluster);nt&&U.x!==void 0&&U.y!==void 0&&(U.vx=(U.vx||0)+(nt.x-U.x)*.3*B,U.vy=(U.vy||0)+(nt.y-U.y)*.3*B)})}return M.initialize=function(B){T=B},M}function X(T){function F(M){M.active||T.alphaTarget(.3).restart(),M.subject.fx=M.subject.x,M.subject.fy=M.subject.y}function W(M){M.subject.fx=M.x,M.subject.fy=M.y}function J(M){M.active||T.alphaTarget(0),M.subject.fx=null,M.subject.fy=null}return rl().on("start",F).on("drag",W).on("end",J)}function O(){if(!u(d)||!s())return;const T=new Set;T.add(s()),b.forEach(F=>{const W=typeof F.source=="string"?F.source:F.source.id,J=typeof F.target=="string"?F.target:F.target.id;W===s()&&T.add(J),J===s()&&T.add(W)}),u(d).select(".nodes").selectAll("g").attr("opacity",F=>T.has(F.id)?1:.15),u(d).select(".nodes").selectAll("circle").attr("stroke",F=>F.id===s()?"#ff0000":"#fff").attr("stroke-width",F=>F.id===s()?3:1.5),u(d).select(".links").selectAll("line").attr("stroke",F=>F.source.id===s()||F.target.id===s()?"#ff6b6b":"#999").attr("stroke-opacity",F=>F.source.id===s()||F.target.id===s()?.9:.08)}function Q(){u(d)&&(u(d).select(".nodes").selectAll("g").attr("opacity",1),u(d).select(".nodes").selectAll("circle").attr("stroke","#fff").attr("stroke-width",1.5),u(d).select(".links").selectAll("line").attr("stroke","#999").attr("stroke-opacity",T=>.2+T.score*.6))}function Z(){u(d)&&A&&u(d).transition().duration(750).call(A.transform,ar)}function ft(){u(p)&&u(p).alpha(1).restart()}kt(()=>(u(w),tt(n()),tt(r())),()=>{u(w)&&n().length>0&&r()&&K()}),kt(()=>(u(d),tt(l())),()=>{u(d)&&l()&&K()}),kt(()=>(u(d),tt(s())),()=>{u(d)&&(s()?O():Q())}),kt(()=>(u(p),u(d),tt(c()),tt(x()),tt(h()),tt(v()),tt(o())),()=>{if(u(p)&&u(d)){c(),x(),h(),v(),o(),y(),$(),u(d).select(".nodes").selectAll("circle").attr("fill",F=>m[(F.cluster??0)%m.length]),u(d).select(".links").selectAll("line").attr("stroke-opacity",F=>.2+F.score*.6).attr("stroke-width",F=>Math.max(.5,F.score*3));const T=u(p).force("link");T&&typeof T.distance=="function"&&typeof T.strength=="function"&&T.distance(F=>100-F.score*50).strength(F=>F.score),u(p).alpha(.6).restart()}}),gi();var rt={resetZoom:Z,reheat:ft};oi();var ut=Ac();return mi(ut,T=>st(w,T),()=>u(w)),mt(t,ut),Hr(e,"resetZoom",Z),Hr(e,"reheat",ft),vi(rt)}var Tc=_t("<option> </option>"),Ec=_t('<li class="p-0"><button type="button"><div class="text-sm font-medium"> </div> <div class="text-xs text-gray-500"> </div></button></li>'),$c=_t('<img class="w-full h-auto rounded mb-2"/>'),zc=_t('<div class="text-xs"> </div>'),Ic=_t('<div class="text-xs"> </div>'),Cc=_t('<a target="_blank" class="text-blue-600 text-sm hover:underline">View on Europeana</a>'),Rc=_t('<span class="text-purple-600 ml-1" title="User interaction boost"></span>'),Dc=_t('<li class="py-2"><div class="flex items-start justify-between gap-2"><button class="text-left text-sm hover:underline"> </button> <span class="text-xs text-gray-600 whitespace-nowrap"> <!></span></div> <div class="mt-1"><div class="flex items-center gap-2 text-[11px] text-gray-600 flex-wrap"><span class="inline-flex items-center gap-1"><span class="inline-block w-2 h-2 bg-indigo-500 rounded"></span> </span> <span class="inline-flex items-center gap-1"><span class="inline-block w-2 h-2 bg-emerald-500 rounded"></span> </span> <span class="inline-flex items-center gap-1"><span class="inline-block w-2 h-2 bg-amber-500 rounded"></span> </span> <span><span class="inline-block w-2 h-2 bg-purple-500 rounded"></span> </span></div></div></li>'),Fc=_t('<div class="mt-4 border-t pt-3"><div class="flex items-center justify-between mb-2"><h4 class="font-semibold">Top neighbors</h4> <span class="text-[10px] text-gray-500"> </span></div> <ul class="divide-y"></ul></div>'),Hc=_t('<!> <div class="space-y-1"><div class="font-medium"> </div> <div class="text-xs text-gray-600"> </div> <!> <!> <!> <button> </button> <div class="text-[11px] text-gray-500 mt-1"> </div></div> <!>',1),Pc=_t('<p class="text-sm text-gray-600">Hover a node to preview it; click a node to keep it here until you hover another.</p>'),Lc=_t(`<div class="p-4 space-y-4"><div class="flex justify-between items-center"><h2 class="text-sm text-gray-600">A Conceptual Visualization of the Graphical Topology of the Archive</h2></div> <div class="border-t pt-4"><p class="text-md text-gray-600 mb-3">This visualization sketches what we are calling the "graphical topology" of the archive: 
    a space where items relate to one another through textual metadata, dates, places, and 
    patterns of interaction. It is not a working archival platform but a conceptual model 
    meant to explore how archives might be navigated through relational proximity rather 
    than fixed hierarchies or linear search.</p></div> <div class="border rounded-lg bg-white p-4 space-y-3"><details class="border rounded-lg bg-gray-50" open><summary class="cursor-pointer p-4 select-none font-semibold text-gray-700 text-sm hover:bg-gray-100 rounded-lg"><span class="inline-flex items-center justify-between w-full"><span>Network Size</span> <span class="font-mono font-semibold text-gray-600"> </span></span></summary> <div class="px-4 pb-4 space-y-2"><div class="flex items-center gap-3"><span class="text-xs text-gray-600">10</span> <input type="range" min="10" step="10" class="flex-1 h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-500"/> <span class="text-xs text-gray-600"> </span></div> <p class="text-[10px] text-gray-500">Control the number of nodes from filtered results. Adjust search/filters above to change available items.</p></div></details> <details class="border rounded-lg bg-gray-50" open><summary class="cursor-pointer p-4 select-none hover:bg-gray-100 rounded-lg"><div class="flex items-center justify-between"><h3 class="text-sm font-semibold text-gray-700">Similarity Weights</h3> <button class="px-3 py-1 text-xs rounded border bg-white hover:bg-gray-100 text-gray-700" title="Reset weights to default values">Reset Weights</button></div></summary> <div class="px-4 pb-4"><div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"><div class="space-y-1"><label class="flex items-center justify-between text-xs text-gray-600"><span class="inline-flex items-center gap-1"><span class="inline-block w-2 h-2 bg-indigo-500 rounded"></span> Text</span> <span class="font-mono font-semibold"> </span></label> <input type="range" min="0" max="1" step="0.05" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-indigo-500"/></div> <div class="space-y-1"><label class="flex items-center justify-between text-xs text-gray-600"><span class="inline-flex items-center gap-1"><span class="inline-block w-2 h-2 bg-emerald-500 rounded"></span> Date</span> <span class="font-mono font-semibold"> </span></label> <input type="range" min="0" max="1" step="0.05" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-emerald-500"/></div> <div class="space-y-1"><label class="flex items-center justify-between text-xs text-gray-600"><span class="inline-flex items-center gap-1"><span class="inline-block w-2 h-2 bg-amber-500 rounded"></span> Place</span> <span class="font-mono font-semibold"> </span></label> <input type="range" min="0" max="1" step="0.05" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-amber-500"/></div> <div class="space-y-1"><label class="flex items-center justify-between text-xs text-gray-600"><span class="inline-flex items-center gap-1"><span class="inline-block w-2 h-2 bg-purple-500 rounded"></span> User</span> <span class="font-mono font-semibold"> </span></label> <input type="range" min="0" max="1" step="0.05" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-purple-500"/></div></div> <p class="text-[10px] text-gray-500 mt-2"> </p></div></details> <div class="flex gap-4 items-center flex-wrap"><button class="px-3 py-1 bg-gray-600 text-white rounded text-sm">Reset Zoom</button> <button class="ml-auto px-3 py-1 rounded text-sm border bg-gray-100 hover:bg-gray-200" aria-controls="preview-panel"> </button> <button class="px-3 py-1 rounded text-sm border bg-red-50 hover:bg-red-100 text-red-700" title="Reset interaction history">Reset Interactions</button></div> <div class="flex flex-col lg:flex-row gap-4 items-start"><div class="flex-1 min-w-0 space-y-4"><!> <div class="border rounded-lg bg-white p-4"><h3 class="text-lg font-bold text-gray-800 mb-3">Search & Filter</h3> <div class="space-y-3"><div class="flex gap-3 flex-wrap items-center"><input type="search" class="border rounded px-3 py-2 flex-1 min-w-[200px]" placeholder="Search title"/> <select class="border rounded px-3 py-2"><option>All languages</option><!></select> <input class="border rounded px-3 py-2 w-32" type="number" placeholder="Year "/> <input class="border rounded px-3 py-2 w-32" type="number" placeholder="Year "/></div> <div class="text-sm text-gray-600"> </div> <ul class="border rounded divide-y max-h-[50vh] overflow-auto bg-gray-50"></ul></div></div></div>  <div role="separator" aria-orientation="vertical" class="hidden lg:block w-1 cursor-col-resize self-stretch bg-gray-300 hover:bg-gray-400 transition-colors" title="Drag to resize details panel"></div> <aside id="preview-panel"><h3 class="font-semibold mb-2">Details</h3> <!></aside></div></div></div>`);function Uc(t,e){pi(e,!1);const n=()=>ee(Ut,"$selectedId",f),r=()=>ee(Xn,"$items",f),i=()=>ee(He,"$filters",f),a=()=>ee(xi,"$byId",f),s=()=>ee(ps,"$userSimilarity",f),l=()=>ee(se,"$userInteractions",f),[f,o]=ns(),c=ct(),x=ct(),h=ct(),v=ct(),w=ct(),d=ct();let p=yt(e,"data",8),g=ct(),b=ct(!0),E=ct(null),m=ct([]),_=ct({text:.6,date:.2,place:.2,user:.5}),k=ct(500),A=null,C=ct(360);const q=260,V=640;let G=!1,K=0,et=0;function y(S){return Array.isArray(S)?S:Array.isArray(S?.pairs)?S.pairs.map(I=>({source:I.a,target:I.b,score:I.score})):S?.graph?.edges??[]}li(()=>{if(Xn.set(p().metadata||[]),_i.set(y(p().neighbors)),st(k,p().metadata?.length||500),typeof window<"u"){st(b,window.innerWidth>=1024);const S=Number(localStorage.getItem("ga_panel_width"));!Number.isNaN(S)&&S>=q&&S<=V&&st(C,S)}});let $=ct("");function N(S){S===""?Ut.set(null):(A&&(clearTimeout(A),A=null),Ut.set(S),se.trackView(S))}function R(S){if(A&&(clearTimeout(A),A=null),st(E,S),S){const I=S;A=setTimeout(()=>{u(E)===I&&(se.trackHover(I),Ut.set(I)),A=null},3e3)}}function L(S){u(b)&&(G=!0,K="touches"in S?S.touches[0].clientX:S.clientX,et=u(C),window.addEventListener("mousemove",X),window.addEventListener("touchmove",X,{passive:!1}),window.addEventListener("mouseup",O),window.addEventListener("touchend",O),document.body.style.cursor="col-resize",document.body.style.userSelect="none")}function X(S){if(!G)return;if("preventDefault"in S)try{S.preventDefault()}catch{}const I="touches"in S?S.touches[0].clientX:S.clientX,it=K-I,ht=Math.max(q,Math.min(V,et+it));st(C,ht)}function O(){G=!1,window.removeEventListener("mousemove",X),window.removeEventListener("touchmove",X),window.removeEventListener("mouseup",O),window.removeEventListener("touchend",O),document.body.style.cursor="",document.body.style.userSelect=""}function Q(S,I=10){if(!S)return[];const it=p()?.neighbors;return(Array.isArray(it)?[]:it?.[S]??[]).slice(0,I).map(dt=>({...dt,item:a().get(dt.id)}))}kt(()=>(u(E),n()),()=>{st(c,u(E)??n()??null)}),kt(()=>u(C),()=>{try{localStorage.setItem("ga_panel_width",String(u(C)))}catch{}}),kt(()=>u($),()=>{st(x,u($).toLowerCase())}),kt(()=>(r(),u(x),i()),()=>{st(h,r().filter(S=>{const I=(Array.isArray(S.title)?S.title[0]:S.title)??"",it=!u(x)||String(I).toLowerCase().includes(u(x)),ht=S.language&&S.language[0]||"",dt=!i().lang||ht===i().lang,Rt=Number(S.year),Tt=(!i().yearFrom||Rt>=i().yearFrom)&&(!i().yearTo||Rt<=i().yearTo||Number.isNaN(Rt));return it&&dt&&Tt}))}),kt(()=>(u(h),u(k)),()=>{st(v,u(h).slice(0,u(k)))}),kt(()=>u(v),()=>{st(w,new Set(u(v).map(S=>S.id)))}),kt(()=>(u(h),u(w)),()=>{st(d,u(h).filter(S=>u(w).has(S.id)))}),kt(()=>u(c),()=>{st(m,Q(u(c),10))}),gi(),oi();var Z=Lc(),ft=H(D(Z),4),rt=D(ft),ut=D(rt),T=D(ut),F=H(D(T),2),W=D(F);z(F),z(T),z(ut);var J=H(ut,2),M=D(J),B=H(D(M),2);ne(B);var Y=H(B,2),U=D(Y,!0);z(Y),z(M),ts(2),z(J),z(rt);var nt=H(rt,2),wt=D(nt),Yt=D(wt),fe=H(D(Yt),2);z(Yt),z(wt);var Xt=H(wt,2),Ct=D(Xt),jt=D(Ct),sn=D(jt),sr=H(D(sn),2),Ui=D(sr,!0);z(sr),z(sn);var or=H(sn,2);ne(or),z(jt);var on=H(jt,2),ln=D(on),lr=H(D(ln),2),Ki=D(lr,!0);z(lr),z(ln);var ur=H(ln,2);ne(ur),z(on);var un=H(on,2),cn=D(un),cr=H(D(cn),2),Qi=D(cr,!0);z(cr),z(cn);var fr=H(cn,2);ne(fr),z(un);var hr=H(un,2),fn=D(hr),dr=H(D(fn),2),Zi=D(dr,!0);z(dr),z(fn);var pr=H(fn,2);ne(pr),z(hr),z(Ct);var gr=H(Ct,2),Ji=D(gr);z(gr),z(Xt),z(nt);var hn=H(nt,2),vr=D(hn),he=H(vr,2),ji=D(he,!0);z(he);var ta=H(he,2);z(hn);var mr=H(hn,2),dn=D(mr),yr=D(dn);{var ea=S=>{mi(Sc(S,{get items(){return u(v)},get neighbors(){return tt(p()),P(()=>p().neighbors)},get userSimilarity(){return s()},get textWeight(){return u(_),P(()=>u(_).text)},get dateWeight(){return u(_),P(()=>u(_).date)},get placeWeight(){return u(_),P(()=>u(_).place)},get userWeight(){return u(_),P(()=>u(_).user)},get maxNodes(){return u(k)},get selectedId(){return n()},onNodeClick:N,onNodeHover:R,$$legacy:!0}),I=>st(g,I),()=>u(g))};Ot(yr,S=>{S(ea)})}var xr=H(yr,2),_r=H(D(xr),2),pn=D(_r),gn=D(pn);ne(gn);var ze=H(gn,2),vn=D(ze);vn.value=vn.__value="";var na=H(vn);$n(na,1,()=>(r(),P(()=>Array.from(new Set(r().flatMap(S=>S.language||[]))))),En,(S,I)=>{var it=Tc(),ht=D(it,!0);z(it);var dt={};Et(()=>{j(ht,u(I)),dt!==(dt=u(I))&&(it.value=(it.__value=u(I))??"")}),mt(S,it)}),z(ze);var wr=H(ze,2),ra=H(wr,2);z(pn);var mn=H(pn,2),ia=D(mn);z(mn);var br=H(mn,2);$n(br,5,()=>(u(d),P(()=>u(d).slice(0,200))),En,(S,I)=>{var it=Ec(),ht=D(it),dt=D(ht),Rt=D(dt,!0);z(dt);var Tt=H(dt,2),qt=D(Tt);z(Tt),z(ht),z(it),Et((pe,Wt)=>{Fe(ht,1,`w-full text-left p-3 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 ${n(),u(I),P(()=>n()===u(I).id?"bg-blue-50":"")??""}`),j(Rt,pe),j(qt,`${u(I),P(()=>u(I).year)??""}  ${Wt??""}`)},[()=>(u(I),P(()=>Array.isArray(u(I).title)?u(I).title[0]:u(I).title)),()=>(u(I),P(()=>u(I).language&&u(I).language.join(", ")||""))]),bt("click",ht,()=>{Ut.set(u(I).id),u(g)&&u(g).centerOnNode?.(u(I).id)}),mt(S,it)}),z(br),z(_r),z(xr),z(dn);var Ie=H(dn,2),de=H(Ie,2),aa=H(D(de),2);{var sa=S=>{const I=ie(()=>(a(),u(c),P(()=>a().get(u(c))))),it=ie(()=>(tt(u(I)),P(()=>Array.isArray(u(I).title)?u(I).title[0]:u(I).title)));var ht=Hc(),dt=es(ht);{var Rt=at=>{var ot=$c();Et(()=>{Gt(ot,"src",(tt(u(I)),P(()=>u(I).thumbnail))),Gt(ot,"alt",u(it)||"thumbnail")}),mt(at,ot)};Ot(dt,at=>{tt(u(I)),P(()=>u(I).thumbnail)&&at(Rt)})}var Tt=H(dt,2),qt=D(Tt),pe=D(qt,!0);z(qt);var Wt=H(qt,2),yn=D(Wt);z(Wt);var kr=H(Wt,2);{var la=at=>{var ot=zc(),Dt=D(ot);z(ot),Et(()=>j(Dt,`Country: ${tt(u(I)),P(()=>u(I).country)??""}`)),mt(at,ot)};Ot(kr,at=>{tt(u(I)),P(()=>u(I).country)&&at(la)})}var Nr=H(kr,2);{var ua=at=>{var ot=Ic(),Dt=D(ot);z(ot),Et(()=>j(Dt,`Collection: ${tt(u(I)),P(()=>u(I).collection)??""}`)),mt(at,ot)};Ot(Nr,at=>{tt(u(I)),P(()=>u(I).collection)&&at(ua)})}var Mr=H(Nr,2);{var ca=at=>{var ot=Cc();Et(()=>Gt(ot,"href",(tt(u(I)),P(()=>u(I).link)))),mt(at,ot)};Ot(Mr,at=>{tt(u(I)),P(()=>u(I).link)&&at(ca)})}var ge=H(Mr,2),fa=D(ge,!0);z(ge);var Ar=H(ge,2),ha=D(Ar);z(Ar),z(Tt);var da=H(Tt,2);{var pa=at=>{var ot=Fc(),Dt=D(ot),Ce=H(D(Dt),2),ga=D(Ce);z(Ce),z(Dt);var Sr=H(Dt,2);$n(Sr,5,()=>u(m),En,(va,lt)=>{const Tr=ie(()=>(u(lt),P(()=>Array.isArray(u(lt).item?.title)?u(lt).item?.title[0]:u(lt).item?.title))),te=ie(()=>(s(),u(c),u(lt),P(()=>s().get([u(c),u(lt).id].sort().join("|"))??0))),Er=ie(()=>(u(_),u(lt),tt(u(te)),P(()=>u(_).text*(u(lt).S_text??0)+u(_).date*(u(lt).S_date??0)+u(_).place*(u(lt).S_place??0)+u(_).user*u(te))));var xn=Dc(),_n=D(xn),Re=D(_n),ma=D(Re,!0);z(Re);var $r=H(Re,2),zr=D($r),ya=H(zr);{var xa=ve=>{var Mn=Rc();mt(ve,Mn)};Ot(ya,ve=>{u(te)>0&&ve(xa)})}z($r),z(_n);var Ir=H(_n,2),Cr=D(Ir),wn=D(Cr),_a=H(D(wn));z(wn);var bn=H(wn,2),wa=H(D(bn));z(bn);var kn=H(bn,2),ba=H(D(kn));z(kn);var Nn=H(kn,2),ka=H(D(Nn));z(Nn),z(Cr),z(Ir),z(xn),Et((ve,Mn,Na,Ma,Aa)=>{j(ma,(tt(u(Tr)),u(lt),P(()=>u(Tr)??u(lt).title??u(lt).id))),j(zr,`${ve??""} `),j(_a,`Text ${Mn??""}`),j(wa,`Date ${Na??""}`),j(ba,`Place ${Ma??""}`),Fe(Nn,1,`inline-flex items-center gap-1 ${u(te)>0?"text-purple-600 font-medium":""}`),j(ka,`User ${Aa??""}`)},[()=>(tt(u(Er)),P(()=>u(Er).toFixed(2))),()=>(u(lt),P(()=>Number(u(lt).S_text??0).toFixed(2))),()=>(u(lt),P(()=>Number(u(lt).S_date??0).toFixed(2))),()=>(u(lt),P(()=>Number(u(lt).S_place??0).toFixed(2))),()=>(tt(u(te)),P(()=>u(te).toFixed(2)))]),bt("click",Re,()=>{Ut.set(u(lt).id),st(E,null)}),mt(va,xn)}),z(Sr),z(ot),Et(()=>j(ga,`G = ${u(_),P(()=>u(_).text)??""}Text + ${u(_),P(()=>u(_).date)??""}Date + ${u(_),P(()=>u(_).place)??""}Place + ${u(_),P(()=>u(_).user)??""}User`)),mt(at,ot)};Ot(da,at=>{u(m),P(()=>u(m).length)&&at(pa)})}Et((at,ot,Dt,Ce)=>{j(pe,u(it)??"(no title)"),j(yn,`${tt(u(I)),P(()=>u(I).year??"")??""}  ${at??""}`),Fe(ge,1,`mt-2 px-2 py-1 text-xs rounded ${ot??""}`),j(fa,Dt),j(ha,`Hover views: ${Ce??""}`)},[()=>(tt(u(I)),P(()=>u(I).language&&u(I).language.join(", ")||"")),()=>(l(),u(c),P(()=>l().bookmarks.has(u(c))?"bg-yellow-100 text-yellow-800 border border-yellow-300":"bg-gray-100 text-gray-700 border border-gray-300")),()=>(l(),u(c),P(()=>l().bookmarks.has(u(c))?" Bookmarked":" Bookmark")),()=>(l(),u(c),P(()=>l().hoverTimestamps?.get(u(c))?.length||0))]),bt("click",ge,()=>se.toggleBookmark(u(c))),mt(S,ht)},oa=S=>{var I=Pc();mt(S,I)};Ot(aa,S=>{u(c),a(),P(()=>u(c)&&a().get(u(c)))?S(sa):S(oa,!1)})}z(de),z(mr),z(ft),z(Z),Et((S,I,it,ht,dt,Rt,Tt,qt,pe,Wt,yn)=>{j(W,`${S??""} / ${u(h),P(()=>u(h).length)??""} nodes`),Gt(B,"max",I),j(U,(u(h),P(()=>u(h).length))),j(Ui,it),j(Ki,ht),j(Qi,dt),j(Zi,Rt),j(Ji,`Adjust weights to control how similarity scores are calculated: G = ${Tt??""}Text + ${qt??""}Date + ${pe??""}Place + ${Wt??""}User`),Gt(he,"aria-expanded",u(b)),j(ji,u(b)?"Hide panel":"Show panel"),j(ia,`Showing ${yn??""} of ${u(d),P(()=>u(d).length)??""} items`),Gt(Ie,"aria-hidden",!u(b)),Fe(de,1,`border rounded-lg p-3 bg-gray-50 max-h-[140vh] overflow-auto w-full lg:w-auto flex-shrink-0 ${u(b)?"block":"hidden"}`),Gt(de,"aria-hidden",!u(b)),os(de,`width: ${u(b)?u(C)+"px":"auto"}`)},[()=>(u(k),u(h),P(()=>Math.min(u(k),u(h).length))),()=>(u(h),P(()=>Math.max(10,u(h).length))),()=>(u(_),P(()=>u(_).text.toFixed(2))),()=>(u(_),P(()=>u(_).date.toFixed(2))),()=>(u(_),P(()=>u(_).place.toFixed(2))),()=>(u(_),P(()=>u(_).user.toFixed(2))),()=>(u(_),P(()=>u(_).text.toFixed(2))),()=>(u(_),P(()=>u(_).date.toFixed(2))),()=>(u(_),P(()=>u(_).place.toFixed(2))),()=>(u(_),P(()=>u(_).user.toFixed(2))),()=>(u(d),P(()=>Math.min(u(d).length,200)))]),re(B,()=>u(k),S=>st(k,S)),bt("click",fe,ls(()=>{st(_,{text:.6,date:.2,place:.2,user:.5})})),re(or,()=>u(_).text,S=>De(_,u(_).text=S)),re(ur,()=>u(_).date,S=>De(_,u(_).date=S)),re(fr,()=>u(_).place,S=>De(_,u(_).place=S)),re(pr,()=>u(_).user,S=>De(_,u(_).user=S)),bt("click",vr,()=>u(g)?.resetZoom()),bt("click",he,()=>st(b,!u(b))),bt("click",ta,()=>{confirm("Clear all tracked views and bookmarks?")&&se.reset()}),re(gn,()=>u($),S=>st($,S)),bt("change",ze,S=>He.set({...i(),lang:S.target.value||void 0})),bt("change",wr,S=>He.set({...i(),yearFrom:Number(S.target.value)||void 0})),bt("change",ra,S=>He.set({...i(),yearTo:Number(S.target.value)||void 0})),bt("mousedown",Ie,L),bt("touchstart",Ie,L),mt(t,Z),vi(),o()}export{Uc as component,Gc as universal};
