import{a as Sa,b as Ta}from"../chunks/CuwJ6ud-.js";import{f as _t,a as mt,e as bt,s as j}from"../chunks/CX0uSioi.js";import{i as si}from"../chunks/DfEPUvZZ.js";import{h as ui,F as Ea,aO as li,M as An,j as $t,ac as $a,G as za,x as l,a2 as ie,I as Ia,J as Ca,K as Rr,O as Sn,k as me,ad as Ra,aM as Da,i as Hn,l as Fa,aP as tn,aQ as en,b as ae,au as Dr,V as ct,am as Fr,aK as ci,aR as Pa,d as fi,g as Ha,aS as La,aT as Tn,D as Xa,e as hi,aU as Oa,ae as Va,aV as Ba,aJ as Ya,aW as qa,a0 as Wa,aX as Ga,aj as Ua,q as H,Q as Ka,aY as Za,Z as Qa,R as Ja,aZ as Kn,a_ as Se,p as di,ah as pi,a$ as ja,X as ot,b0 as kt,y as tt,b1 as gi,a as vi,c as D,t as Tt,s as P,r as z,af as to,b2 as De,f as eo}from"../chunks/FM3A2-t2.js";import{p as yt,b as mi,i as Ot,s as no,a as ee}from"../chunks/CE0MQWRD.js";import{t as ro,s as Gt,a as Fe,r as ne}from"../chunks/M1LYPqTU.js";function En(t,e){return e}function io(t,e,n){for(var r=t.items,i=[],a=e.length,o=0;o<a;o++)Ba(e[o].e,i,!0);var u=a>0&&i.length===0&&n!==null;if(u){var f=n.parentNode;Ya(f),f.append(n),r.clear(),Et(t,e[0].prev,e[a-1].next)}qa(i,()=>{for(var s=0;s<a;s++){var c=e[s];u||(r.delete(c.k),Et(t,c.prev,c.next)),hi(c.e,!u)}})}function $n(t,e,n,r,i,a=null){var o=t,u={flags:e,items:new Map,first:null},f=(e&li)!==0;if(f){var s=t;o=$t?An($a(s)):s.appendChild(ui())}$t&&za();var c=null,x=!1,h=new Map,v=ie(()=>{var g=n();return Pa(g)?g:g==null?[]:ci(g)}),w,d;function p(){ao(d,w,u,h,o,i,e,r,n),a!==null&&(w.length===0?c?fi(c):c=Hn(()=>a(o)):c!==null&&Ha(c,()=>{c=null}))}Ea(()=>{d??=Wa,w=l(v);var g=w.length;if(x&&g===0)return;x=g===0;let b=!1;if($t){var E=Ia(o)===Ca;E!==(g===0)&&(o=Rr(),An(o),Sn(!1),b=!0)}if($t){for(var m=null,_,k=0;k<g;k++){if(me.nodeType===Ra&&me.data===Da){o=me,b=!0,Sn(!1);break}var A=w[k],C=r(A,k);_=Ln(me,u,m,null,A,C,k,i,e,n),u.items.set(C,_),m=_}g>0&&An(Rr())}if($t)g===0&&a&&(c=Hn(()=>a(o)));else if(Fa()){var q=new Set,B=ae;for(k=0;k<g;k+=1){A=w[k],C=r(A,k);var G=u.items.get(C)??h.get(C);G?(e&(tn|en))!==0&&yi(G,A,k,e):(_=Ln(null,u,null,null,A,C,k,i,e,n,!0),h.set(C,_)),q.add(C)}for(const[K,et]of u.items)q.has(K)||B.skipped_effects.add(et.e);B.oncommit(p)}else p();b&&Sn(!0),l(v)}),$t&&(o=me)}function ao(t,e,n,r,i,a,o,u,f){var s=(o&Oa)!==0,c=(o&(tn|en))!==0,x=e.length,h=n.items,v=n.first,w=v,d,p=null,g,b=[],E=[],m,_,k,A;if(s)for(A=0;A<x;A+=1)m=e[A],_=u(m,A),k=h.get(_),k!==void 0&&(k.a?.measure(),(g??=new Set).add(k));for(A=0;A<x;A+=1){if(m=e[A],_=u(m,A),k=h.get(_),k===void 0){var C=r.get(_);if(C!==void 0){r.delete(_),h.set(_,C);var q=p?p.next:w;Et(n,p,C),Et(n,C,q),zn(C,q,i),p=C}else{var B=w?w.e.nodes_start:i;p=Ln(B,n,p,p===null?n.first:p.next,m,_,A,a,o,f)}h.set(_,p),b=[],E=[],w=p.next;continue}if(c&&yi(k,m,A,o),(k.e.f&Tn)!==0&&(fi(k.e),s&&(k.a?.unfix(),(g??=new Set).delete(k))),k!==w){if(d!==void 0&&d.has(k)){if(b.length<E.length){var G=E[0],K;p=G.prev;var et=b[0],y=b[b.length-1];for(K=0;K<b.length;K+=1)zn(b[K],G,i);for(K=0;K<E.length;K+=1)d.delete(E[K]);Et(n,et.prev,y.next),Et(n,p,et),Et(n,y,G),w=G,p=y,A-=1,b=[],E=[]}else d.delete(k),zn(k,w,i),Et(n,k.prev,k.next),Et(n,k,p===null?n.first:p.next),Et(n,p,k),p=k;continue}for(b=[],E=[];w!==null&&w.k!==_;)(w.e.f&Tn)===0&&(d??=new Set).add(w),E.push(w),w=w.next;if(w===null)continue;k=w}b.push(k),p=k,w=k.next}if(w!==null||d!==void 0){for(var $=d===void 0?[]:ci(d);w!==null;)(w.e.f&Tn)===0&&$.push(w),w=w.next;var N=$.length;if(N>0){var R=(o&li)!==0&&x===0?i:null;if(s){for(A=0;A<N;A+=1)$[A].a?.measure();for(A=0;A<N;A+=1)$[A].a?.fix()}io(n,$,R)}}s&&Xa(()=>{if(g!==void 0)for(k of g)k.a?.apply()}),t.first=n.first&&n.first.e,t.last=p&&p.e;for(var L of r.values())hi(L.e);r.clear()}function yi(t,e,n,r){(r&tn)!==0&&Dr(t.v,e),(r&en)!==0?Dr(t.i,n):t.i=n}function Ln(t,e,n,r,i,a,o,u,f,s,c){var x=(f&tn)!==0,h=(f&La)===0,v=x?h?ct(i,!1,!1):Fr(i):i,w=(f&en)===0?o:Fr(o),d={i:w,v,k:a,a:null,e:null,prev:n,next:r};try{if(t===null){var p=document.createDocumentFragment();p.append(t=ui())}return d.e=Hn(()=>u(t,v,w,s),$t),d.e.prev=n&&n.e,d.e.next=r&&r.e,n===null?c||(e.first=d):(n.next=d,n.e.next=d.e),r!==null&&(r.prev=d,r.e.prev=d.e),d}finally{}}function zn(t,e,n){for(var r=t.next?t.next.e.nodes_start:n,i=e?e.e.nodes_start:n,a=t.e.nodes_start;a!==null&&a!==r;){var o=Va(a);i.before(a),a=o}}function Et(t,e,n){e===null?t.first=n:(e.next=n,e.e.next=n&&n.e),n!==null&&(n.prev=e,n.e.prev=e&&e.e)}function oo(t,e,n,r){var i=t.__style;if($t||i!==e){var a=ro(e);(!$t||a!==t.getAttribute("style"))&&(a==null?t.removeAttribute("style"):t.style.cssText=a),t.__style=e}return r}function re(t,e,n=e){var r=new WeakSet;Ga(t,"input",async i=>{var a=i?t.defaultValue:t.value;if(a=In(t)?Cn(a):a,n(a),ae!==null&&r.add(ae),await Ua(),a!==(a=e())){var o=t.selectionStart,u=t.selectionEnd,f=t.value.length;if(t.value=a??"",u!==null){var s=t.value.length;o===u&&u===f&&s>f?(t.selectionStart=s,t.selectionEnd=s):(t.selectionStart=o,t.selectionEnd=Math.min(u,s))}}}),($t&&t.defaultValue!==t.value||H(e)==null&&t.value)&&(n(In(t)?Cn(t.value):t.value),ae!==null&&r.add(ae)),Ka(()=>{var i=e();if(t===document.activeElement){var a=Za??ae;if(r.has(a))return}In(t)&&i===Cn(t.value)||t.type==="date"&&!i&&!t.value||i!==t.value&&(t.value=i??"")})}function In(t){var e=t.type;return e==="number"||e==="range"}function Cn(t){return t===""?null:+t}function Pr(t,e,n){var r=Qa(t,e);r&&r.set&&(t[e]=n,Ja(()=>{t[e]=null}))}function so(t){return function(...e){var n=e[0];return n.stopPropagation(),t?.apply(this,e)}}function Hr(t){return(Sa||Ta)+t}const uo=!1,lo=!0;async function co({fetch:t}){const[e,n]=await Promise.all([t(Hr("/data/europeana_metadata.json")),t(Hr("/data/europeana_neighbors.json"))]);return{metadata:await e.json(),neighbors:await n.json()}}const qc=Object.freeze(Object.defineProperty({__proto__:null,load:co,prerender:lo,ssr:uo},Symbol.toStringTag,{value:"Module"})),Xn=Se([]),xi=Kn(Xn,t=>{const e=new Map;for(const n of t)e.set(n.id,n);return e}),_i=Se([]),Ut=Se(null),Pe=Se({});Kn([Ut,_i,xi],([t,e,n])=>t?e.filter(r=>r.source===t||r.target===t).map(r=>({id:r.source===t?r.target:r.source,score:r.score,item:n.get(r.source===t?r.target:r.source)})).filter(r=>r.item).sort((r,i)=>i.score-r.score):[]);function fo(){if(typeof window>"u")return{views:new Set,bookmarks:new Set,viewTimestamps:new Map,hoverTimestamps:new Map};try{const t=sessionStorage.getItem("europeana_user_interactions");if(!t)return{views:new Set,bookmarks:new Set,viewTimestamps:new Map,hoverTimestamps:new Map};const e=JSON.parse(t);return{views:new Set(e.views||[]),bookmarks:new Set(e.bookmarks||[]),viewTimestamps:new Map(e.viewTimestamps||[]),hoverTimestamps:new Map(e.hoverTimestamps||[])}}catch{return{views:new Set,bookmarks:new Set,viewTimestamps:new Map,hoverTimestamps:new Map}}}function He(t){if(!(typeof window>"u"))try{sessionStorage.setItem("europeana_user_interactions",JSON.stringify({views:Array.from(t.views),bookmarks:Array.from(t.bookmarks),viewTimestamps:Array.from(t.viewTimestamps.entries()),hoverTimestamps:Array.from((t.hoverTimestamps||new Map).entries())}))}catch(e){console.warn("Failed to save interactions:",e)}}function ho(){const{subscribe:t,update:e}=Se(fo());return{subscribe:t,trackView:n=>e(r=>{r.views.add(n);const i=r.viewTimestamps.get(n)||[];return i.push(Date.now()),r.viewTimestamps.set(n,i),He(r),r}),trackHover:n=>e(r=>{r.hoverTimestamps=r.hoverTimestamps||new Map;const i=r.hoverTimestamps.get(n)||[];return i.push(Date.now()),r.hoverTimestamps.set(n,i),He(r),r}),toggleBookmark:n=>e(r=>(r.bookmarks.has(n)?r.bookmarks.delete(n):r.bookmarks.add(n),He(r),r)),reset:()=>e(()=>{const n={views:new Set,bookmarks:new Set,viewTimestamps:new Map,hoverTimestamps:new Map};return He(n),n})}}const oe=ho(),po=Kn([oe],([t])=>{Array.from(t.views);const e=Array.from(t.bookmarks),n=new Map,r=new Map,i=Array.from(t.viewTimestamps.entries()).sort((s,c)=>{const x=s[1][s[1].length-1]||0,h=c[1][c[1].length-1]||0;return x-h}).map(s=>s[0]),a=5;for(let s=0;s<i.length;s++)for(let c=s+1;c<Math.min(s+a,i.length);c++){const x=[i[s],i[c]].sort().join("|");n.set(x,(n.get(x)||0)+1)}for(let s=0;s<e.length;s++)for(let c=s+1;c<e.length;c++){const x=[e[s],e[c]].sort().join("|");r.set(x,(r.get(x)||0)+1)}const o=new Map,u=Math.max(1,...Array.from(n.values())),f=Math.max(1,...Array.from(r.values()));return n.forEach((s,c)=>{o.set(c,(o.get(c)||0)+.4*(s/u))}),r.forEach((s,c)=>{o.set(c,(o.get(c)||0)+.6*(s/f))}),o});var go={value:()=>{}};function Te(){for(var t=0,e=arguments.length,n={},r;t<e;++t){if(!(r=arguments[t]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new Ye(n)}function Ye(t){this._=t}function vo(t,e){return t.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}Ye.prototype=Te.prototype={constructor:Ye,on:function(t,e){var n=this._,r=vo(t+"",n),i,a=-1,o=r.length;if(arguments.length<2){for(;++a<o;)if((i=(t=r[a]).type)&&(i=mo(n[i],t.name)))return i;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++a<o;)if(i=(t=r[a]).type)n[i]=Lr(n[i],t.name,e);else if(e==null)for(i in n)n[i]=Lr(n[i],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new Ye(t)},call:function(t,e){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,a;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(a=this._[t],r=0,i=a.length;r<i;++r)a[r].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,a=r.length;i<a;++i)r[i].value.apply(e,n)}};function mo(t,e){for(var n=0,r=t.length,i;n<r;++n)if((i=t[n]).name===e)return i.value}function Lr(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=go,t=t.slice(0,r).concat(t.slice(r+1));break}return n!=null&&t.push({name:e,value:n}),t}var On="http://www.w3.org/1999/xhtml";const Xr={svg:"http://www.w3.org/2000/svg",xhtml:On,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function nn(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),Xr.hasOwnProperty(e)?{space:Xr[e],local:t}:t}function yo(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===On&&e.documentElement.namespaceURI===On?e.createElement(t):e.createElementNS(n,t)}}function xo(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function wi(t){var e=nn(t);return(e.local?xo:yo)(e)}function _o(){}function Zn(t){return t==null?_o:function(){return this.querySelector(t)}}function wo(t){typeof t!="function"&&(t=Zn(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var a=e[i],o=a.length,u=r[i]=new Array(o),f,s,c=0;c<o;++c)(f=a[c])&&(s=t.call(f,f.__data__,c,a))&&("__data__"in f&&(s.__data__=f.__data__),u[c]=s);return new xt(r,this._parents)}function bo(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function ko(){return[]}function bi(t){return t==null?ko:function(){return this.querySelectorAll(t)}}function No(t){return function(){return bo(t.apply(this,arguments))}}function Mo(t){typeof t=="function"?t=No(t):t=bi(t);for(var e=this._groups,n=e.length,r=[],i=[],a=0;a<n;++a)for(var o=e[a],u=o.length,f,s=0;s<u;++s)(f=o[s])&&(r.push(t.call(f,f.__data__,s,o)),i.push(f));return new xt(r,i)}function ki(t){return function(){return this.matches(t)}}function Ni(t){return function(e){return e.matches(t)}}var Ao=Array.prototype.find;function So(t){return function(){return Ao.call(this.children,t)}}function To(){return this.firstElementChild}function Eo(t){return this.select(t==null?To:So(typeof t=="function"?t:Ni(t)))}var $o=Array.prototype.filter;function zo(){return Array.from(this.children)}function Io(t){return function(){return $o.call(this.children,t)}}function Co(t){return this.selectAll(t==null?zo:Io(typeof t=="function"?t:Ni(t)))}function Ro(t){typeof t!="function"&&(t=ki(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var a=e[i],o=a.length,u=r[i]=[],f,s=0;s<o;++s)(f=a[s])&&t.call(f,f.__data__,s,a)&&u.push(f);return new xt(r,this._parents)}function Mi(t){return new Array(t.length)}function Do(){return new xt(this._enter||this._groups.map(Mi),this._parents)}function Ue(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}Ue.prototype={constructor:Ue,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function Fo(t){return function(){return t}}function Po(t,e,n,r,i,a){for(var o=0,u,f=e.length,s=a.length;o<s;++o)(u=e[o])?(u.__data__=a[o],r[o]=u):n[o]=new Ue(t,a[o]);for(;o<f;++o)(u=e[o])&&(i[o]=u)}function Ho(t,e,n,r,i,a,o){var u,f,s=new Map,c=e.length,x=a.length,h=new Array(c),v;for(u=0;u<c;++u)(f=e[u])&&(h[u]=v=o.call(f,f.__data__,u,e)+"",s.has(v)?i[u]=f:s.set(v,f));for(u=0;u<x;++u)v=o.call(t,a[u],u,a)+"",(f=s.get(v))?(r[u]=f,f.__data__=a[u],s.delete(v)):n[u]=new Ue(t,a[u]);for(u=0;u<c;++u)(f=e[u])&&s.get(h[u])===f&&(i[u]=f)}function Lo(t){return t.__data__}function Xo(t,e){if(!arguments.length)return Array.from(this,Lo);var n=e?Ho:Po,r=this._parents,i=this._groups;typeof t!="function"&&(t=Fo(t));for(var a=i.length,o=new Array(a),u=new Array(a),f=new Array(a),s=0;s<a;++s){var c=r[s],x=i[s],h=x.length,v=Oo(t.call(c,c&&c.__data__,s,r)),w=v.length,d=u[s]=new Array(w),p=o[s]=new Array(w),g=f[s]=new Array(h);n(c,x,d,p,g,v,e);for(var b=0,E=0,m,_;b<w;++b)if(m=d[b]){for(b>=E&&(E=b+1);!(_=p[E])&&++E<w;);m._next=_||null}}return o=new xt(o,r),o._enter=u,o._exit=f,o}function Oo(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function Vo(){return new xt(this._exit||this._groups.map(Mi),this._parents)}function Bo(t,e,n){var r=this.enter(),i=this,a=this.exit();return typeof t=="function"?(r=t(r),r&&(r=r.selection())):r=r.append(t+""),e!=null&&(i=e(i),i&&(i=i.selection())),n==null?a.remove():n(a),r&&i?r.merge(i).order():i}function Yo(t){for(var e=t.selection?t.selection():t,n=this._groups,r=e._groups,i=n.length,a=r.length,o=Math.min(i,a),u=new Array(i),f=0;f<o;++f)for(var s=n[f],c=r[f],x=s.length,h=u[f]=new Array(x),v,w=0;w<x;++w)(v=s[w]||c[w])&&(h[w]=v);for(;f<i;++f)u[f]=n[f];return new xt(u,this._parents)}function qo(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r=t[e],i=r.length-1,a=r[i],o;--i>=0;)(o=r[i])&&(a&&o.compareDocumentPosition(a)^4&&a.parentNode.insertBefore(o,a),a=o);return this}function Wo(t){t||(t=Go);function e(x,h){return x&&h?t(x.__data__,h.__data__):!x-!h}for(var n=this._groups,r=n.length,i=new Array(r),a=0;a<r;++a){for(var o=n[a],u=o.length,f=i[a]=new Array(u),s,c=0;c<u;++c)(s=o[c])&&(f[c]=s);f.sort(e)}return new xt(i,this._parents).order()}function Go(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function Uo(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function Ko(){return Array.from(this)}function Zo(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,a=r.length;i<a;++i){var o=r[i];if(o)return o}return null}function Qo(){let t=0;for(const e of this)++t;return t}function Jo(){return!this.node()}function jo(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i=e[n],a=0,o=i.length,u;a<o;++a)(u=i[a])&&t.call(u,u.__data__,a,i);return this}function ts(t){return function(){this.removeAttribute(t)}}function es(t){return function(){this.removeAttributeNS(t.space,t.local)}}function ns(t,e){return function(){this.setAttribute(t,e)}}function rs(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function is(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function as(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function os(t,e){var n=nn(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((e==null?n.local?es:ts:typeof e=="function"?n.local?as:is:n.local?rs:ns)(n,e))}function Ai(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function ss(t){return function(){this.style.removeProperty(t)}}function us(t,e,n){return function(){this.style.setProperty(t,e,n)}}function ls(t,e,n){return function(){var r=e.apply(this,arguments);r==null?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function cs(t,e,n){return arguments.length>1?this.each((e==null?ss:typeof e=="function"?ls:us)(t,e,n??"")):le(this.node(),t)}function le(t,e){return t.style.getPropertyValue(e)||Ai(t).getComputedStyle(t,null).getPropertyValue(e)}function fs(t){return function(){delete this[t]}}function hs(t,e){return function(){this[t]=e}}function ds(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function ps(t,e){return arguments.length>1?this.each((e==null?fs:typeof e=="function"?ds:hs)(t,e)):this.node()[t]}function Si(t){return t.trim().split(/^|\s+/)}function Qn(t){return t.classList||new Ti(t)}function Ti(t){this._node=t,this._names=Si(t.getAttribute("class")||"")}Ti.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function Ei(t,e){for(var n=Qn(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function $i(t,e){for(var n=Qn(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function gs(t){return function(){Ei(this,t)}}function vs(t){return function(){$i(this,t)}}function ms(t,e){return function(){(e.apply(this,arguments)?Ei:$i)(this,t)}}function ys(t,e){var n=Si(t+"");if(arguments.length<2){for(var r=Qn(this.node()),i=-1,a=n.length;++i<a;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof e=="function"?ms:e?gs:vs)(n,e))}function xs(){this.textContent=""}function _s(t){return function(){this.textContent=t}}function ws(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function bs(t){return arguments.length?this.each(t==null?xs:(typeof t=="function"?ws:_s)(t)):this.node().textContent}function ks(){this.innerHTML=""}function Ns(t){return function(){this.innerHTML=t}}function Ms(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function As(t){return arguments.length?this.each(t==null?ks:(typeof t=="function"?Ms:Ns)(t)):this.node().innerHTML}function Ss(){this.nextSibling&&this.parentNode.appendChild(this)}function Ts(){return this.each(Ss)}function Es(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function $s(){return this.each(Es)}function zs(t){var e=typeof t=="function"?t:wi(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function Is(){return null}function Cs(t,e){var n=typeof t=="function"?t:wi(t),r=e==null?Is:typeof e=="function"?e:Zn(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function Rs(){var t=this.parentNode;t&&t.removeChild(this)}function Ds(){return this.each(Rs)}function Fs(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Ps(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Hs(t){return this.select(t?Ps:Fs)}function Ls(t){return arguments.length?this.property("__data__",t):this.node().__data__}function Xs(t){return function(e){t.call(this,e,this.__data__)}}function Os(t){return t.trim().split(/^|\s+/).map(function(e){var n="",r=e.indexOf(".");return r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),{type:e,name:n}})}function Vs(t){return function(){var e=this.__on;if(e){for(var n=0,r=-1,i=e.length,a;n<i;++n)a=e[n],(!t.type||a.type===t.type)&&a.name===t.name?this.removeEventListener(a.type,a.listener,a.options):e[++r]=a;++r?e.length=r:delete this.__on}}}function Bs(t,e,n){return function(){var r=this.__on,i,a=Xs(e);if(r){for(var o=0,u=r.length;o<u;++o)if((i=r[o]).type===t.type&&i.name===t.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=a,i.options=n),i.value=e;return}}this.addEventListener(t.type,a,n),i={type:t.type,name:t.name,value:e,listener:a,options:n},r?r.push(i):this.__on=[i]}}function Ys(t,e,n){var r=Os(t+""),i,a=r.length,o;if(arguments.length<2){var u=this.node().__on;if(u){for(var f=0,s=u.length,c;f<s;++f)for(i=0,c=u[f];i<a;++i)if((o=r[i]).type===c.type&&o.name===c.name)return c.value}return}for(u=e?Bs:Vs,i=0;i<a;++i)this.each(u(r[i],e,n));return this}function zi(t,e,n){var r=Ai(t),i=r.CustomEvent;typeof i=="function"?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function qs(t,e){return function(){return zi(this,t,e)}}function Ws(t,e){return function(){return zi(this,t,e.apply(this,arguments))}}function Gs(t,e){return this.each((typeof e=="function"?Ws:qs)(t,e))}function*Us(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,a=r.length,o;i<a;++i)(o=r[i])&&(yield o)}var Ii=[null];function xt(t,e){this._groups=t,this._parents=e}function Ee(){return new xt([[document.documentElement]],Ii)}function Ks(){return this}xt.prototype=Ee.prototype={constructor:xt,select:wo,selectAll:Mo,selectChild:Eo,selectChildren:Co,filter:Ro,data:Xo,enter:Do,exit:Vo,join:Bo,merge:Yo,selection:Ks,order:qo,sort:Wo,call:Uo,nodes:Ko,node:Zo,size:Qo,empty:Jo,each:jo,attr:os,style:cs,property:ps,classed:ys,text:bs,html:As,raise:Ts,lower:$s,append:zs,insert:Cs,remove:Ds,clone:Hs,datum:Ls,on:Ys,dispatch:Gs,[Symbol.iterator]:Us};function Nt(t){return typeof t=="string"?new xt([[document.querySelector(t)]],[document.documentElement]):new xt([[t]],Ii)}function Zs(t){let e;for(;e=t.sourceEvent;)t=e;return t}function Pt(t,e){if(t=Zs(t),e===void 0&&(e=t.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=t.clientX,r.y=t.clientY,r=r.matrixTransform(e.getScreenCTM().inverse()),[r.x,r.y]}if(e.getBoundingClientRect){var i=e.getBoundingClientRect();return[t.clientX-i.left-e.clientLeft,t.clientY-i.top-e.clientTop]}}return[t.pageX,t.pageY]}const Qs={passive:!1},be={capture:!0,passive:!1};function Rn(t){t.stopImmediatePropagation()}function se(t){t.preventDefault(),t.stopImmediatePropagation()}function Ci(t){var e=t.document.documentElement,n=Nt(t).on("dragstart.drag",se,be);"onselectstart"in e?n.on("selectstart.drag",se,be):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function Ri(t,e){var n=t.document.documentElement,r=Nt(t).on("dragstart.drag",null);e&&(r.on("click.drag",se,be),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const Le=t=>()=>t;function Vn(t,{sourceEvent:e,subject:n,target:r,identifier:i,active:a,x:o,y:u,dx:f,dy:s,dispatch:c}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:i,enumerable:!0,configurable:!0},active:{value:a,enumerable:!0,configurable:!0},x:{value:o,enumerable:!0,configurable:!0},y:{value:u,enumerable:!0,configurable:!0},dx:{value:f,enumerable:!0,configurable:!0},dy:{value:s,enumerable:!0,configurable:!0},_:{value:c}})}Vn.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};function Js(t){return!t.ctrlKey&&!t.button}function js(){return this.parentNode}function tu(t,e){return e??{x:t.x,y:t.y}}function eu(){return navigator.maxTouchPoints||"ontouchstart"in this}function nu(){var t=Js,e=js,n=tu,r=eu,i={},a=Te("start","drag","end"),o=0,u,f,s,c,x=0;function h(m){m.on("mousedown.drag",v).filter(r).on("touchstart.drag",p).on("touchmove.drag",g,Qs).on("touchend.drag touchcancel.drag",b).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function v(m,_){if(!(c||!t.call(this,m,_))){var k=E(this,e.call(this,m,_),m,_,"mouse");k&&(Nt(m.view).on("mousemove.drag",w,be).on("mouseup.drag",d,be),Ci(m.view),Rn(m),s=!1,u=m.clientX,f=m.clientY,k("start",m))}}function w(m){if(se(m),!s){var _=m.clientX-u,k=m.clientY-f;s=_*_+k*k>x}i.mouse("drag",m)}function d(m){Nt(m.view).on("mousemove.drag mouseup.drag",null),Ri(m.view,s),se(m),i.mouse("end",m)}function p(m,_){if(t.call(this,m,_)){var k=m.changedTouches,A=e.call(this,m,_),C=k.length,q,B;for(q=0;q<C;++q)(B=E(this,A,m,_,k[q].identifier,k[q]))&&(Rn(m),B("start",m,k[q]))}}function g(m){var _=m.changedTouches,k=_.length,A,C;for(A=0;A<k;++A)(C=i[_[A].identifier])&&(se(m),C("drag",m,_[A]))}function b(m){var _=m.changedTouches,k=_.length,A,C;for(c&&clearTimeout(c),c=setTimeout(function(){c=null},500),A=0;A<k;++A)(C=i[_[A].identifier])&&(Rn(m),C("end",m,_[A]))}function E(m,_,k,A,C,q){var B=a.copy(),G=Pt(q||k,_),K,et,y;if((y=n.call(m,new Vn("beforestart",{sourceEvent:k,target:h,identifier:C,active:o,x:G[0],y:G[1],dx:0,dy:0,dispatch:B}),A))!=null)return K=y.x-G[0]||0,et=y.y-G[1]||0,function $(N,R,L){var X=G,O;switch(N){case"start":i[C]=$,O=o++;break;case"end":delete i[C],--o;case"drag":G=Pt(L||R,_),O=o;break}B.call(N,m,new Vn(N,{sourceEvent:R,subject:y,target:h,identifier:C,active:O,x:G[0]+K,y:G[1]+et,dx:G[0]-X[0],dy:G[1]-X[1],dispatch:B}),A)}}return h.filter=function(m){return arguments.length?(t=typeof m=="function"?m:Le(!!m),h):t},h.container=function(m){return arguments.length?(e=typeof m=="function"?m:Le(m),h):e},h.subject=function(m){return arguments.length?(n=typeof m=="function"?m:Le(m),h):n},h.touchable=function(m){return arguments.length?(r=typeof m=="function"?m:Le(!!m),h):r},h.on=function(){var m=a.on.apply(a,arguments);return m===a?h:m},h.clickDistance=function(m){return arguments.length?(x=(m=+m)*m,h):Math.sqrt(x)},h}function Jn(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function Di(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function $e(){}var ke=.7,Ke=1/ke,ue="\\s*([+-]?\\d+)\\s*",Ne="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",zt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",ru=/^#([0-9a-f]{3,8})$/,iu=new RegExp(`^rgb\\(${ue},${ue},${ue}\\)$`),au=new RegExp(`^rgb\\(${zt},${zt},${zt}\\)$`),ou=new RegExp(`^rgba\\(${ue},${ue},${ue},${Ne}\\)$`),su=new RegExp(`^rgba\\(${zt},${zt},${zt},${Ne}\\)$`),uu=new RegExp(`^hsl\\(${Ne},${zt},${zt}\\)$`),lu=new RegExp(`^hsla\\(${Ne},${zt},${zt},${Ne}\\)$`),Or={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Jn($e,Me,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:Vr,formatHex:Vr,formatHex8:cu,formatHsl:fu,formatRgb:Br,toString:Br});function Vr(){return this.rgb().formatHex()}function cu(){return this.rgb().formatHex8()}function fu(){return Fi(this).formatHsl()}function Br(){return this.rgb().formatRgb()}function Me(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=ru.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?Yr(e):n===3?new vt(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?Xe(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?Xe(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=iu.exec(t))?new vt(e[1],e[2],e[3],1):(e=au.exec(t))?new vt(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=ou.exec(t))?Xe(e[1],e[2],e[3],e[4]):(e=su.exec(t))?Xe(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=uu.exec(t))?Gr(e[1],e[2]/100,e[3]/100,1):(e=lu.exec(t))?Gr(e[1],e[2]/100,e[3]/100,e[4]):Or.hasOwnProperty(t)?Yr(Or[t]):t==="transparent"?new vt(NaN,NaN,NaN,0):null}function Yr(t){return new vt(t>>16&255,t>>8&255,t&255,1)}function Xe(t,e,n,r){return r<=0&&(t=e=n=NaN),new vt(t,e,n,r)}function hu(t){return t instanceof $e||(t=Me(t)),t?(t=t.rgb(),new vt(t.r,t.g,t.b,t.opacity)):new vt}function Bn(t,e,n,r){return arguments.length===1?hu(t):new vt(t,e,n,r??1)}function vt(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}Jn(vt,Bn,Di($e,{brighter(t){return t=t==null?Ke:Math.pow(Ke,t),new vt(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?ke:Math.pow(ke,t),new vt(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new vt(Zt(this.r),Zt(this.g),Zt(this.b),Ze(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:qr,formatHex:qr,formatHex8:du,formatRgb:Wr,toString:Wr}));function qr(){return`#${Kt(this.r)}${Kt(this.g)}${Kt(this.b)}`}function du(){return`#${Kt(this.r)}${Kt(this.g)}${Kt(this.b)}${Kt((isNaN(this.opacity)?1:this.opacity)*255)}`}function Wr(){const t=Ze(this.opacity);return`${t===1?"rgb(":"rgba("}${Zt(this.r)}, ${Zt(this.g)}, ${Zt(this.b)}${t===1?")":`, ${t})`}`}function Ze(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Zt(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Kt(t){return t=Zt(t),(t<16?"0":"")+t.toString(16)}function Gr(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Mt(t,e,n,r)}function Fi(t){if(t instanceof Mt)return new Mt(t.h,t.s,t.l,t.opacity);if(t instanceof $e||(t=Me(t)),!t)return new Mt;if(t instanceof Mt)return t;t=t.rgb();var e=t.r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),a=Math.max(e,n,r),o=NaN,u=a-i,f=(a+i)/2;return u?(e===a?o=(n-r)/u+(n<r)*6:n===a?o=(r-e)/u+2:o=(e-n)/u+4,u/=f<.5?a+i:2-a-i,o*=60):u=f>0&&f<1?0:o,new Mt(o,u,f,t.opacity)}function pu(t,e,n,r){return arguments.length===1?Fi(t):new Mt(t,e,n,r??1)}function Mt(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}Jn(Mt,pu,Di($e,{brighter(t){return t=t==null?Ke:Math.pow(Ke,t),new Mt(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?ke:Math.pow(ke,t),new Mt(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new vt(Dn(t>=240?t-240:t+120,i,r),Dn(t,i,r),Dn(t<120?t+240:t-120,i,r),this.opacity)},clamp(){return new Mt(Ur(this.h),Oe(this.s),Oe(this.l),Ze(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Ze(this.opacity);return`${t===1?"hsl(":"hsla("}${Ur(this.h)}, ${Oe(this.s)*100}%, ${Oe(this.l)*100}%${t===1?")":`, ${t})`}`}}));function Ur(t){return t=(t||0)%360,t<0?t+360:t}function Oe(t){return Math.max(0,Math.min(1,t||0))}function Dn(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}const Pi=t=>()=>t;function gu(t,e){return function(n){return t+n*e}}function vu(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}function mu(t){return(t=+t)==1?Hi:function(e,n){return n-e?vu(e,n,t):Pi(isNaN(e)?n:e)}}function Hi(t,e){var n=e-t;return n?gu(t,n):Pi(isNaN(t)?e:t)}const Kr=(function t(e){var n=mu(e);function r(i,a){var o=n((i=Bn(i)).r,(a=Bn(a)).r),u=n(i.g,a.g),f=n(i.b,a.b),s=Hi(i.opacity,a.opacity);return function(c){return i.r=o(c),i.g=u(c),i.b=f(c),i.opacity=s(c),i+""}}return r.gamma=t,r})(1);function Vt(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}var Yn=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Fn=new RegExp(Yn.source,"g");function yu(t){return function(){return t}}function xu(t){return function(e){return t(e)+""}}function _u(t,e){var n=Yn.lastIndex=Fn.lastIndex=0,r,i,a,o=-1,u=[],f=[];for(t=t+"",e=e+"";(r=Yn.exec(t))&&(i=Fn.exec(e));)(a=i.index)>n&&(a=e.slice(n,a),u[o]?u[o]+=a:u[++o]=a),(r=r[0])===(i=i[0])?u[o]?u[o]+=i:u[++o]=i:(u[++o]=null,f.push({i:o,x:Vt(r,i)})),n=Fn.lastIndex;return n<e.length&&(a=e.slice(n),u[o]?u[o]+=a:u[++o]=a),u.length<2?f[0]?xu(f[0].x):yu(e):(e=f.length,function(s){for(var c=0,x;c<e;++c)u[(x=f[c]).i]=x.x(s);return u.join("")})}var Zr=180/Math.PI,qn={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Li(t,e,n,r,i,a){var o,u,f;return(o=Math.sqrt(t*t+e*e))&&(t/=o,e/=o),(f=t*n+e*r)&&(n-=t*f,r-=e*f),(u=Math.sqrt(n*n+r*r))&&(n/=u,r/=u,f/=u),t*r<e*n&&(t=-t,e=-e,f=-f,o=-o),{translateX:i,translateY:a,rotate:Math.atan2(e,t)*Zr,skewX:Math.atan(f)*Zr,scaleX:o,scaleY:u}}var Ve;function wu(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?qn:Li(e.a,e.b,e.c,e.d,e.e,e.f)}function bu(t){return t==null||(Ve||(Ve=document.createElementNS("http://www.w3.org/2000/svg","g")),Ve.setAttribute("transform",t),!(t=Ve.transform.baseVal.consolidate()))?qn:(t=t.matrix,Li(t.a,t.b,t.c,t.d,t.e,t.f))}function Xi(t,e,n,r){function i(s){return s.length?s.pop()+" ":""}function a(s,c,x,h,v,w){if(s!==x||c!==h){var d=v.push("translate(",null,e,null,n);w.push({i:d-4,x:Vt(s,x)},{i:d-2,x:Vt(c,h)})}else(x||h)&&v.push("translate("+x+e+h+n)}function o(s,c,x,h){s!==c?(s-c>180?c+=360:c-s>180&&(s+=360),h.push({i:x.push(i(x)+"rotate(",null,r)-2,x:Vt(s,c)})):c&&x.push(i(x)+"rotate("+c+r)}function u(s,c,x,h){s!==c?h.push({i:x.push(i(x)+"skewX(",null,r)-2,x:Vt(s,c)}):c&&x.push(i(x)+"skewX("+c+r)}function f(s,c,x,h,v,w){if(s!==x||c!==h){var d=v.push(i(v)+"scale(",null,",",null,")");w.push({i:d-4,x:Vt(s,x)},{i:d-2,x:Vt(c,h)})}else(x!==1||h!==1)&&v.push(i(v)+"scale("+x+","+h+")")}return function(s,c){var x=[],h=[];return s=t(s),c=t(c),a(s.translateX,s.translateY,c.translateX,c.translateY,x,h),o(s.rotate,c.rotate,x,h),u(s.skewX,c.skewX,x,h),f(s.scaleX,s.scaleY,c.scaleX,c.scaleY,x,h),s=c=null,function(v){for(var w=-1,d=h.length,p;++w<d;)x[(p=h[w]).i]=p.x(v);return x.join("")}}}var ku=Xi(wu,"px, ","px)","deg)"),Nu=Xi(bu,", ",")",")"),Mu=1e-12;function Qr(t){return((t=Math.exp(t))+1/t)/2}function Au(t){return((t=Math.exp(t))-1/t)/2}function Su(t){return((t=Math.exp(2*t))-1)/(t+1)}const Tu=(function t(e,n,r){function i(a,o){var u=a[0],f=a[1],s=a[2],c=o[0],x=o[1],h=o[2],v=c-u,w=x-f,d=v*v+w*w,p,g;if(d<Mu)g=Math.log(h/s)/e,p=function(A){return[u+A*v,f+A*w,s*Math.exp(e*A*g)]};else{var b=Math.sqrt(d),E=(h*h-s*s+r*d)/(2*s*n*b),m=(h*h-s*s-r*d)/(2*h*n*b),_=Math.log(Math.sqrt(E*E+1)-E),k=Math.log(Math.sqrt(m*m+1)-m);g=(k-_)/e,p=function(A){var C=A*g,q=Qr(_),B=s/(n*b)*(q*Su(e*C+_)-Au(_));return[u+B*v,f+B*w,s*q/Qr(e*C+_)]}}return p.duration=g*1e3*e/Math.SQRT2,p}return i.rho=function(a){var o=Math.max(.001,+a),u=o*o,f=u*u;return t(o,u,f)},i})(Math.SQRT2,2,4);var ce=0,_e=0,ye=0,Oi=1e3,Qe,we,Je=0,Jt=0,rn=0,Ae=typeof performance=="object"&&performance.now?performance:Date,Vi=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function jn(){return Jt||(Vi(Eu),Jt=Ae.now()+rn)}function Eu(){Jt=0}function je(){this._call=this._time=this._next=null}je.prototype=tr.prototype={constructor:je,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?jn():+n)+(e==null?0:+e),!this._next&&we!==this&&(we?we._next=this:Qe=this,we=this),this._call=t,this._time=n,Wn()},stop:function(){this._call&&(this._call=null,this._time=1/0,Wn())}};function tr(t,e,n){var r=new je;return r.restart(t,e,n),r}function $u(){jn(),++ce;for(var t=Qe,e;t;)(e=Jt-t._time)>=0&&t._call.call(void 0,e),t=t._next;--ce}function Jr(){Jt=(Je=Ae.now())+rn,ce=_e=0;try{$u()}finally{ce=0,Iu(),Jt=0}}function zu(){var t=Ae.now(),e=t-Je;e>Oi&&(rn-=e,Je=t)}function Iu(){for(var t,e=Qe,n,r=1/0;e;)e._call?(r>e._time&&(r=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:Qe=n);we=t,Wn(r)}function Wn(t){if(!ce){_e&&(_e=clearTimeout(_e));var e=t-Jt;e>24?(t<1/0&&(_e=setTimeout(Jr,t-Ae.now()-rn)),ye&&(ye=clearInterval(ye))):(ye||(Je=Ae.now(),ye=setInterval(zu,Oi)),ce=1,Vi(Jr))}}function jr(t,e,n){var r=new je;return e=e==null?0:+e,r.restart(i=>{r.stop(),t(i+e)},e,n),r}var Cu=Te("start","end","cancel","interrupt"),Ru=[],Bi=0,ti=1,Gn=2,qe=3,ei=4,Un=5,We=6;function an(t,e,n,r,i,a){var o=t.__transition;if(!o)t.__transition={};else if(n in o)return;Du(t,n,{name:e,index:r,group:i,on:Cu,tween:Ru,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:Bi})}function er(t,e){var n=At(t,e);if(n.state>Bi)throw new Error("too late; already scheduled");return n}function It(t,e){var n=At(t,e);if(n.state>qe)throw new Error("too late; already running");return n}function At(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function Du(t,e,n){var r=t.__transition,i;r[e]=n,n.timer=tr(a,0,n.time);function a(s){n.state=ti,n.timer.restart(o,n.delay,n.time),n.delay<=s&&o(s-n.delay)}function o(s){var c,x,h,v;if(n.state!==ti)return f();for(c in r)if(v=r[c],v.name===n.name){if(v.state===qe)return jr(o);v.state===ei?(v.state=We,v.timer.stop(),v.on.call("interrupt",t,t.__data__,v.index,v.group),delete r[c]):+c<e&&(v.state=We,v.timer.stop(),v.on.call("cancel",t,t.__data__,v.index,v.group),delete r[c])}if(jr(function(){n.state===qe&&(n.state=ei,n.timer.restart(u,n.delay,n.time),u(s))}),n.state=Gn,n.on.call("start",t,t.__data__,n.index,n.group),n.state===Gn){for(n.state=qe,i=new Array(h=n.tween.length),c=0,x=-1;c<h;++c)(v=n.tween[c].value.call(t,t.__data__,n.index,n.group))&&(i[++x]=v);i.length=x+1}}function u(s){for(var c=s<n.duration?n.ease.call(null,s/n.duration):(n.timer.restart(f),n.state=Un,1),x=-1,h=i.length;++x<h;)i[x].call(t,c);n.state===Un&&(n.on.call("end",t,t.__data__,n.index,n.group),f())}function f(){n.state=We,n.timer.stop(),delete r[e];for(var s in r)return;delete t.__transition}}function Ge(t,e){var n=t.__transition,r,i,a=!0,o;if(n){e=e==null?null:e+"";for(o in n){if((r=n[o]).name!==e){a=!1;continue}i=r.state>Gn&&r.state<Un,r.state=We,r.timer.stop(),r.on.call(i?"interrupt":"cancel",t,t.__data__,r.index,r.group),delete n[o]}a&&delete t.__transition}}function Fu(t){return this.each(function(){Ge(this,t)})}function Pu(t,e){var n,r;return function(){var i=It(this,t),a=i.tween;if(a!==n){r=n=a;for(var o=0,u=r.length;o<u;++o)if(r[o].name===e){r=r.slice(),r.splice(o,1);break}}i.tween=r}}function Hu(t,e,n){var r,i;if(typeof n!="function")throw new Error;return function(){var a=It(this,t),o=a.tween;if(o!==r){i=(r=o).slice();for(var u={name:e,value:n},f=0,s=i.length;f<s;++f)if(i[f].name===e){i[f]=u;break}f===s&&i.push(u)}a.tween=i}}function Lu(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r=At(this.node(),n).tween,i=0,a=r.length,o;i<a;++i)if((o=r[i]).name===t)return o.value;return null}return this.each((e==null?Pu:Hu)(n,t,e))}function nr(t,e,n){var r=t._id;return t.each(function(){var i=It(this,r);(i.value||(i.value={}))[e]=n.apply(this,arguments)}),function(i){return At(i,r).value[e]}}function Yi(t,e){var n;return(typeof e=="number"?Vt:e instanceof Me?Kr:(n=Me(e))?(e=n,Kr):_u)(t,e)}function Xu(t){return function(){this.removeAttribute(t)}}function Ou(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Vu(t,e,n){var r,i=n+"",a;return function(){var o=this.getAttribute(t);return o===i?null:o===r?a:a=e(r=o,n)}}function Bu(t,e,n){var r,i=n+"",a;return function(){var o=this.getAttributeNS(t.space,t.local);return o===i?null:o===r?a:a=e(r=o,n)}}function Yu(t,e,n){var r,i,a;return function(){var o,u=n(this),f;return u==null?void this.removeAttribute(t):(o=this.getAttribute(t),f=u+"",o===f?null:o===r&&f===i?a:(i=f,a=e(r=o,u)))}}function qu(t,e,n){var r,i,a;return function(){var o,u=n(this),f;return u==null?void this.removeAttributeNS(t.space,t.local):(o=this.getAttributeNS(t.space,t.local),f=u+"",o===f?null:o===r&&f===i?a:(i=f,a=e(r=o,u)))}}function Wu(t,e){var n=nn(t),r=n==="transform"?Nu:Yi;return this.attrTween(t,typeof e=="function"?(n.local?qu:Yu)(n,r,nr(this,"attr."+t,e)):e==null?(n.local?Ou:Xu)(n):(n.local?Bu:Vu)(n,r,e))}function Gu(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function Uu(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function Ku(t,e){var n,r;function i(){var a=e.apply(this,arguments);return a!==r&&(n=(r=a)&&Uu(t,a)),n}return i._value=e,i}function Zu(t,e){var n,r;function i(){var a=e.apply(this,arguments);return a!==r&&(n=(r=a)&&Gu(t,a)),n}return i._value=e,i}function Qu(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var r=nn(t);return this.tween(n,(r.local?Ku:Zu)(r,e))}function Ju(t,e){return function(){er(this,t).delay=+e.apply(this,arguments)}}function ju(t,e){return e=+e,function(){er(this,t).delay=e}}function tl(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?Ju:ju)(e,t)):At(this.node(),e).delay}function el(t,e){return function(){It(this,t).duration=+e.apply(this,arguments)}}function nl(t,e){return e=+e,function(){It(this,t).duration=e}}function rl(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?el:nl)(e,t)):At(this.node(),e).duration}function il(t,e){if(typeof e!="function")throw new Error;return function(){It(this,t).ease=e}}function al(t){var e=this._id;return arguments.length?this.each(il(e,t)):At(this.node(),e).ease}function ol(t,e){return function(){var n=e.apply(this,arguments);if(typeof n!="function")throw new Error;It(this,t).ease=n}}function sl(t){if(typeof t!="function")throw new Error;return this.each(ol(this._id,t))}function ul(t){typeof t!="function"&&(t=ki(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var a=e[i],o=a.length,u=r[i]=[],f,s=0;s<o;++s)(f=a[s])&&t.call(f,f.__data__,s,a)&&u.push(f);return new Lt(r,this._parents,this._name,this._id)}function ll(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,i=n.length,a=Math.min(r,i),o=new Array(r),u=0;u<a;++u)for(var f=e[u],s=n[u],c=f.length,x=o[u]=new Array(c),h,v=0;v<c;++v)(h=f[v]||s[v])&&(x[v]=h);for(;u<r;++u)o[u]=e[u];return new Lt(o,this._parents,this._name,this._id)}function cl(t){return(t+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function fl(t,e,n){var r,i,a=cl(e)?er:It;return function(){var o=a(this,t),u=o.on;u!==r&&(i=(r=u).copy()).on(e,n),o.on=i}}function hl(t,e){var n=this._id;return arguments.length<2?At(this.node(),n).on.on(t):this.each(fl(n,t,e))}function dl(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function pl(){return this.on("end.remove",dl(this._id))}function gl(t){var e=this._name,n=this._id;typeof t!="function"&&(t=Zn(t));for(var r=this._groups,i=r.length,a=new Array(i),o=0;o<i;++o)for(var u=r[o],f=u.length,s=a[o]=new Array(f),c,x,h=0;h<f;++h)(c=u[h])&&(x=t.call(c,c.__data__,h,u))&&("__data__"in c&&(x.__data__=c.__data__),s[h]=x,an(s[h],e,n,h,s,At(c,n)));return new Lt(a,this._parents,e,n)}function vl(t){var e=this._name,n=this._id;typeof t!="function"&&(t=bi(t));for(var r=this._groups,i=r.length,a=[],o=[],u=0;u<i;++u)for(var f=r[u],s=f.length,c,x=0;x<s;++x)if(c=f[x]){for(var h=t.call(c,c.__data__,x,f),v,w=At(c,n),d=0,p=h.length;d<p;++d)(v=h[d])&&an(v,e,n,d,h,w);a.push(h),o.push(c)}return new Lt(a,o,e,n)}var ml=Ee.prototype.constructor;function yl(){return new ml(this._groups,this._parents)}function xl(t,e){var n,r,i;return function(){var a=le(this,t),o=(this.style.removeProperty(t),le(this,t));return a===o?null:a===n&&o===r?i:i=e(n=a,r=o)}}function qi(t){return function(){this.style.removeProperty(t)}}function _l(t,e,n){var r,i=n+"",a;return function(){var o=le(this,t);return o===i?null:o===r?a:a=e(r=o,n)}}function wl(t,e,n){var r,i,a;return function(){var o=le(this,t),u=n(this),f=u+"";return u==null&&(f=u=(this.style.removeProperty(t),le(this,t))),o===f?null:o===r&&f===i?a:(i=f,a=e(r=o,u))}}function bl(t,e){var n,r,i,a="style."+e,o="end."+a,u;return function(){var f=It(this,t),s=f.on,c=f.value[a]==null?u||(u=qi(e)):void 0;(s!==n||i!==c)&&(r=(n=s).copy()).on(o,i=c),f.on=r}}function kl(t,e,n){var r=(t+="")=="transform"?ku:Yi;return e==null?this.styleTween(t,xl(t,r)).on("end.style."+t,qi(t)):typeof e=="function"?this.styleTween(t,wl(t,r,nr(this,"style."+t,e))).each(bl(this._id,t)):this.styleTween(t,_l(t,r,e),n).on("end.style."+t,null)}function Nl(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}function Ml(t,e,n){var r,i;function a(){var o=e.apply(this,arguments);return o!==i&&(r=(i=o)&&Nl(t,o,n)),r}return a._value=e,a}function Al(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(e==null)return this.tween(r,null);if(typeof e!="function")throw new Error;return this.tween(r,Ml(t,e,n??""))}function Sl(t){return function(){this.textContent=t}}function Tl(t){return function(){var e=t(this);this.textContent=e??""}}function El(t){return this.tween("text",typeof t=="function"?Tl(nr(this,"text",t)):Sl(t==null?"":t+""))}function $l(t){return function(e){this.textContent=t.call(this,e)}}function zl(t){var e,n;function r(){var i=t.apply(this,arguments);return i!==n&&(e=(n=i)&&$l(i)),e}return r._value=t,r}function Il(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,zl(t))}function Cl(){for(var t=this._name,e=this._id,n=Wi(),r=this._groups,i=r.length,a=0;a<i;++a)for(var o=r[a],u=o.length,f,s=0;s<u;++s)if(f=o[s]){var c=At(f,e);an(f,t,n,s,o,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new Lt(r,this._parents,t,n)}function Rl(){var t,e,n=this,r=n._id,i=n.size();return new Promise(function(a,o){var u={value:o},f={value:function(){--i===0&&a()}};n.each(function(){var s=It(this,r),c=s.on;c!==t&&(e=(t=c).copy(),e._.cancel.push(u),e._.interrupt.push(u),e._.end.push(f)),s.on=e}),i===0&&a()})}var Dl=0;function Lt(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function Wi(){return++Dl}var Ft=Ee.prototype;Lt.prototype={constructor:Lt,select:gl,selectAll:vl,selectChild:Ft.selectChild,selectChildren:Ft.selectChildren,filter:ul,merge:ll,selection:yl,transition:Cl,call:Ft.call,nodes:Ft.nodes,node:Ft.node,size:Ft.size,empty:Ft.empty,each:Ft.each,on:hl,attr:Wu,attrTween:Qu,style:kl,styleTween:Al,text:El,textTween:Il,remove:pl,tween:Lu,delay:tl,duration:rl,ease:al,easeVarying:sl,end:Rl,[Symbol.iterator]:Ft[Symbol.iterator]};function Fl(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var Pl={time:null,delay:0,duration:250,ease:Fl};function Hl(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}function Ll(t){var e,n;t instanceof Lt?(e=t._id,t=t._name):(e=Wi(),(n=Pl).time=jn(),t=t==null?null:t+"");for(var r=this._groups,i=r.length,a=0;a<i;++a)for(var o=r[a],u=o.length,f,s=0;s<u;++s)(f=o[s])&&an(f,t,e,s,o,n||Hl(f,e));return new Lt(r,this._parents,t,e)}Ee.prototype.interrupt=Fu;Ee.prototype.transition=Ll;function ni(t,e){var n,r=1;t==null&&(t=0),e==null&&(e=0);function i(){var a,o=n.length,u,f=0,s=0;for(a=0;a<o;++a)u=n[a],f+=u.x,s+=u.y;for(f=(f/o-t)*r,s=(s/o-e)*r,a=0;a<o;++a)u=n[a],u.x-=f,u.y-=s}return i.initialize=function(a){n=a},i.x=function(a){return arguments.length?(t=+a,i):t},i.y=function(a){return arguments.length?(e=+a,i):e},i.strength=function(a){return arguments.length?(r=+a,i):r},i}function Xl(t){const e=+this._x.call(null,t),n=+this._y.call(null,t);return Gi(this.cover(e,n),e,n,t)}function Gi(t,e,n,r){if(isNaN(e)||isNaN(n))return t;var i,a=t._root,o={data:r},u=t._x0,f=t._y0,s=t._x1,c=t._y1,x,h,v,w,d,p,g,b;if(!a)return t._root=o,t;for(;a.length;)if((d=e>=(x=(u+s)/2))?u=x:s=x,(p=n>=(h=(f+c)/2))?f=h:c=h,i=a,!(a=a[g=p<<1|d]))return i[g]=o,t;if(v=+t._x.call(null,a.data),w=+t._y.call(null,a.data),e===v&&n===w)return o.next=a,i?i[g]=o:t._root=o,t;do i=i?i[g]=new Array(4):t._root=new Array(4),(d=e>=(x=(u+s)/2))?u=x:s=x,(p=n>=(h=(f+c)/2))?f=h:c=h;while((g=p<<1|d)===(b=(w>=h)<<1|v>=x));return i[b]=a,i[g]=o,t}function Ol(t){var e,n,r=t.length,i,a,o=new Array(r),u=new Array(r),f=1/0,s=1/0,c=-1/0,x=-1/0;for(n=0;n<r;++n)isNaN(i=+this._x.call(null,e=t[n]))||isNaN(a=+this._y.call(null,e))||(o[n]=i,u[n]=a,i<f&&(f=i),i>c&&(c=i),a<s&&(s=a),a>x&&(x=a));if(f>c||s>x)return this;for(this.cover(f,s).cover(c,x),n=0;n<r;++n)Gi(this,o[n],u[n],t[n]);return this}function Vl(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var n=this._x0,r=this._y0,i=this._x1,a=this._y1;if(isNaN(n))i=(n=Math.floor(t))+1,a=(r=Math.floor(e))+1;else{for(var o=i-n||1,u=this._root,f,s;n>t||t>=i||r>e||e>=a;)switch(s=(e<r)<<1|t<n,f=new Array(4),f[s]=u,u=f,o*=2,s){case 0:i=n+o,a=r+o;break;case 1:n=i-o,a=r+o;break;case 2:i=n+o,r=a-o;break;case 3:n=i-o,r=a-o;break}this._root&&this._root.length&&(this._root=u)}return this._x0=n,this._y0=r,this._x1=i,this._y1=a,this}function Bl(){var t=[];return this.visit(function(e){if(!e.length)do t.push(e.data);while(e=e.next)}),t}function Yl(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function pt(t,e,n,r,i){this.node=t,this.x0=e,this.y0=n,this.x1=r,this.y1=i}function ql(t,e,n){var r,i=this._x0,a=this._y0,o,u,f,s,c=this._x1,x=this._y1,h=[],v=this._root,w,d;for(v&&h.push(new pt(v,i,a,c,x)),n==null?n=1/0:(i=t-n,a=e-n,c=t+n,x=e+n,n*=n);w=h.pop();)if(!(!(v=w.node)||(o=w.x0)>c||(u=w.y0)>x||(f=w.x1)<i||(s=w.y1)<a))if(v.length){var p=(o+f)/2,g=(u+s)/2;h.push(new pt(v[3],p,g,f,s),new pt(v[2],o,g,p,s),new pt(v[1],p,u,f,g),new pt(v[0],o,u,p,g)),(d=(e>=g)<<1|t>=p)&&(w=h[h.length-1],h[h.length-1]=h[h.length-1-d],h[h.length-1-d]=w)}else{var b=t-+this._x.call(null,v.data),E=e-+this._y.call(null,v.data),m=b*b+E*E;if(m<n){var _=Math.sqrt(n=m);i=t-_,a=e-_,c=t+_,x=e+_,r=v.data}}return r}function Wl(t){if(isNaN(c=+this._x.call(null,t))||isNaN(x=+this._y.call(null,t)))return this;var e,n=this._root,r,i,a,o=this._x0,u=this._y0,f=this._x1,s=this._y1,c,x,h,v,w,d,p,g;if(!n)return this;if(n.length)for(;;){if((w=c>=(h=(o+f)/2))?o=h:f=h,(d=x>=(v=(u+s)/2))?u=v:s=v,e=n,!(n=n[p=d<<1|w]))return this;if(!n.length)break;(e[p+1&3]||e[p+2&3]||e[p+3&3])&&(r=e,g=p)}for(;n.data!==t;)if(i=n,!(n=n.next))return this;return(a=n.next)&&delete n.next,i?(a?i.next=a:delete i.next,this):e?(a?e[p]=a:delete e[p],(n=e[0]||e[1]||e[2]||e[3])&&n===(e[3]||e[2]||e[1]||e[0])&&!n.length&&(r?r[g]=n:this._root=n),this):(this._root=a,this)}function Gl(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this}function Ul(){return this._root}function Kl(){var t=0;return this.visit(function(e){if(!e.length)do++t;while(e=e.next)}),t}function Zl(t){var e=[],n,r=this._root,i,a,o,u,f;for(r&&e.push(new pt(r,this._x0,this._y0,this._x1,this._y1));n=e.pop();)if(!t(r=n.node,a=n.x0,o=n.y0,u=n.x1,f=n.y1)&&r.length){var s=(a+u)/2,c=(o+f)/2;(i=r[3])&&e.push(new pt(i,s,c,u,f)),(i=r[2])&&e.push(new pt(i,a,c,s,f)),(i=r[1])&&e.push(new pt(i,s,o,u,c)),(i=r[0])&&e.push(new pt(i,a,o,s,c))}return this}function Ql(t){var e=[],n=[],r;for(this._root&&e.push(new pt(this._root,this._x0,this._y0,this._x1,this._y1));r=e.pop();){var i=r.node;if(i.length){var a,o=r.x0,u=r.y0,f=r.x1,s=r.y1,c=(o+f)/2,x=(u+s)/2;(a=i[0])&&e.push(new pt(a,o,u,c,x)),(a=i[1])&&e.push(new pt(a,c,u,f,x)),(a=i[2])&&e.push(new pt(a,o,x,c,s)),(a=i[3])&&e.push(new pt(a,c,x,f,s))}n.push(r)}for(;r=n.pop();)t(r.node,r.x0,r.y0,r.x1,r.y1);return this}function Jl(t){return t[0]}function jl(t){return arguments.length?(this._x=t,this):this._x}function tc(t){return t[1]}function ec(t){return arguments.length?(this._y=t,this):this._y}function rr(t,e,n){var r=new ir(e??Jl,n??tc,NaN,NaN,NaN,NaN);return t==null?r:r.addAll(t)}function ir(t,e,n,r,i,a){this._x=t,this._y=e,this._x0=n,this._y0=r,this._x1=i,this._y1=a,this._root=void 0}function ri(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}var gt=rr.prototype=ir.prototype;gt.copy=function(){var t=new ir(this._x,this._y,this._x0,this._y0,this._x1,this._y1),e=this._root,n,r;if(!e)return t;if(!e.length)return t._root=ri(e),t;for(n=[{source:e,target:t._root=new Array(4)}];e=n.pop();)for(var i=0;i<4;++i)(r=e.source[i])&&(r.length?n.push({source:r,target:e.target[i]=new Array(4)}):e.target[i]=ri(r));return t};gt.add=Xl;gt.addAll=Ol;gt.cover=Vl;gt.data=Bl;gt.extent=Yl;gt.find=ql;gt.remove=Wl;gt.removeAll=Gl;gt.root=Ul;gt.size=Kl;gt.visit=Zl;gt.visitAfter=Ql;gt.x=jl;gt.y=ec;function Qt(t){return function(){return t}}function Bt(t){return(t()-.5)*1e-6}function nc(t){return t.x+t.vx}function rc(t){return t.y+t.vy}function ic(t){var e,n,r,i=1,a=1;typeof t!="function"&&(t=Qt(t==null?1:+t));function o(){for(var s,c=e.length,x,h,v,w,d,p,g=0;g<a;++g)for(x=rr(e,nc,rc).visitAfter(u),s=0;s<c;++s)h=e[s],d=n[h.index],p=d*d,v=h.x+h.vx,w=h.y+h.vy,x.visit(b);function b(E,m,_,k,A){var C=E.data,q=E.r,B=d+q;if(C){if(C.index>h.index){var G=v-C.x-C.vx,K=w-C.y-C.vy,et=G*G+K*K;et<B*B&&(G===0&&(G=Bt(r),et+=G*G),K===0&&(K=Bt(r),et+=K*K),et=(B-(et=Math.sqrt(et)))/et*i,h.vx+=(G*=et)*(B=(q*=q)/(p+q)),h.vy+=(K*=et)*B,C.vx-=G*(B=1-B),C.vy-=K*B)}return}return m>v+B||k<v-B||_>w+B||A<w-B}}function u(s){if(s.data)return s.r=n[s.data.index];for(var c=s.r=0;c<4;++c)s[c]&&s[c].r>s.r&&(s.r=s[c].r)}function f(){if(e){var s,c=e.length,x;for(n=new Array(c),s=0;s<c;++s)x=e[s],n[x.index]=+t(x,s,e)}}return o.initialize=function(s,c){e=s,r=c,f()},o.iterations=function(s){return arguments.length?(a=+s,o):a},o.strength=function(s){return arguments.length?(i=+s,o):i},o.radius=function(s){return arguments.length?(t=typeof s=="function"?s:Qt(+s),f(),o):t},o}function ac(t){return t.index}function ii(t,e){var n=t.get(e);if(!n)throw new Error("node not found: "+e);return n}function oc(t){var e=ac,n=x,r,i=Qt(30),a,o,u,f,s,c=1;t==null&&(t=[]);function x(p){return 1/Math.min(u[p.source.index],u[p.target.index])}function h(p){for(var g=0,b=t.length;g<c;++g)for(var E=0,m,_,k,A,C,q,B;E<b;++E)m=t[E],_=m.source,k=m.target,A=k.x+k.vx-_.x-_.vx||Bt(s),C=k.y+k.vy-_.y-_.vy||Bt(s),q=Math.sqrt(A*A+C*C),q=(q-a[E])/q*p*r[E],A*=q,C*=q,k.vx-=A*(B=f[E]),k.vy-=C*B,_.vx+=A*(B=1-B),_.vy+=C*B}function v(){if(o){var p,g=o.length,b=t.length,E=new Map(o.map((_,k)=>[e(_,k,o),_])),m;for(p=0,u=new Array(g);p<b;++p)m=t[p],m.index=p,typeof m.source!="object"&&(m.source=ii(E,m.source)),typeof m.target!="object"&&(m.target=ii(E,m.target)),u[m.source.index]=(u[m.source.index]||0)+1,u[m.target.index]=(u[m.target.index]||0)+1;for(p=0,f=new Array(b);p<b;++p)m=t[p],f[p]=u[m.source.index]/(u[m.source.index]+u[m.target.index]);r=new Array(b),w(),a=new Array(b),d()}}function w(){if(o)for(var p=0,g=t.length;p<g;++p)r[p]=+n(t[p],p,t)}function d(){if(o)for(var p=0,g=t.length;p<g;++p)a[p]=+i(t[p],p,t)}return h.initialize=function(p,g){o=p,s=g,v()},h.links=function(p){return arguments.length?(t=p,v(),h):t},h.id=function(p){return arguments.length?(e=p,h):e},h.iterations=function(p){return arguments.length?(c=+p,h):c},h.strength=function(p){return arguments.length?(n=typeof p=="function"?p:Qt(+p),w(),h):n},h.distance=function(p){return arguments.length?(i=typeof p=="function"?p:Qt(+p),d(),h):i},h}const sc=1664525,uc=1013904223,ai=4294967296;function lc(){let t=1;return()=>(t=(sc*t+uc)%ai)/ai}function cc(t){return t.x}function fc(t){return t.y}var hc=10,dc=Math.PI*(3-Math.sqrt(5));function pc(t){var e,n=1,r=.001,i=1-Math.pow(r,1/300),a=0,o=.6,u=new Map,f=tr(x),s=Te("tick","end"),c=lc();t==null&&(t=[]);function x(){h(),s.call("tick",e),n<r&&(f.stop(),s.call("end",e))}function h(d){var p,g=t.length,b;d===void 0&&(d=1);for(var E=0;E<d;++E)for(n+=(a-n)*i,u.forEach(function(m){m(n)}),p=0;p<g;++p)b=t[p],b.fx==null?b.x+=b.vx*=o:(b.x=b.fx,b.vx=0),b.fy==null?b.y+=b.vy*=o:(b.y=b.fy,b.vy=0);return e}function v(){for(var d=0,p=t.length,g;d<p;++d){if(g=t[d],g.index=d,g.fx!=null&&(g.x=g.fx),g.fy!=null&&(g.y=g.fy),isNaN(g.x)||isNaN(g.y)){var b=hc*Math.sqrt(.5+d),E=d*dc;g.x=b*Math.cos(E),g.y=b*Math.sin(E)}(isNaN(g.vx)||isNaN(g.vy))&&(g.vx=g.vy=0)}}function w(d){return d.initialize&&d.initialize(t,c),d}return v(),e={tick:h,restart:function(){return f.restart(x),e},stop:function(){return f.stop(),e},nodes:function(d){return arguments.length?(t=d,v(),u.forEach(w),e):t},alpha:function(d){return arguments.length?(n=+d,e):n},alphaMin:function(d){return arguments.length?(r=+d,e):r},alphaDecay:function(d){return arguments.length?(i=+d,e):+i},alphaTarget:function(d){return arguments.length?(a=+d,e):a},velocityDecay:function(d){return arguments.length?(o=1-d,e):1-o},randomSource:function(d){return arguments.length?(c=d,u.forEach(w),e):c},force:function(d,p){return arguments.length>1?(p==null?u.delete(d):u.set(d,w(p)),e):u.get(d)},find:function(d,p,g){var b=0,E=t.length,m,_,k,A,C;for(g==null?g=1/0:g*=g,b=0;b<E;++b)A=t[b],m=d-A.x,_=p-A.y,k=m*m+_*_,k<g&&(C=A,g=k);return C},on:function(d,p){return arguments.length>1?(s.on(d,p),e):s.on(d)}}}function gc(){var t,e,n,r,i=Qt(-30),a,o=1,u=1/0,f=.81;function s(v){var w,d=t.length,p=rr(t,cc,fc).visitAfter(x);for(r=v,w=0;w<d;++w)e=t[w],p.visit(h)}function c(){if(t){var v,w=t.length,d;for(a=new Array(w),v=0;v<w;++v)d=t[v],a[d.index]=+i(d,v,t)}}function x(v){var w=0,d,p,g=0,b,E,m;if(v.length){for(b=E=m=0;m<4;++m)(d=v[m])&&(p=Math.abs(d.value))&&(w+=d.value,g+=p,b+=p*d.x,E+=p*d.y);v.x=b/g,v.y=E/g}else{d=v,d.x=d.data.x,d.y=d.data.y;do w+=a[d.data.index];while(d=d.next)}v.value=w}function h(v,w,d,p){if(!v.value)return!0;var g=v.x-e.x,b=v.y-e.y,E=p-w,m=g*g+b*b;if(E*E/f<m)return m<u&&(g===0&&(g=Bt(n),m+=g*g),b===0&&(b=Bt(n),m+=b*b),m<o&&(m=Math.sqrt(o*m)),e.vx+=g*v.value*r/m,e.vy+=b*v.value*r/m),!0;if(v.length||m>=u)return;(v.data!==e||v.next)&&(g===0&&(g=Bt(n),m+=g*g),b===0&&(b=Bt(n),m+=b*b),m<o&&(m=Math.sqrt(o*m)));do v.data!==e&&(E=a[v.data.index]*r/m,e.vx+=g*E,e.vy+=b*E);while(v=v.next)}return s.initialize=function(v,w){t=v,n=w,c()},s.strength=function(v){return arguments.length?(i=typeof v=="function"?v:Qt(+v),c(),s):i},s.distanceMin=function(v){return arguments.length?(o=v*v,s):Math.sqrt(o)},s.distanceMax=function(v){return arguments.length?(u=v*v,s):Math.sqrt(u)},s.theta=function(v){return arguments.length?(f=v*v,s):Math.sqrt(f)},s}function vc(t){for(var e=t.length/6|0,n=new Array(e),r=0;r<e;)n[r]="#"+t.slice(r*6,++r*6);return n}const mc=vc("4e79a7f28e2ce1575976b7b259a14fedc949af7aa1ff9da79c755fbab0ab"),Be=t=>()=>t;function yc(t,{sourceEvent:e,target:n,transform:r,dispatch:i}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:i}})}function Ht(t,e,n){this.k=t,this.x=e,this.y=n}Ht.prototype={constructor:Ht,scale:function(t){return t===1?this:new Ht(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new Ht(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var ar=new Ht(1,0,0);Ht.prototype;function Pn(t){t.stopImmediatePropagation()}function xe(t){t.preventDefault(),t.stopImmediatePropagation()}function xc(t){return(!t.ctrlKey||t.type==="wheel")&&!t.button}function _c(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t,t.hasAttribute("viewBox")?(t=t.viewBox.baseVal,[[t.x,t.y],[t.x+t.width,t.y+t.height]]):[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]):[[0,0],[t.clientWidth,t.clientHeight]]}function oi(){return this.__zoom||ar}function wc(t){return-t.deltaY*(t.deltaMode===1?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function bc(){return navigator.maxTouchPoints||"ontouchstart"in this}function kc(t,e,n){var r=t.invertX(e[0][0])-n[0][0],i=t.invertX(e[1][0])-n[1][0],a=t.invertY(e[0][1])-n[0][1],o=t.invertY(e[1][1])-n[1][1];return t.translate(i>r?(r+i)/2:Math.min(0,r)||Math.max(0,i),o>a?(a+o)/2:Math.min(0,a)||Math.max(0,o))}function Nc(){var t=xc,e=_c,n=kc,r=wc,i=bc,a=[0,1/0],o=[[-1/0,-1/0],[1/0,1/0]],u=250,f=Tu,s=Te("start","zoom","end"),c,x,h,v=500,w=150,d=0,p=10;function g(y){y.property("__zoom",oi).on("wheel.zoom",C,{passive:!1}).on("mousedown.zoom",q).on("dblclick.zoom",B).filter(i).on("touchstart.zoom",G).on("touchmove.zoom",K).on("touchend.zoom touchcancel.zoom",et).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}g.transform=function(y,$,N,R){var L=y.selection?y.selection():y;L.property("__zoom",oi),y!==L?_(y,$,N,R):L.interrupt().each(function(){k(this,arguments).event(R).start().zoom(null,typeof $=="function"?$.apply(this,arguments):$).end()})},g.scaleBy=function(y,$,N,R){g.scaleTo(y,function(){var L=this.__zoom.k,X=typeof $=="function"?$.apply(this,arguments):$;return L*X},N,R)},g.scaleTo=function(y,$,N,R){g.transform(y,function(){var L=e.apply(this,arguments),X=this.__zoom,O=N==null?m(L):typeof N=="function"?N.apply(this,arguments):N,Z=X.invert(O),Q=typeof $=="function"?$.apply(this,arguments):$;return n(E(b(X,Q),O,Z),L,o)},N,R)},g.translateBy=function(y,$,N,R){g.transform(y,function(){return n(this.__zoom.translate(typeof $=="function"?$.apply(this,arguments):$,typeof N=="function"?N.apply(this,arguments):N),e.apply(this,arguments),o)},null,R)},g.translateTo=function(y,$,N,R,L){g.transform(y,function(){var X=e.apply(this,arguments),O=this.__zoom,Z=R==null?m(X):typeof R=="function"?R.apply(this,arguments):R;return n(ar.translate(Z[0],Z[1]).scale(O.k).translate(typeof $=="function"?-$.apply(this,arguments):-$,typeof N=="function"?-N.apply(this,arguments):-N),X,o)},R,L)};function b(y,$){return $=Math.max(a[0],Math.min(a[1],$)),$===y.k?y:new Ht($,y.x,y.y)}function E(y,$,N){var R=$[0]-N[0]*y.k,L=$[1]-N[1]*y.k;return R===y.x&&L===y.y?y:new Ht(y.k,R,L)}function m(y){return[(+y[0][0]+ +y[1][0])/2,(+y[0][1]+ +y[1][1])/2]}function _(y,$,N,R){y.on("start.zoom",function(){k(this,arguments).event(R).start()}).on("interrupt.zoom end.zoom",function(){k(this,arguments).event(R).end()}).tween("zoom",function(){var L=this,X=arguments,O=k(L,X).event(R),Z=e.apply(L,X),Q=N==null?m(Z):typeof N=="function"?N.apply(L,X):N,ft=Math.max(Z[1][0]-Z[0][0],Z[1][1]-Z[0][1]),rt=L.__zoom,lt=typeof $=="function"?$.apply(L,X):$,T=f(rt.invert(Q).concat(ft/rt.k),lt.invert(Q).concat(ft/lt.k));return function(F){if(F===1)F=lt;else{var W=T(F),J=ft/W[2];F=new Ht(J,Q[0]-W[0]*J,Q[1]-W[1]*J)}O.zoom(null,F)}})}function k(y,$,N){return!N&&y.__zooming||new A(y,$)}function A(y,$){this.that=y,this.args=$,this.active=0,this.sourceEvent=null,this.extent=e.apply(y,$),this.taps=0}A.prototype={event:function(y){return y&&(this.sourceEvent=y),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(y,$){return this.mouse&&y!=="mouse"&&(this.mouse[1]=$.invert(this.mouse[0])),this.touch0&&y!=="touch"&&(this.touch0[1]=$.invert(this.touch0[0])),this.touch1&&y!=="touch"&&(this.touch1[1]=$.invert(this.touch1[0])),this.that.__zoom=$,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(y){var $=Nt(this.that).datum();s.call(y,this.that,new yc(y,{sourceEvent:this.sourceEvent,target:g,transform:this.that.__zoom,dispatch:s}),$)}};function C(y,...$){if(!t.apply(this,arguments))return;var N=k(this,$).event(y),R=this.__zoom,L=Math.max(a[0],Math.min(a[1],R.k*Math.pow(2,r.apply(this,arguments)))),X=Pt(y);if(N.wheel)(N.mouse[0][0]!==X[0]||N.mouse[0][1]!==X[1])&&(N.mouse[1]=R.invert(N.mouse[0]=X)),clearTimeout(N.wheel);else{if(R.k===L)return;N.mouse=[X,R.invert(X)],Ge(this),N.start()}xe(y),N.wheel=setTimeout(O,w),N.zoom("mouse",n(E(b(R,L),N.mouse[0],N.mouse[1]),N.extent,o));function O(){N.wheel=null,N.end()}}function q(y,...$){if(h||!t.apply(this,arguments))return;var N=y.currentTarget,R=k(this,$,!0).event(y),L=Nt(y.view).on("mousemove.zoom",Q,!0).on("mouseup.zoom",ft,!0),X=Pt(y,N),O=y.clientX,Z=y.clientY;Ci(y.view),Pn(y),R.mouse=[X,this.__zoom.invert(X)],Ge(this),R.start();function Q(rt){if(xe(rt),!R.moved){var lt=rt.clientX-O,T=rt.clientY-Z;R.moved=lt*lt+T*T>d}R.event(rt).zoom("mouse",n(E(R.that.__zoom,R.mouse[0]=Pt(rt,N),R.mouse[1]),R.extent,o))}function ft(rt){L.on("mousemove.zoom mouseup.zoom",null),Ri(rt.view,R.moved),xe(rt),R.event(rt).end()}}function B(y,...$){if(t.apply(this,arguments)){var N=this.__zoom,R=Pt(y.changedTouches?y.changedTouches[0]:y,this),L=N.invert(R),X=N.k*(y.shiftKey?.5:2),O=n(E(b(N,X),R,L),e.apply(this,$),o);xe(y),u>0?Nt(this).transition().duration(u).call(_,O,R,y):Nt(this).call(g.transform,O,R,y)}}function G(y,...$){if(t.apply(this,arguments)){var N=y.touches,R=N.length,L=k(this,$,y.changedTouches.length===R).event(y),X,O,Z,Q;for(Pn(y),O=0;O<R;++O)Z=N[O],Q=Pt(Z,this),Q=[Q,this.__zoom.invert(Q),Z.identifier],L.touch0?!L.touch1&&L.touch0[2]!==Q[2]&&(L.touch1=Q,L.taps=0):(L.touch0=Q,X=!0,L.taps=1+!!c);c&&(c=clearTimeout(c)),X&&(L.taps<2&&(x=Q[0],c=setTimeout(function(){c=null},v)),Ge(this),L.start())}}function K(y,...$){if(this.__zooming){var N=k(this,$).event(y),R=y.changedTouches,L=R.length,X,O,Z,Q;for(xe(y),X=0;X<L;++X)O=R[X],Z=Pt(O,this),N.touch0&&N.touch0[2]===O.identifier?N.touch0[0]=Z:N.touch1&&N.touch1[2]===O.identifier&&(N.touch1[0]=Z);if(O=N.that.__zoom,N.touch1){var ft=N.touch0[0],rt=N.touch0[1],lt=N.touch1[0],T=N.touch1[1],F=(F=lt[0]-ft[0])*F+(F=lt[1]-ft[1])*F,W=(W=T[0]-rt[0])*W+(W=T[1]-rt[1])*W;O=b(O,Math.sqrt(F/W)),Z=[(ft[0]+lt[0])/2,(ft[1]+lt[1])/2],Q=[(rt[0]+T[0])/2,(rt[1]+T[1])/2]}else if(N.touch0)Z=N.touch0[0],Q=N.touch0[1];else return;N.zoom("touch",n(E(O,Z,Q),N.extent,o))}}function et(y,...$){if(this.__zooming){var N=k(this,$).event(y),R=y.changedTouches,L=R.length,X,O;for(Pn(y),h&&clearTimeout(h),h=setTimeout(function(){h=null},v),X=0;X<L;++X)O=R[X],N.touch0&&N.touch0[2]===O.identifier?delete N.touch0:N.touch1&&N.touch1[2]===O.identifier&&delete N.touch1;if(N.touch1&&!N.touch0&&(N.touch0=N.touch1,delete N.touch1),N.touch0)N.touch0[1]=this.__zoom.invert(N.touch0[0]);else if(N.end(),N.taps===2&&(O=Pt(O,this),Math.hypot(x[0]-O[0],x[1]-O[1])<p)){var Z=Nt(this).on("dblclick.zoom");Z&&Z.apply(this,arguments)}}}return g.wheelDelta=function(y){return arguments.length?(r=typeof y=="function"?y:Be(+y),g):r},g.filter=function(y){return arguments.length?(t=typeof y=="function"?y:Be(!!y),g):t},g.touchable=function(y){return arguments.length?(i=typeof y=="function"?y:Be(!!y),g):i},g.extent=function(y){return arguments.length?(e=typeof y=="function"?y:Be([[+y[0][0],+y[0][1]],[+y[1][0],+y[1][1]]]),g):e},g.scaleExtent=function(y){return arguments.length?(a[0]=+y[0],a[1]=+y[1],g):[a[0],a[1]]},g.translateExtent=function(y){return arguments.length?(o[0][0]=+y[0][0],o[1][0]=+y[1][0],o[0][1]=+y[0][1],o[1][1]=+y[1][1],g):[[o[0][0],o[0][1]],[o[1][0],o[1][1]]]},g.constrain=function(y){return arguments.length?(n=y,g):n},g.duration=function(y){return arguments.length?(u=+y,g):u},g.interpolate=function(y){return arguments.length?(f=y,g):f},g.on=function(){var y=s.on.apply(s,arguments);return y===s?g:y},g.clickDistance=function(y){return arguments.length?(d=(y=+y)*y,g):Math.sqrt(d)},g.tapDistance=function(y){return arguments.length?(p=+y,g):p},g}var Mc=_t('<div class="network-container w-full h-full bg-gray-50 rounded-lg border border-gray-200"></div>');function Ac(t,e){di(e,!1);let n=yt(e,"items",24,()=>[]),r=yt(e,"neighbors",24,()=>({})),i=yt(e,"onNodeClick",8,()=>{}),a=yt(e,"onNodeHover",8,()=>{}),o=yt(e,"selectedId",8,null),u=yt(e,"maxNodes",8,500),f=yt(e,"minScore",8,.02),s=yt(e,"userSimilarity",24,()=>new Map),c=yt(e,"textWeight",8,.6),x=yt(e,"dateWeight",8,.2),h=yt(e,"placeWeight",8,.2),v=yt(e,"userWeight",8,0),w=ct(),d=ct(),p=ct(),g=[],b=[],E=new Map,m=mc,_=1200,k=700,A;function C(){if(!l(w)||!l(d))return;const T=l(w).getBoundingClientRect();_=Math.max(320,Math.floor(T.width)),k=Math.max(400,k),l(d).attr("width",_).attr("height",k).attr("viewBox",[0,0,_,k])}function q(){C(),l(p)&&l(p).force("center",ni(_/2,k/2)).alpha(.2).restart()}let B=null;pi(()=>{G(),C(),typeof window<"u"&&(window.addEventListener("resize",q),B=()=>window.removeEventListener("resize",q))}),typeof window<"u"&&ja(()=>{l(p)&&l(p).stop(),B&&B()});function G(){ot(d,Nt(l(w)).append("svg").attr("width",_).attr("height",k).attr("viewBox",[0,0,_,k]).attr("style","max-width: 100%; height: auto;")),l(d).on("click",function(T){(T.target===this||T.target.tagName==="svg")&&i()("")}),A=Nc().scaleExtent([.1,10]).on("zoom",T=>{l(d).select(".graph-container").attr("transform",T.transform)}),l(d).call(A),l(d).append("g").attr("class","graph-container")}function K(){if(!l(d))return;const T=new Set,F=[];n().slice(0,u()).forEach(M=>{T.add(M.id)}),Object.entries(r()).forEach(([M,V])=>{T.has(M)&&V.forEach(Y=>{T.has(Y.id)&&Y.score>=f()&&F.push({source:M,target:Y.id,score:Y.score,baseScore:Y.score,S_text:Y.S_text,S_date:Y.S_date,S_place:Y.S_place})})}),g=Array.from(T).map(M=>{const V=n().find(Y=>Y.id===M);return{id:M,title:Array.isArray(V?.title)?V.title[0]:V?.title||M,year:V?.year,type:V?.type,collection:V?.collection,degree:0,cluster:0}});const J=new Map;F.forEach(M=>{const V=typeof M.source=="string"?M.source:M.source.id,Y=typeof M.target=="string"?M.target:M.target.id;J.set(V,(J.get(V)||0)+1),J.set(Y,(J.get(Y)||0)+1)}),g.forEach(M=>{M.degree=J.get(M.id)||0}),b=F,y(),$(),R()}function et(T,F){return[T,F].sort().join("|")}function y(){if(b)for(const T of b){const F=typeof T.source=="string"?T.source:T.source.id,W=typeof T.target=="string"?T.target:T.target.id,J=(T.S_text??0)*c(),M=(T.S_date??0)*x(),V=(T.S_place??0)*h(),U=(s()?.get(et(F,W))??0)*v(),nt=J+M+V+U,wt=Math.max(0,Math.min(1,nt));T.score=wt}}function $(){const T=new Map;b.forEach(M=>{const V=typeof M.source=="string"?M.source:M.source.id,Y=typeof M.target=="string"?M.target:M.target.id,U=Number.isFinite(M.score)?M.score:1;T.has(V)||T.set(V,new Map),T.has(Y)||T.set(Y,new Map),T.get(V).set(Y,(T.get(V).get(Y)||0)+U),T.get(Y).set(V,(T.get(Y).get(V)||0)+U)});const F=N(T,40);E.clear();const W=new Map;let J=0;for(const M of g){const V=F.get(M.id)||M.id;W.has(V)||W.set(V,J++),E.set(M.id,W.get(V))}g.forEach(M=>{M.cluster=E.get(M.id)||0})}function N(T,F=30){const W=new Map,J=g.map(M=>M.id);for(const M of J)W.set(M,M);for(let M=0;M<F;M++){let V=0;const Y=J.slice();for(let U=Y.length-1;U>0;U--){const nt=Math.floor(Math.random()*(U+1));[Y[U],Y[nt]]=[Y[nt],Y[U]]}for(const U of Y){const nt=T.get(U);if(!nt||nt.size===0)continue;const wt=new Map;nt.forEach((Xt,Ct)=>{const jt=W.get(Ct)||Ct;wt.set(jt,(wt.get(jt)||0)+Xt)});let Yt=W.get(U)||U,fe=-1/0;wt.forEach((Xt,Ct)=>{(Xt>fe||Xt===fe&&Ct<Yt)&&(fe=Xt,Yt=Ct)}),Yt!==W.get(U)&&(W.set(U,Yt),V++)}if(V===0)break}return W}function R(){const T=l(d).select(".graph-container");T.selectAll("*").remove();const F=T.append("g").attr("class","links").selectAll("line").data(b).join("line").attr("stroke","#999").attr("stroke-opacity",M=>.2+M.score*.6).attr("stroke-width",M=>Math.max(.5,M.score*3)),W=T.append("g").attr("class","nodes").selectAll("g").data(g).join("g").attr("cursor","pointer").call(X(l(p)));W.append("circle").attr("r",M=>Math.max(3,Math.min(15,3+Math.sqrt(M.degree)))).attr("fill",M=>m[M.cluster%m.length]).attr("stroke","#fff").attr("stroke-width",1.5).on("click",(M,V)=>{M.stopPropagation(),i()(V.id)}).on("mouseover",function(M,V){Nt(this).attr("stroke","#000").attr("stroke-width",2);try{a()(V.id)}catch{}const Y=T.append("g").attr("class","tooltip").attr("transform",`translate(${V.x},${V.y})`),U=Y.append("text").attr("dy",-20).attr("text-anchor","middle").style("font-size","12px").style("font-weight","bold").style("fill","#000").style("pointer-events","none");U.append("tspan").text(V.title.substring(0,50)+(V.title.length>50?"...":""));const nt=U.node().getBBox();Y.insert("rect","text").attr("x",nt.x-4).attr("y",nt.y-2).attr("width",nt.width+8).attr("height",nt.height+4).attr("fill","white").attr("stroke","#000").attr("rx",3)}).on("mouseout",function(){Nt(this).attr("stroke","#fff").attr("stroke-width",1.5),T.selectAll(".tooltip").remove();try{a()(null)}catch{}}),W.filter(M=>M.degree>5).append("text").attr("dx",8).attr("dy",3).style("font-size","8px").style("fill","#333").style("pointer-events","none").text(M=>M.title.substring(0,20)),ot(p,pc(g).force("link",oc(b).id(M=>M.id).distance(M=>100-M.score*50).strength(M=>M.score)).force("charge",gc().strength(-30).distanceMax(200)).force("cluster",L()).force("collision",ic().radius(M=>Math.max(3,Math.min(15,3+Math.sqrt(M.degree)))+2)).force("center",ni(_/2,k/2)).on("tick",J));function J(){F.attr("x1",M=>M.source.x).attr("y1",M=>M.source.y).attr("x2",M=>M.target.x).attr("y2",M=>M.target.y),W.attr("transform",M=>`translate(${M.x},${M.y})`)}}function L(){let T;const W=_/2,J=k/2;function M(V){const Y=new Map;T.forEach(U=>{if(!Y.has(U.cluster)){const nt=U.cluster/10*2*Math.PI,wt=200;Y.set(U.cluster,{x:W+Math.cos(nt)*wt,y:J+Math.sin(nt)*wt,count:0})}}),T.forEach(U=>{const nt=Y.get(U.cluster);nt&&U.x!==void 0&&U.y!==void 0&&(U.vx=(U.vx||0)+(nt.x-U.x)*.3*V,U.vy=(U.vy||0)+(nt.y-U.y)*.3*V)})}return M.initialize=function(V){T=V},M}function X(T){function F(M){M.active||T.alphaTarget(.3).restart(),M.subject.fx=M.subject.x,M.subject.fy=M.subject.y}function W(M){M.subject.fx=M.x,M.subject.fy=M.y}function J(M){M.active||T.alphaTarget(0),M.subject.fx=null,M.subject.fy=null}return nu().on("start",F).on("drag",W).on("end",J)}function O(){if(!l(d)||!o())return;const T=new Set;T.add(o()),b.forEach(F=>{const W=typeof F.source=="string"?F.source:F.source.id,J=typeof F.target=="string"?F.target:F.target.id;W===o()&&T.add(J),J===o()&&T.add(W)}),l(d).select(".nodes").selectAll("g").attr("opacity",F=>T.has(F.id)?1:.15),l(d).select(".nodes").selectAll("circle").attr("stroke",F=>F.id===o()?"#ff0000":"#fff").attr("stroke-width",F=>F.id===o()?3:1.5),l(d).select(".links").selectAll("line").attr("stroke",F=>F.source.id===o()||F.target.id===o()?"#ff6b6b":"#999").attr("stroke-opacity",F=>F.source.id===o()||F.target.id===o()?.9:.08)}function Z(){l(d)&&(l(d).select(".nodes").selectAll("g").attr("opacity",1),l(d).select(".nodes").selectAll("circle").attr("stroke","#fff").attr("stroke-width",1.5),l(d).select(".links").selectAll("line").attr("stroke","#999").attr("stroke-opacity",T=>.2+T.score*.6))}function Q(){l(d)&&A&&l(d).transition().duration(750).call(A.transform,ar)}function ft(){l(p)&&l(p).alpha(1).restart()}kt(()=>(l(w),tt(n()),tt(r())),()=>{l(w)&&n().length>0&&r()&&K()}),kt(()=>(l(d),tt(u())),()=>{l(d)&&u()&&K()}),kt(()=>(l(d),tt(o())),()=>{l(d)&&(o()?O():Z())}),kt(()=>(l(p),l(d),tt(c()),tt(x()),tt(h()),tt(v()),tt(s())),()=>{if(l(p)&&l(d)){c(),x(),h(),v(),s(),y(),$(),l(d).select(".nodes").selectAll("circle").attr("fill",F=>m[(F.cluster??0)%m.length]),l(d).select(".links").selectAll("line").attr("stroke-opacity",F=>.2+F.score*.6).attr("stroke-width",F=>Math.max(.5,F.score*3));const T=l(p).force("link");T&&typeof T.distance=="function"&&typeof T.strength=="function"&&T.distance(F=>100-F.score*50).strength(F=>F.score),l(p).alpha(.6).restart()}}),gi();var rt={resetZoom:Q,reheat:ft};si();var lt=Mc();return mi(lt,T=>ot(w,T),()=>l(w)),mt(t,lt),Pr(e,"resetZoom",Q),Pr(e,"reheat",ft),vi(rt)}var Sc=_t("<option> </option>"),Tc=_t('<li class="p-0"><button type="button"><div class="text-sm font-medium"> </div> <div class="text-xs text-gray-500"> </div></button></li>'),Ec=_t('<img class="w-full h-auto rounded mb-2"/>'),$c=_t('<div class="text-xs"> </div>'),zc=_t('<div class="text-xs"> </div>'),Ic=_t('<a target="_blank" class="text-blue-600 text-sm hover:underline">View on Europeana</a>'),Cc=_t('<span class="text-purple-600 ml-1" title="User interaction boost"></span>'),Rc=_t('<li class="py-2"><div class="flex items-start justify-between gap-2"><button class="text-left text-sm hover:underline"> </button> <span class="text-xs text-gray-600 whitespace-nowrap"> <!></span></div> <div class="mt-1"><div class="flex items-center gap-2 text-[11px] text-gray-600 flex-wrap"><span class="inline-flex items-center gap-1"><span class="inline-block w-2 h-2 bg-indigo-500 rounded"></span> </span> <span class="inline-flex items-center gap-1"><span class="inline-block w-2 h-2 bg-emerald-500 rounded"></span> </span> <span class="inline-flex items-center gap-1"><span class="inline-block w-2 h-2 bg-amber-500 rounded"></span> </span> <span><span class="inline-block w-2 h-2 bg-purple-500 rounded"></span> </span></div></div></li>'),Dc=_t('<div class="mt-4 border-t pt-3"><div class="flex items-center justify-between mb-2"><h4 class="font-semibold">Top neighbors</h4> <span class="text-[10px] text-gray-500"> </span></div> <ul class="divide-y"></ul></div>'),Fc=_t('<!> <div class="space-y-1"><div class="font-medium"> </div> <div class="text-xs text-gray-600"> </div> <!> <!> <!> <button> </button> <div class="text-[11px] text-gray-500 mt-1"> </div></div> <!>',1),Pc=_t('<p class="text-sm text-gray-600">Hover a node to preview it; click a node to keep it here until you hover another.</p>'),Hc=_t(`<div class="p-4 space-y-4"><div class="flex justify-between items-center"><h2 class="text-sm text-gray-600">A Conceptual Visualization of the Graphical Topology of the Archive</h2></div> <div class="border-t pt-4"><p class="text-md text-gray-600 mb-3">This visualization sketches what we are calling the "graphical topology" of the archive: 
    a space where items relate to one another through textual metadata, dates, places, and 
    patterns of interaction. It is not a working archival platform but a conceptual model 
    meant to explore how archives might be navigated through relational proximity rather 
    than fixed hierarchies or linear search.</p></div> <div class="border rounded-lg bg-white p-4 space-y-3"><details class="border rounded-lg bg-gray-50" open><summary class="cursor-pointer p-4 select-none font-semibold text-gray-700 text-sm hover:bg-gray-100 rounded-lg"><span class="inline-flex items-center justify-between w-full"><span>Network Size</span> <span class="font-mono font-semibold text-gray-600"> </span></span></summary> <div class="px-4 pb-4 space-y-2"><div class="flex items-center gap-3"><span class="text-xs text-gray-600">10</span> <input type="range" min="10" step="10" class="flex-1 h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-500"/> <span class="text-xs text-gray-600"> </span></div> <p class="text-[10px] text-gray-500">Control the number of nodes from filtered results. Adjust search/filters above to change available items.</p></div></details> <details class="border rounded-lg bg-gray-50" open><summary class="cursor-pointer p-4 select-none hover:bg-gray-100 rounded-lg"><div class="flex items-center justify-between"><h3 class="text-sm font-semibold text-gray-700">Similarity Weights</h3> <button class="px-3 py-1 text-xs rounded border bg-white hover:bg-gray-100 text-gray-700" title="Reset weights to default values">Reset Weights</button></div></summary> <div class="px-4 pb-4"><div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"><div class="space-y-1"><label class="flex items-center justify-between text-xs text-gray-600"><span class="inline-flex items-center gap-1"><span class="inline-block w-2 h-2 bg-indigo-500 rounded"></span> Text</span> <span class="font-mono font-semibold"> </span></label> <input type="range" min="0" max="1" step="0.05" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-indigo-500"/></div> <div class="space-y-1"><label class="flex items-center justify-between text-xs text-gray-600"><span class="inline-flex items-center gap-1"><span class="inline-block w-2 h-2 bg-emerald-500 rounded"></span> Date</span> <span class="font-mono font-semibold"> </span></label> <input type="range" min="0" max="1" step="0.05" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-emerald-500"/></div> <div class="space-y-1"><label class="flex items-center justify-between text-xs text-gray-600"><span class="inline-flex items-center gap-1"><span class="inline-block w-2 h-2 bg-amber-500 rounded"></span> Place</span> <span class="font-mono font-semibold"> </span></label> <input type="range" min="0" max="1" step="0.05" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-amber-500"/></div> <div class="space-y-1"><label class="flex items-center justify-between text-xs text-gray-600"><span class="inline-flex items-center gap-1"><span class="inline-block w-2 h-2 bg-purple-500 rounded"></span> User</span> <span class="font-mono font-semibold"> </span></label> <input type="range" min="0" max="1" step="0.05" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-purple-500"/></div></div> <p class="text-[10px] text-gray-500 mt-2"> </p></div></details> <div class="flex gap-4 items-center flex-wrap"><button class="px-3 py-1 bg-gray-600 text-white rounded text-sm">Reset Zoom</button> <button class="ml-auto px-3 py-1 rounded text-sm border bg-gray-100 hover:bg-gray-200" aria-controls="preview-panel"> </button> <button class="px-3 py-1 rounded text-sm border bg-red-50 hover:bg-red-100 text-red-700" title="Reset interaction history">Reset Interactions</button></div> <div class="flex flex-col lg:flex-row gap-4 items-start"><div class="flex-1 min-w-0 space-y-4"><!> <div class="border rounded-lg bg-white p-4"><h3 class="text-lg font-bold text-gray-800 mb-3">Search & Filter</h3> <div class="space-y-3"><div class="flex gap-3 flex-wrap items-center"><input type="search" class="border rounded px-3 py-2 flex-1 min-w-[200px]" placeholder="Search title"/> <select class="border rounded px-3 py-2"><option>All languages</option><!></select> <input class="border rounded px-3 py-2 w-32" type="number" placeholder="Year "/> <input class="border rounded px-3 py-2 w-32" type="number" placeholder="Year "/></div> <div class="text-sm text-gray-600"> </div> <ul class="border rounded divide-y max-h-[50vh] overflow-auto bg-gray-50"></ul></div></div></div>  <div role="separator" aria-orientation="vertical" class="hidden lg:block w-1 cursor-col-resize self-stretch bg-gray-300 hover:bg-gray-400 transition-colors" title="Drag to resize details panel"></div> <aside id="preview-panel"><h3 class="font-semibold mb-2">Details</h3> <!></aside></div></div></div>`);function Wc(t,e){di(e,!1);const n=()=>ee(Ut,"$selectedId",f),r=()=>ee(Xn,"$items",f),i=()=>ee(Pe,"$filters",f),a=()=>ee(xi,"$byId",f),o=()=>ee(po,"$userSimilarity",f),u=()=>ee(oe,"$userInteractions",f),[f,s]=no(),c=ct(),x=ct(),h=ct(),v=ct(),w=ct(),d=ct();let p=yt(e,"data",8),g=ct(),b=ct(!0),E=ct(null),m=ct([]),_=ct({text:.6,date:.2,place:.2,user:.5}),k=ct(500),A=null,C=ct(360);const q=260,B=640;let G=!1,K=0,et=0;function y(S){return Array.isArray(S)?S:Array.isArray(S?.pairs)?S.pairs.map(I=>({source:I.a,target:I.b,score:I.score})):S?.graph?.edges??[]}pi(()=>{if(Xn.set(p().metadata||[]),_i.set(y(p().neighbors)),ot(k,p().metadata?.length||500),typeof window<"u"){ot(b,window.innerWidth>=1024);const S=Number(localStorage.getItem("ga_panel_width"));!Number.isNaN(S)&&S>=q&&S<=B&&ot(C,S)}});let $=ct("");function N(S){S===""?Ut.set(null):(A&&(clearTimeout(A),A=null),Ut.set(S),oe.trackView(S))}function R(S){if(A&&(clearTimeout(A),A=null),ot(E,S),S){const I=S;A=setTimeout(()=>{l(E)===I&&(oe.trackHover(I),Ut.set(I)),A=null},3e3)}}function L(S){l(b)&&(G=!0,K="touches"in S?S.touches[0].clientX:S.clientX,et=l(C),window.addEventListener("mousemove",X),window.addEventListener("touchmove",X,{passive:!1}),window.addEventListener("mouseup",O),window.addEventListener("touchend",O),document.body.style.cursor="col-resize",document.body.style.userSelect="none")}function X(S){if(!G)return;if("preventDefault"in S)try{S.preventDefault()}catch{}const I="touches"in S?S.touches[0].clientX:S.clientX,it=K-I,ht=Math.max(q,Math.min(B,et+it));ot(C,ht)}function O(){G=!1,window.removeEventListener("mousemove",X),window.removeEventListener("touchmove",X),window.removeEventListener("mouseup",O),window.removeEventListener("touchend",O),document.body.style.cursor="",document.body.style.userSelect=""}function Z(S,I=10){if(!S)return[];const it=p()?.neighbors;return(Array.isArray(it)?[]:it?.[S]??[]).slice(0,I).map(dt=>({...dt,item:a().get(dt.id)}))}kt(()=>(l(E),n()),()=>{ot(c,l(E)??n()??null)}),kt(()=>l(C),()=>{try{localStorage.setItem("ga_panel_width",String(l(C)))}catch{}}),kt(()=>l($),()=>{ot(x,l($).toLowerCase())}),kt(()=>(r(),l(x),i()),()=>{ot(h,r().filter(S=>{const I=(Array.isArray(S.title)?S.title[0]:S.title)??"",it=!l(x)||String(I).toLowerCase().includes(l(x)),ht=S.language&&S.language[0]||"",dt=!i().lang||ht===i().lang,Rt=Number(S.year),St=(!i().yearFrom||Rt>=i().yearFrom)&&(!i().yearTo||Rt<=i().yearTo||Number.isNaN(Rt));return it&&dt&&St}))}),kt(()=>(l(h),l(k)),()=>{ot(v,l(h).slice(0,l(k)))}),kt(()=>l(v),()=>{ot(w,new Set(l(v).map(S=>S.id)))}),kt(()=>(l(h),l(w)),()=>{ot(d,l(h).filter(S=>l(w).has(S.id)))}),kt(()=>l(c),()=>{ot(m,Z(l(c),10))}),gi(),si();var Q=Hc(),ft=P(D(Q),4),rt=D(ft),lt=D(rt),T=D(lt),F=P(D(T),2),W=D(F);z(F),z(T),z(lt);var J=P(lt,2),M=D(J),V=P(D(M),2);ne(V);var Y=P(V,2),U=D(Y,!0);z(Y),z(M),to(2),z(J),z(rt);var nt=P(rt,2),wt=D(nt),Yt=D(wt),fe=P(D(Yt),2);z(Yt),z(wt);var Xt=P(wt,2),Ct=D(Xt),jt=D(Ct),on=D(jt),or=P(D(on),2),Ui=D(or,!0);z(or),z(on);var sr=P(on,2);ne(sr),z(jt);var sn=P(jt,2),un=D(sn),ur=P(D(un),2),Ki=D(ur,!0);z(ur),z(un);var lr=P(un,2);ne(lr),z(sn);var ln=P(sn,2),cn=D(ln),cr=P(D(cn),2),Zi=D(cr,!0);z(cr),z(cn);var fr=P(cn,2);ne(fr),z(ln);var hr=P(ln,2),fn=D(hr),dr=P(D(fn),2),Qi=D(dr,!0);z(dr),z(fn);var pr=P(fn,2);ne(pr),z(hr),z(Ct);var gr=P(Ct,2),Ji=D(gr);z(gr),z(Xt),z(nt);var hn=P(nt,2),vr=D(hn),he=P(vr,2),ji=D(he,!0);z(he);var ta=P(he,2);z(hn);var mr=P(hn,2),dn=D(mr),yr=D(dn);{var ea=S=>{mi(Ac(S,{get items(){return l(v)},get neighbors(){return tt(p()),H(()=>p().neighbors)},get userSimilarity(){return o()},get textWeight(){return l(_),H(()=>l(_).text)},get dateWeight(){return l(_),H(()=>l(_).date)},get placeWeight(){return l(_),H(()=>l(_).place)},get userWeight(){return l(_),H(()=>l(_).user)},get maxNodes(){return l(k)},get selectedId(){return n()},onNodeClick:N,onNodeHover:R,$$legacy:!0}),I=>ot(g,I),()=>l(g))};Ot(yr,S=>{S(ea)})}var xr=P(yr,2),_r=P(D(xr),2),pn=D(_r),gn=D(pn);ne(gn);var ze=P(gn,2),vn=D(ze);vn.value=vn.__value="";var na=P(vn);$n(na,1,()=>(r(),H(()=>Array.from(new Set(r().flatMap(S=>S.language||[]))))),En,(S,I)=>{var it=Sc(),ht=D(it,!0);z(it);var dt={};Tt(()=>{j(ht,l(I)),dt!==(dt=l(I))&&(it.value=(it.__value=l(I))??"")}),mt(S,it)}),z(ze);var wr=P(ze,2),ra=P(wr,2);z(pn);var mn=P(pn,2),ia=D(mn);z(mn);var br=P(mn,2);$n(br,5,()=>(l(d),H(()=>l(d).slice(0,200))),En,(S,I)=>{var it=Tc(),ht=D(it),dt=D(ht),Rt=D(dt,!0);z(dt);var St=P(dt,2),qt=D(St);z(St),z(ht),z(it),Tt((pe,Wt)=>{Fe(ht,1,`w-full text-left p-3 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 ${n(),l(I),H(()=>n()===l(I).id?"bg-blue-50":"")??""}`),j(Rt,pe),j(qt,`${l(I),H(()=>l(I).year)??""}  ${Wt??""}`)},[()=>(l(I),H(()=>Array.isArray(l(I).title)?l(I).title[0]:l(I).title)),()=>(l(I),H(()=>l(I).language&&l(I).language.join(", ")||""))]),bt("click",ht,()=>{Ut.set(l(I).id),l(g)&&l(g).centerOnNode?.(l(I).id)}),mt(S,it)}),z(br),z(_r),z(xr),z(dn);var Ie=P(dn,2),de=P(Ie,2),aa=P(D(de),2);{var oa=S=>{const I=ie(()=>(a(),l(c),H(()=>a().get(l(c))))),it=ie(()=>(tt(l(I)),H(()=>Array.isArray(l(I).title)?l(I).title[0]:l(I).title)));var ht=Fc(),dt=eo(ht);{var Rt=at=>{var st=Ec();Tt(()=>{Gt(st,"src",(tt(l(I)),H(()=>l(I).thumbnail))),Gt(st,"alt",l(it)||"thumbnail")}),mt(at,st)};Ot(dt,at=>{tt(l(I)),H(()=>l(I).thumbnail)&&at(Rt)})}var St=P(dt,2),qt=D(St),pe=D(qt,!0);z(qt);var Wt=P(qt,2),yn=D(Wt);z(Wt);var kr=P(Wt,2);{var ua=at=>{var st=$c(),Dt=D(st);z(st),Tt(()=>j(Dt,`Country: ${tt(l(I)),H(()=>l(I).country)??""}`)),mt(at,st)};Ot(kr,at=>{tt(l(I)),H(()=>l(I).country)&&at(ua)})}var Nr=P(kr,2);{var la=at=>{var st=zc(),Dt=D(st);z(st),Tt(()=>j(Dt,`Collection: ${tt(l(I)),H(()=>l(I).collection)??""}`)),mt(at,st)};Ot(Nr,at=>{tt(l(I)),H(()=>l(I).collection)&&at(la)})}var Mr=P(Nr,2);{var ca=at=>{var st=Ic();Tt(()=>Gt(st,"href",(tt(l(I)),H(()=>l(I).link)))),mt(at,st)};Ot(Mr,at=>{tt(l(I)),H(()=>l(I).link)&&at(ca)})}var ge=P(Mr,2),fa=D(ge,!0);z(ge);var Ar=P(ge,2),ha=D(Ar);z(Ar),z(St);var da=P(St,2);{var pa=at=>{var st=Dc(),Dt=D(st),Ce=P(D(Dt),2),ga=D(Ce);z(Ce),z(Dt);var Sr=P(Dt,2);$n(Sr,5,()=>l(m),En,(va,ut)=>{const Tr=ie(()=>(l(ut),H(()=>Array.isArray(l(ut).item?.title)?l(ut).item?.title[0]:l(ut).item?.title))),te=ie(()=>(o(),l(c),l(ut),H(()=>o().get([l(c),l(ut).id].sort().join("|"))??0))),Er=ie(()=>(l(_),l(ut),tt(l(te)),H(()=>l(_).text*(l(ut).S_text??0)+l(_).date*(l(ut).S_date??0)+l(_).place*(l(ut).S_place??0)+l(_).user*l(te))));var xn=Rc(),_n=D(xn),Re=D(_n),ma=D(Re,!0);z(Re);var $r=P(Re,2),zr=D($r),ya=P(zr);{var xa=ve=>{var Mn=Cc();mt(ve,Mn)};Ot(ya,ve=>{l(te)>0&&ve(xa)})}z($r),z(_n);var Ir=P(_n,2),Cr=D(Ir),wn=D(Cr),_a=P(D(wn));z(wn);var bn=P(wn,2),wa=P(D(bn));z(bn);var kn=P(bn,2),ba=P(D(kn));z(kn);var Nn=P(kn,2),ka=P(D(Nn));z(Nn),z(Cr),z(Ir),z(xn),Tt((ve,Mn,Na,Ma,Aa)=>{j(ma,(tt(l(Tr)),l(ut),H(()=>l(Tr)??l(ut).title??l(ut).id))),j(zr,`${ve??""} `),j(_a,`Text ${Mn??""}`),j(wa,`Date ${Na??""}`),j(ba,`Place ${Ma??""}`),Fe(Nn,1,`inline-flex items-center gap-1 ${l(te)>0?"text-purple-600 font-medium":""}`),j(ka,`User ${Aa??""}`)},[()=>(tt(l(Er)),H(()=>l(Er).toFixed(2))),()=>(l(ut),H(()=>Number(l(ut).S_text??0).toFixed(2))),()=>(l(ut),H(()=>Number(l(ut).S_date??0).toFixed(2))),()=>(l(ut),H(()=>Number(l(ut).S_place??0).toFixed(2))),()=>(tt(l(te)),H(()=>l(te).toFixed(2)))]),bt("click",Re,()=>{Ut.set(l(ut).id),ot(E,null)}),mt(va,xn)}),z(Sr),z(st),Tt(()=>j(ga,`G = ${l(_),H(()=>l(_).text)??""}Text + ${l(_),H(()=>l(_).date)??""}Date + ${l(_),H(()=>l(_).place)??""}Place + ${l(_),H(()=>l(_).user)??""}User`)),mt(at,st)};Ot(da,at=>{l(m),H(()=>l(m).length)&&at(pa)})}Tt((at,st,Dt,Ce)=>{j(pe,l(it)??"(no title)"),j(yn,`${tt(l(I)),H(()=>l(I).year??"")??""}  ${at??""}`),Fe(ge,1,`mt-2 px-2 py-1 text-xs rounded ${st??""}`),j(fa,Dt),j(ha,`Hover views: ${Ce??""}`)},[()=>(tt(l(I)),H(()=>l(I).language&&l(I).language.join(", ")||"")),()=>(u(),l(c),H(()=>u().bookmarks.has(l(c))?"bg-yellow-100 text-yellow-800 border border-yellow-300":"bg-gray-100 text-gray-700 border border-gray-300")),()=>(u(),l(c),H(()=>u().bookmarks.has(l(c))?" Bookmarked":" Bookmark")),()=>(u(),l(c),H(()=>u().hoverTimestamps?.get(l(c))?.length||0))]),bt("click",ge,()=>oe.toggleBookmark(l(c))),mt(S,ht)},sa=S=>{var I=Pc();mt(S,I)};Ot(aa,S=>{l(c),a(),H(()=>l(c)&&a().get(l(c)))?S(oa):S(sa,!1)})}z(de),z(mr),z(ft),z(Q),Tt((S,I,it,ht,dt,Rt,St,qt,pe,Wt,yn)=>{j(W,`${S??""} / ${l(h),H(()=>l(h).length)??""} nodes`),Gt(V,"max",I),j(U,(l(h),H(()=>l(h).length))),j(Ui,it),j(Ki,ht),j(Zi,dt),j(Qi,Rt),j(Ji,`Adjust weights to control how similarity scores are calculated: G = ${St??""}Text + ${qt??""}Date + ${pe??""}Place + ${Wt??""}User`),Gt(he,"aria-expanded",l(b)),j(ji,l(b)?"Hide panel":"Show panel"),j(ia,`Showing ${yn??""} of ${l(d),H(()=>l(d).length)??""} items`),Gt(Ie,"aria-hidden",!l(b)),Fe(de,1,`border rounded-lg p-3 bg-gray-50 max-h-[140vh] overflow-auto w-full lg:w-auto flex-shrink-0 ${l(b)?"block":"hidden"}`),Gt(de,"aria-hidden",!l(b)),oo(de,`width: ${l(b)?l(C)+"px":"auto"}`)},[()=>(l(k),l(h),H(()=>Math.min(l(k),l(h).length))),()=>(l(h),H(()=>Math.max(10,l(h).length))),()=>(l(_),H(()=>l(_).text.toFixed(2))),()=>(l(_),H(()=>l(_).date.toFixed(2))),()=>(l(_),H(()=>l(_).place.toFixed(2))),()=>(l(_),H(()=>l(_).user.toFixed(2))),()=>(l(_),H(()=>l(_).text.toFixed(2))),()=>(l(_),H(()=>l(_).date.toFixed(2))),()=>(l(_),H(()=>l(_).place.toFixed(2))),()=>(l(_),H(()=>l(_).user.toFixed(2))),()=>(l(d),H(()=>Math.min(l(d).length,200)))]),re(V,()=>l(k),S=>ot(k,S)),bt("click",fe,so(()=>{ot(_,{text:.6,date:.2,place:.2,user:.5})})),re(sr,()=>l(_).text,S=>De(_,l(_).text=S)),re(lr,()=>l(_).date,S=>De(_,l(_).date=S)),re(fr,()=>l(_).place,S=>De(_,l(_).place=S)),re(pr,()=>l(_).user,S=>De(_,l(_).user=S)),bt("click",vr,()=>l(g)?.resetZoom()),bt("click",he,()=>ot(b,!l(b))),bt("click",ta,()=>{confirm("Clear all tracked views and bookmarks?")&&oe.reset()}),re(gn,()=>l($),S=>ot($,S)),bt("change",ze,S=>Pe.set({...i(),lang:S.target.value||void 0})),bt("change",wr,S=>Pe.set({...i(),yearFrom:Number(S.target.value)||void 0})),bt("change",ra,S=>Pe.set({...i(),yearTo:Number(S.target.value)||void 0})),bt("mousedown",Ie,L),bt("touchstart",Ie,L),mt(t,Q),vi(),s()}export{Wc as component,qc as universal};
